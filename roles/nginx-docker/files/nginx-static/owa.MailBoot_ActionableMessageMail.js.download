self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.MailBoot~ActionableMessageMail.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[478],{1e3:function(e,t,n){"use strict";var r=n(656),a=n(654),i=n(792),o=n(346);t.a=function(e,t,n){if(!Object(o.a)(n))return!1;var c=typeof t;return!!("number"==c?Object(a.a)(n)&&Object(i.a)(t,n.length):"string"==c&&t in n)&&Object(r.a)(n[t],e)}},1022:function(e,t,n){"use strict";var r=n(993),a=n(1e3);t.a=function(e){return Object(r.a)((function(t,n){var r=-1,i=n.length,o=i>1?n[i-1]:void 0,c=i>2?n[2]:void 0;for(o=e.length>3&&"function"==typeof o?(i--,o):void 0,c&&Object(a.a)(n[0],n[1],c)&&(o=i<3?void 0:o,i=1),t=Object(t);++r<i;){var s=n[r];s&&e(t,s,r,o)}return t}))}},15895:function(e,t,n){var r=n(15896),a=n(95);"string"==typeof r&&(r=[[e.i,r]]);for(var i=0;i<r.length;i++)a.loadStyles(r[i][1],!1);r.locals&&(e.exports=r.locals)},15896:function(e,t,n){(t=e.exports=n(94)(!1)).push([e.i,'._2pRM5MH2wQSL6KJYv7DZjH{width:calc(100% - 25px);position:absolute;height:calc(100% - 64px)}html[dir=ltr] ._2pRM5MH2wQSL6KJYv7DZjH{margin-left:-20px;margin-right:-35px}html[dir=rtl] ._2pRM5MH2wQSL6KJYv7DZjH{margin-right:-20px;margin-left:-35px}._36_sivvBA_3QDLOOHcFq0k{width:100%;height:100%}html[dir] ._36_sivvBA_3QDLOOHcFq0k{border-width:0}._3CW7BF2coKNui2HaKAh3Zw{font-size:21px;font-weight:100;font-weight:300;color:"[theme:neutralPrimary, default:#323130]"}',""]),t.locals={opayFlexPaneContainer:"_2pRM5MH2wQSL6KJYv7DZjH",opayAppIFrameStyle:"_36_sivvBA_3QDLOOHcFq0k",flexPaneHeader:"_3CW7BF2coKNui2HaKAh3Zw"}},15897:function(e){e.exports=JSON.parse('{"a":"f6b","c":"g6b","b":"h6b","g":"i6b","f":"j6b","e":"k6b","d":"l6b","h":"m6b","i":"n6b"}')},15898:function(e){e.exports=JSON.parse('{"a":"c6b","b":"d6b","c":"e6b"}')},15899:function(e){e.exports=JSON.parse('{"a":"b6b"}')},15903:function(e){e.exports=JSON.parse('{"d":"Z5b","c":"_5b","a":"$5b","b":"a6b"}')},15904:function(e,t,n){var r=n(15905),a=n(95);"string"==typeof r&&(r=[[e.i,r]]);for(var i=0;i<r.length;i++)a.loadStyles(r[i][1],!1);r.locals&&(e.exports=r.locals)},15905:function(e,t,n){(t=e.exports=n(94)(!1)).push([e.i,"html[dir] ._3uEvU5UAdRqP1z24N4hRkz{margin-top:12px}html[dir=ltr] ._3uEvU5UAdRqP1z24N4hRkz{margin-left:52px}html[dir=rtl] ._3uEvU5UAdRqP1z24N4hRkz{margin-right:52px}.cmC6MemIKYrJJ77Z_ZD4n{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column}._3FcySUHYRo6OeOulzvvAzX{-ms-flex-item-align:center;align-self:center;height:16px;line-height:16px}html[dir] ._3FcySUHYRo6OeOulzvvAzX{margin-top:8px}._3FcySUHYRo6OeOulzvvAzX ._36SOH4LiYsn62sG0PC93OB{font-size:8px}",""]),t.locals={container:"_3uEvU5UAdRqP1z24N4hRkz",cardArea:"cmC6MemIKYrJJ77Z_ZD4n",bodyToggleButton:"_3FcySUHYRo6OeOulzvvAzX",icon:"_36SOH4LiYsn62sG0PC93OB"}},1674:function(e,t,n){"use strict";n.d(t,"l",(function(){return s})),n.d(t,"d",(function(){return u})),n.d(t,"b",(function(){return l})),n.d(t,"a",(function(){return p})),n.d(t,"c",(function(){return b})),n.d(t,"e",(function(){return f})),n.d(t,"i",(function(){return g})),n.d(t,"h",(function(){return h})),n.d(t,"f",(function(){return m})),n.d(t,"j",(function(){return v})),n.d(t,"k",(function(){return O})),n.d(t,"g",(function(){return y}));var r,a,i=n(37),o=n(17),c=n(1858),s=["ar-sa","da-dk","de-at","de-ch","de-de","el-gr","en-ar","en-at","en-au","en-br","en-ca","en-ch","en-cl","en-co","en-de","en-dk","en-fi","en-gb","en-gr","en-hk","en-ie","en-in","en-mx","en-my","en-nl","en-no","en-nz","en-pe","en-pt","en-sa","en-se","en-sg","en-th","en-tr","en-us","en-za","es-ar","es-cl","es-co","es-ec","es-es","es-mx","es-pe","es-us","es-ve","fi-fi","fr-be","fr-ca","fr-ch","fr-fr","it-it","ja-jp","ko-kr","ms-my","nb-no","nl-be","nl-nl","pt-br","pt-pt","sv-se","th-th","tr-tr","zh-cn","zh-hk","zh-sg","zh-tw"],u=["ar-ir","es-cu","ko-kp","ar-sy","en-su","uk-ua"],d={ae:"ar-ae",ar:"es-ar",at:"de-at",au:"en-au",be:"fr-be",br:"pt-br",ca:"en-ca",ch:"de-ch",cl:"es-cl",cn:"zh-cn",co:"es-co",cr:"es-cr",cu:"es-cu",de:"de-de",dk:"da-dk",do:"es-do",ec:"es-ec",eg:"ar-eg",es:"es-es",fi:"fi-fi",fr:"fr-fr",gb:"en-gb",uk:"en-gb",gr:"el-gr",gt:"es-gt",hk:"zh-hk",id:"id-id",ie:"en-ie",in:"en-in",ir:"ar-ir",it:"it-it",jp:"ja-jp",kp:"ko-kp",kr:"ko-kr",mx:"es-mx",my:"ms-my",nl:"nl-nl",no:"nb-no",nz:"en-nz",pe:"es-pe",ph:"fil-ph",pl:"pl-pl",pt:"pt-pt",ru:"ru-ru",sa:"ar-sa",se:"sv-se",sg:"en-sg",su:"en-su",th:"th-th",tr:"tr-tr",tw:"zh-tw",ua:"uk-ua",us:"en-us",ve:"es-ve",vn:"vi-vn",za:"en-za"};function l(){return Object(c.a)()}function p(){return Object(o.a)().IsConsumerChild}function b(){return Object(o.a)().SessionSettings.IsShadowMailbox}function f(){return void 0!==a?a:a=function(){var e=Object(o.a)(),t=e.SessionSettings.UserCulture;if(!e.AdMarket||!/^[a-zA-z\-]*$/.test(e.AdMarket))return t?t.toLowerCase():"en-us";var n=e.AdMarket.toLowerCase();return s.indexOf(n)>-1?n:d[n.split("-")[1]]||n}()}function g(e){return null!=e?e.toUpperCase().split("-"):[]}function h(e){return g(e)[1]||"US"}function m(){return Object(i.a)("ANON")}function v(){return Object(i.a)("MUID")}function O(){return!!Object(i.a)("TOptOut")}function y(){return r||(r="https://acdn.adnxs.com/ast/static/0.30.1/ast.js")}},171:function(e){e.exports=JSON.parse('{"l":"Pwa","i":"Qwa","n":"Rwa","k":"Swa","m":"Twa","j":"Uwa","d":"Vwa","b":"Wwa","f":"Xwa","g":"Ywa","e":"Zwa","a":"_wa","c":"$wa","o":"axa","s":"bxa","r":"cxa","p":"dxa","q":"exa","h":"fxa"}')},17175:function(e,t,n){"use strict";n.r(t);var r=n(4026),a=n(23),i=n(5726),o="CardLinkInteraction";function c(e,t,n,c){a.g.info("[logAdaptiveCardLinkInteraction] Log event captured for link interaction on an adaptive card");var s=Object(r.e)(n);n.card&&s?i.c.logTelemetry({cardDetails:n,eventName:o+"_"+s,messageContext:c}):a.g.warn("[ActionableMessageDebug] logAdaptiveCardLinkInteraction: Cannot log link interaction - message card context is undefined")}var s=n(0),u="00000000-0000-0000-0000-000000000000",d="Highlight_";function l(e){return Object(s.__awaiter)(this,void 0,void 0,(function(){var t,n,i,o,c,d,l,b,f,g,h;return Object(s.__generator)(this,(function(s){switch(s.label){case 0:try{t=JSON.parse(e)}catch(t){throw new Error("[ActionableMessageCard] parseCardProperty: unable to parse card data: "+e)}return n={smtpAddressesSerialized:t.SmtpAddressesSerialized,providerAccountUniqueId:t.ProviderAccountUniqueId,messageCardExtensionContext:t.MessageCardExtensionContext},i=[],t.AdaptiveCardV2Serialized?(c=(o=i).push,[4,r.f.import().then((function(e){return e(n,t.ConnectorSenderGuidV2?t.ConnectorSenderGuidV2:u,t.AdaptiveCardSerializedV2,t.AdaptiveCardSignatureV2,!0)}))]):[3,2];case 1:c.apply(o,[s.sent()]),s.label=2;case 2:return t.AdaptiveCardSerialized?(l=(d=i).push,[4,r.f.import().then((function(e){return e(n,t.ConnectorSenderGuid?t.ConnectorSenderGuid:u,t.AdaptiveCardSerialized,t.AdaptiveCardSignature,!0)}))]):[3,4];case 3:return l.apply(d,[s.sent()]),[3,7];case 4:return t.MessageCardSerialized?(f=(b=i).push,[4,r.f.import().then((function(e){return e(n,t.ConnectorSenderGuid?t.ConnectorSenderGuid:u,t.MessageCardSerialized,t.MessageCardSignature,!1)}))]):[3,6];case 5:return f.apply(b,[s.sent()]),[3,7];case 6:return a.g.info("[ActionableMessageCard] parseCardProperty: No serialized card present"),[2,[]];case 7:return h=(g=i).concat,[4,p(t,n)];case 8:return[2,h.apply(g,[s.sent()])]}}))}))}function p(e,t){return Object(s.__awaiter)(this,void 0,void 0,(function(){var n,i=this;return Object(s.__generator)(this,(function(o){switch(o.label){case 0:return n=[],[4,Promise.all(Object.keys(e).map((function(o){return Object(s.__awaiter)(i,void 0,void 0,(function(){var i,c,l,p;return Object(s.__generator)(this,(function(s){switch(s.label){case 0:if(!e.hasOwnProperty(o)||0!==o.indexOf(d))return[3,4];i=e[o],s.label=1;case 1:return s.trys.push([1,3,,4]),c=JSON.parse(i),[4,r.f.import().then((function(n){return n(t,e.ConnectorSenderGuid?e.ConnectorSenderGuid:u,c.card,null)}))];case 2:return(l=s.sent()).isContextual=!0,l.key=c.id,l.highlightTerm=c.text,n.push(l),[3,4];case 3:return p=s.sent(),a.g.warn("[ActionableMessageDebug] RenderCard: unable to render hightlight card: "+p.message),[3,4];case 4:return[2]}}))}))})))];case 1:return o.sent(),[2,n]}}))}))}var b=n(1693),f=n(2955),g=n(788),h=n(161),m="IOpenTypedFacet.Com.Microsoft.Graph.MessageCard",v="E550B918-9859-47B9-8095-97E4E72F1926";function O(e){return Object(s.__awaiter)(this,void 0,void 0,(function(){var t,n,r;return Object(s.__generator)(this,(function(i){switch(i.label){case 0:return i.trys.push([0,4,,5]),t=Object(g.a)({BaseShape:"IdOnly",AdditionalProperties:[Object(h.a)(v,m,"String")]}),[4,Object(b.a)(e.ItemId.Id,t)];case 1:return!(n=i.sent())||n instanceof Error?[3,3]:(r=Object(f.a)(n,null,m))?[4,l(r)]:[3,3];case 2:return[2,i.sent()];case 3:return[3,5];case 4:return i.sent(),[3,5];case 5:return a.g.info("[loadCardDetailsForItem] extendedProperty could not be retrieved"),[2,null]}}))}))}function y(e){return Object(s.__awaiter)(this,void 0,void 0,(function(){return Object(s.__generator)(this,(function(t){switch(t.label){case 0:return e.adaptiveCardDetails?[2,e.adaptiveCardDetails]:[4,O(e)];case 1:return[2,t.sent()||[]]}}))}))}var C,j,A=n(1),x=n(22),S=n(114),w=n(4),I=n(33),M=n(2997),_=n(2111),D=function(e){function t(t){var n=e.call(this)||this;return n.preserveBody=t,n}return Object(s.__extends)(t,e),t.prototype.internalPrepareForExecution=function(t){var n=this.body;e.prototype.internalPrepareForExecution.call(this,t),this.preserveBody&&(this.body=n)},t.prototype.parse=function(t){e.prototype.parse.call(this,t),this.isPrimary=t.isPrimary},t}(_.HttpAction),T=n(2);!function(e){e[e.UnResolved=0]="UnResolved",e[e.InProgress=1]="InProgress",e[e.Resolved=2]="Resolved"}(C||(C={})),function(e){e[e.Empty=0]="Empty",e[e.Success=1]="Success",e[e.Error=2]="Error"}(j||(j={}));var k,E,P={cache:{data:null,state:j.Empty,time:null},requestState:C.UnResolved},N=Object(T.createStore)("amClientConfigurationStore",P)(),R=function(){var e,t,n=null;return(null===(t=null===(e=N.cache.data)||void 0===e?void 0:e.clientTimeouts)||void 0===t?void 0:t.default)&&(n=N.cache.data.clientTimeouts.default),n},U=n(6),F=n(7257),J=n(8959),H=n(52),z=n(80),L=n(17),B=n(10);!function(e){e[e.Empty=0]="Empty",e[e.Success=1]="Success",e[e.Error=2]="Error"}(k||(k={})),function(e){e[e.UnResolved=0]="UnResolved",e[e.InProgress=1]="InProgress",e[e.Resolved=2]="Resolved"}(E||(E={}));var q={cache:{data:{Url:"/actions"},state:k.Empty,time:null},requestState:E.UnResolved},G=Object(T.createStore)("amActionEndpointStore",q)(),W=function(){return!!Object(B.c)(window)&&!!Object(B.a)(window,"ActionableMessages.ActionEndpoint")},V=function(){return Object(I.i)("rp-actionableMessagesAutoD")?G.cache.data.Url:"/actions"},Y=function(e,t,n,r,a){var o=e["@id"]?e["@id"]:e.id,c={"@type":"HttpPOST",name:e.title,target:e.url,body:e.body,"@id":o,hideCardOnInvoke:e.hideCardOnInvoke,isPrimaryAction:!!e.isPrimary&&e.isPrimary};e.headers&&e.headers.length>0&&(c.headers=e.headers);var u=Object(L.a)(),d=[];if(t)for(var l=0;l<t.length;l++){var p=t[l],b=new _.ValidationResults;if(p.internalValidateProperties(b),b.failures.length>0)return Promise.resolve({success:!1,displayMessage:b.failures[0].errors[0].message});if(p){var f=void 0;f="Input.Date"===p.getJsonTypeName()?{id:p.id,value:p.value,usertimezone:u.UserOptions.TimeZone}:{id:p.id,value:p.value},d.push(f)}}var g,h={type:_.HttpAction.JsonTypeName,url:e.url,body:e.body,method:e.method,id:e.id?e.id:"30d2f5e2-6e6f-43b0-a2bd-c9d87a5cd6fd",headers:e.headers},m=u.SessionSettings.UserCulture,v={type:e.getJsonTypeName(),id:e.id},O={eventName:$(e,a),messageContext:r,cardDetails:n,elementDetails:v,actionContext:e.actionContext},y=Object(i.b)(O);if(y.messageCardContext)try{y.messageCardContext=JSON.parse(y.messageCardContext)}catch(e){}if(y.messageCardExtensionContext)try{y.messageCardExtensionContext=JSON.parse(y.messageCardExtensionContext)}catch(e){}if(y.actionContext)try{y.actionContext=JSON.parse(y.actionContext)}catch(e){}return n.isAdaptiveCard?g={httpAction:h,inputParameters:d,connectorSenderGuid:n.connectorSenderGuid,SmtpAddressesSerialized:n.smtpAddressesSerialized,adaptiveCardSignature:n.cardSignature,providerAccountUniqueId:n.providerAccountUniqueId,clientTelemetry:y,adaptiveCardHash:n.cardHash,senderAddress:r.senderAddress}:(c=Object(s.__assign)(Object(s.__assign)({},e.originalJsonPayload),c),g={inputParameters:d,connectorSenderGuid:n.connectorSenderGuid,potentialAction:JSON.stringify(c),SmtpAddressesSerialized:n.smtpAddressesSerialized,messageCardSignature:n.cardSignature,providerAccountUniqueId:n.providerAccountUniqueId,clientTelemetry:y,tenantObjectId:u.SessionSettings.ExternalDirectoryTenantGuid,messageCardHash:n.cardHash,senderAddress:r.senderAddress,culture:m,uiCulture:m}),Z(K(r,m,n.isAdaptiveCard),JSON.stringify(g),"HttpAction",null,te(n),a)},$=function(e,t){return t?"AutoInvokeActionClicked":e.parent&&"InlineAdaptiveCard"===e.parent.constructor.name?"ActionCardHttpPostActionClicked":"SingleClickHttpPostActionClicked"},K=function(e,t,n){var r="UserMailbox"===e.mailboxInfo.type?"userid":e.mailboxInfo.mailboxSmtpAddress,a=e.odataItemId,i=e.odataConversationId,o=V();switch(e.mailboxInfo.type){case"UserMailbox":return n?Object(U.c)("{0}/{1}/messages/{2}/adaptiveCard/executeAction?culture={3}",o,r,a,t):Object(U.c)("{0}/{1}/messages/{2}/executeAction?culture={3}",o,r,a,t);case"GroupMailbox":case"TeamsMailbox":return n?Object(U.c)("{0}/{1}/threads/{2}/posts/{3}/adaptiveCard/executeAction?culture={4}",o,r,i,a,t):Object(U.c)("{0}/{1}/threads/{2}/posts/{3}/executeAction?culture={4}",o,r,i,a,t);case"PublicMailbox":case"SharedMailbox":case"ArchiveMailbox":return null}},Z=function(e,t,n,r,i,o){return void 0===o&&(o=!1),Object(s.__awaiter)(void 0,void 0,void 0,(function(){var c,u,d,l;return Object(s.__generator)(this,(function(s){switch(s.label){case 0:c=r||Object(z.b)(),u={correlationVector:c,cardCorrelationId:i,requestType:n},s.label=1;case 1:return s.trys.push([1,5,,6]),[4,Object(M.a)()];case 2:return(d=s.sent())?[3,4]:(a.g.warn("[ActionableMessageDebug] makePostRequest: Unable to get the client Auth token possibly AAD token"),[4,Object(M.b)()]);case 3:d=s.sent(),s.label=4;case 4:if(!d)throw new Error("Token is empty: "+d);return[3,6];case 5:return l=s.sent(),a.g.warn("[ActionableMessageDebug] makePostRequest: Error while getting token, error: "+l),Object(S.p)("ActionableMessageConnectorsPostRequestErrorGettingToken",void 0,void 0,l,u,{isCore:!0}),[2,{success:!1,displayMessage:Object(U.b)(F.a)}];case 6:return[4,X(e,d,t,o,c,u)];case 7:return[2,s.sent()]}}))}))},X=function(e,t,n,r,a,i){return new Promise((function(o){var c=new XMLHttpRequest;c.onreadystatechange=function(){4===c.readyState&&o(Q(200===c.status,c.responseText))},c.ontimeout=function(){o({success:!1,displayMessage:Object(U.b)(F.a)}),Object(S.p)("ActionableMessageConnectorsPostRequestTimeout",void 0,void 0,void 0,i,{isCore:!0})},c.open("POST",e,!0),c.timeout=function(e){var t=e?6e3:1e4,n=R();return e&&(null==n?void 0:n.AutoInvokedActionTimeoutInMsec)?t=n.AutoInvokedActionTimeoutInMsec:!e&&(null==n?void 0:n.HttpActionTimeoutInMsec)&&(t=n.HttpActionTimeoutInMsec),t}(r),c.setRequestHeader("MS-CV",a),c.setRequestHeader("X-OWA-CANARY",Object(H.a)()),c.setRequestHeader("Authorization","Bearer "+t),c.send(n)}))},Q=function(e,t){try{var n=JSON.parse(t),r=!!e&&ee(n.status);return{success:r,status:n.status,displayMessage:n.displayMessage?n.displayMessage:r?Object(U.b)(J.a):Object(U.b)(F.a),performedAt:n.performedAt,newCardPayload:n.refreshCardSerialized,newCardSignature:n.refreshCardSignature,removeCard:n.removeCard,showOriginalCard:n.showOriginalCard,hideCard:n.hideCard,authenticationUrl:n.authenticationUrl,cardUpdates:n.cardUpdates,errors:n.errors}}catch(e){return{success:!1,displayMessage:Object(U.b)(F.a)}}},ee=function(e){return e&&"completed"===e.toLowerCase()},te=function(e){try{return e.card.messageCardContext.correlationId}catch(e){return""}};function ne(e){var t=new D(!0);return t.method="POST",t.body=e.body,t.title=e.name,t.originalJsonPayload=e,e.headers&&e.headers.length>0&&(t.headers=[],e.headers.forEach((function(e){t.headers.push(new _.HttpHeader(e.name,e.value))}))),t.url=e.target,t["@id"]=e["@id"],t.hideCardOnInvoke=e.hideCardOnInvoke,t}var re="HttpPOST";var ae=n(233);var ie="{0}{1}/theme";function oe(e){return void 0===e&&(e="default"),Object(s.__awaiter)(this,void 0,void 0,(function(){var t,n,r,a,o,c,u;return Object(s.__generator)(this,(function(s){switch(s.label){case 0:return[4,Object(M.b)()];case 1:t=s.sent(),n=function(e,t){var n={},r=Object(i.a)();return r=r.replace(/[^\d]/g,""),n.method="GET",n.headers=new Headers,n.headers.set("X-ClientType","owa"),n.headers.set("X-ClientVersion","16."+r.substr(0,4)+"."+r.substr(4,4)+"."+r.substr(8)),n.headers.set("X-ClientColorScheme",t),n.headers.set("Authorization","Bearer "+e),n}(t,e),r=Object(U.c)(ie,window.location.origin,V()),a=void 0,s.label=2;case 2:return s.trys.push([2,7,,8]),[4,fetch(r,n)];case 3:return(o=s.sent())&&200==o.status?(c=ce,[4,o.text()]):[3,5];case 4:return[2,c.apply(void 0,[s.sent()])];case 5:a=o?o.status+"-"+o.statusText:"No response",s.label=6;case 6:return[3,8];case 7:return u=s.sent(),a=u.message,[3,8];case 8:throw a}}))}))}function ce(e){var t={};try{var n=JSON.parse(e).connectors;Object.keys(n).forEach((function(e){var r={themeConfigUrl:n[e],hostConfig:null,stylesheetUrl:null,isResolved:!1};t[e]=r}))}catch(e){a.g.warn("[ActionableMessageDebug] downloadThemeDefinition: error parsing response: "+e)}return t}var se=function(){return!!Object(B.c)(window)&&!!Object(B.a)(window,"ActionableMessages.ClientConfiguration")},ue=function(){return N.cache.state!==j.Empty},de=function(){var e,t,n,r=Date.now()-N.cache.time;return N.cache.state===j.Success&&r>=432e6||N.cache.state===j.Error&&r>=864e5||(n=null===(t=null===(e=N.cache.data)||void 0===e?void 0:e.themeMappings)||void 0===t?void 0:t.connectors,Object(I.i)("rp-actionableMessagesThemeConfig")&&N.cache.state===j.Success&&null===n)},le=Object(T.mutatorAction)("updateRequestState",(function(e){N.requestState=e})),pe=n(217),be=function(){return Object(s.__awaiter)(void 0,void 0,void 0,(function(){var e,t,n,r;return Object(s.__generator)(this,(function(a){switch(a.label){case 0:return a.trys.push([0,6,,7]),o=Object(pe.c)(),c=Object(i.a)(),e=V()+"/v1.0/"+o+"/clientConfigs/WAC_Outlook_React?clientVersion="+c+"&clientColorScheme=default&$expand=providerConfigs",[4,Object(s.__awaiter)(void 0,void 0,void 0,(function(){var e,t;return Object(s.__generator)(this,(function(n){switch(n.label){case 0:return e=new Headers,[4,Object(M.a)()];case 1:return t=n.sent(),e.set("Authorization",function(e){return"Bearer "+e}(t)),e.set("MS-CV",Object(z.b)()),[2,e]}}))}))];case 1:return t=a.sent(),n=new Request(e,{method:"GET",headers:t}),[4,fetch(n)];case 2:return(r=a.sent()).ok?[4,r.json()]:[3,4];case 3:return[2,a.sent()];case 4:throw r;case 5:return[3,7];case 6:throw a.sent();case 7:return[2]}var o,c}))}))},fe=Object(T.mutatorAction)("setClientConfiguration",(function(e){N.cache=e})),ge=function(){return N.cache},he=function(e){var t,n,r,a;void 0===e&&(e=!1);var i,o=ge();if(i=e?null===(n=null===(t=null==o?void 0:o.data)||void 0===t?void 0:t.themeMappingsDarkMode)||void 0===n?void 0:n.connectors:null===(a=null===(r=null==o?void 0:o.data)||void 0===r?void 0:r.themeMappings)||void 0===a?void 0:a.connectors){var c={};return Object.keys(i).forEach((function(e){var t={themeConfigUrl:i[e],hostConfig:null,stylesheetUrl:null,isResolved:!1};c[e]=t})),c}return null},me=function(e,t){void 0===t&&(t=null);var n={data:t,state:e,time:Date.now()};if(null===t){var r=ge();n.data=r.data}return n},ve=Object(T.action)("loadClientConfiguration");Object(T.orchestrator)(ve,(function(){return Object(s.__awaiter)(void 0,void 0,void 0,(function(){var e,t,n;return Object(s.__generator)(this,(function(i){switch(i.label){case 0:le(C.InProgress),e=null,i.label=1;case 1:return i.trys.push([1,3,4,5]),[4,be()];case 2:return t=i.sent(),e=me(j.Success,t),[3,5];case 3:return i.sent(),e=me(j.Error),[3,5];case 4:return fe(e),function(e){if(Object(B.c)(window))try{Object(B.e)(window,"ActionableMessages.ClientConfiguration",JSON.stringify(e))}catch(e){a.g.info("[ActionableMessageDebug] owa-actionable-message-connectors loadClientConfiguration setClientConfigurationInLocalStorage Exception on setItem|JSON.stringify "+e.toString())}}(e),le(C.Resolved),Object(I.i)("rp-actionableMessagesThemeConfig")&&(n=he(),Object(r.g)(n)),[7];case 5:return[2]}}))}))}));var Oe=ve,ye=function(){N.requestState!==C.InProgress&&Oe()},Ce=function(){return se()?JSON.parse(Object(B.a)(window,"ActionableMessages.ClientConfiguration")):null},je=function(){return G.cache.state!==k.Empty},Ae=function(){var e=Date.now()-G.cache.time;return G.cache.state===k.Success&&e>=432e6||G.cache.state===k.Error&&e>=864e5},xe=Object(T.mutatorAction)("updateActionEndpointRequestState",(function(e){G.requestState=e})),Se=function(){return Object(s.__awaiter)(void 0,void 0,void 0,(function(){var e,t,n;return Object(s.__generator)(this,(function(r){switch(r.label){case 0:return r.trys.push([0,5,,6]),e="/autodiscover/autodiscover.json/v1.0/"+Object(pe.c)()+"?Protocol=Actions",t=new Request(e,{method:"GET"}),[4,fetch(t)];case 1:return(n=r.sent()).ok?[4,n.json()]:[3,3];case 2:return[2,r.sent()];case 3:throw n;case 4:return[3,6];case 5:throw r.sent();case 6:return[2]}}))}))},we=Object(T.mutatorAction)("setActionEndpoint",(function(e){G.cache=e})),Ie=function(e,t){void 0===t&&(t=null);var n=G.cache.data;return(null==t?void 0:t.Url)?n.Url="/"+t.Url.split("/").pop():e=k.Error,{data:n,state:e,time:Date.now()}},Me=Object(T.action)("loadActionEndpoint");Object(T.orchestrator)(Me,(function(){return Object(s.__awaiter)(void 0,void 0,void 0,(function(){var e,t;return Object(s.__generator)(this,(function(n){switch(n.label){case 0:xe(E.InProgress),e=null,n.label=1;case 1:return n.trys.push([1,3,4,5]),[4,Se()];case 2:return t=n.sent(),e=Ie(k.Success,t),[3,5];case 3:return n.sent(),e=Ie(k.Error),[3,5];case 4:return we(e),function(e){if(Object(B.c)(window))try{Object(B.e)(window,"ActionableMessages.ActionEndpoint",JSON.stringify(e))}catch(e){a.g.info("[ActionableMessageDebug] owa-actionable-message-connectors loadActionEndpoint setActionEndpointInLocalStorage Exception on setItem|JSON.stringify "+e.toString())}}(e),xe(E.Resolved),[7];case 5:return[2]}}))}))}));var _e=Me,De=function(){G.requestState!==E.InProgress&&_e()},Te=function(){je()?Ae()&&De():W()?(we(W()?JSON.parse(Object(B.a)(window,"ActionableMessages.ActionEndpoint")):null),xe(E.Resolved),Ae()&&De()):De()},ke=function(){return null!==ge().data},Ee=function(){if(Object(I.i)("rp-actionableMessagesAutoD")&&Te(),ue())return de()&&ye(),ke();if(se()){if(fe(Ce()),le(C.Resolved),de()&&ye(),Object(I.i)("rp-actionableMessagesThemeConfig")){var e=he();Object(r.g)(e)}return ke()}return ye(),!1},Pe=function(){var e,t,n=!1;if(Ee()){var r=ge();(null===(t=null===(e=null==r?void 0:r.data)||void 0===e?void 0:e.organizationConfigs)||void 0===t?void 0:t.SmtpActionableMessagesEnabled)&&(n=!0)}return n},Ne=function(e,t){var n,r,a=!1;try{for(var i=Object(s.__values)(e),o=i.next();!o.done;o=i.next()){if(o.value.originator===t){a=!0;break}}}catch(e){n={error:e}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}return a},Re=function(e,t){var n,r,a=!1;if(Ee()){var i=ge();!t&&(null===(n=null==i?void 0:i.data)||void 0===n?void 0:n.providerConfigs)?a=Ne(i.data.providerConfigs,e):t&&(null===(r=null==i?void 0:i.data)||void 0===r?void 0:r.providerConfigsDarkMode)&&(a=Ne(i.data.providerConfigsDarkMode,e))}return a},Ue="data:",Fe="blob:";function Je(e,t,n){var r=e.querySelectorAll('img:not([src^="cid:"])');if(r)for(var a=0;a<r.length;a++)0!==r[a].src.indexOf(Ue)&&0!==r[a].src.indexOf(Fe)&&He(r[a],t.mailboxSmtpAddress,n)}function He(e,t,n){return Object(s.__awaiter)(this,void 0,void 0,(function(){var r,i;return Object(s.__generator)(this,(function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),[4,ze(V()+"/"+t+"/th?u="+encodeURIComponent(e.src),t,n)];case 1:return r=o.sent(),e.src=r,[3,3];case 2:return i=o.sent(),a.g.warn("[ActionableMessageDebug] fixSrcForExternalImage: Error setting src value. Exception: "+i.message),[3,3];case 3:return[2]}}))}))}function ze(e,t,n){return Object(s.__awaiter)(this,void 0,void 0,(function(){var r=this;return Object(s.__generator)(this,(function(a){return[2,new Promise((function(a,i){return Object(s.__awaiter)(r,void 0,void 0,(function(){var r,o;return Object(s.__generator)(this,(function(c){switch(c.label){case 0:return[4,Object(M.b)()];case 1:return(r=c.sent())?((o=new XMLHttpRequest).open("GET",e),o.responseType="blob",o.setRequestHeader("Authorization","Bearer "+r),o.setRequestHeader("X-AnchorMailbox",t),n&&o.setRequestHeader("X-OriginatorId",n),o.onreadystatechange=function(){if(4===o.readyState)try{var e=function(e){try{if(200==e.status){var t=e.response,n=e.getResponseHeader("Content-Type");if(n&&0===n.toLowerCase().indexOf("image")&&t instanceof Blob)return URL.createObjectURL(t)}}catch(e){throw e}return null}(o);a(e)}catch(e){i(e)}},o.send()):i(new Error("token not generated")),[2]}}))}))}))]}))}))}var Le=function(e){return["https://outlook.office365.com","https://outlook.office.com","https://outlook-sdf.office.com","https://outlook-sdf.office365.com","https://emea.mail.microsoft.com","https://outlook-sdf.live.com","https://outlook.live.com"].includes(e)},Be=function(e){var t,n,r=V(),a="UserMailbox"!==(null===(t=e.mailboxInfo)||void 0===t?void 0:t.type)?null===(n=e.mailboxInfo)||void 0===n?void 0:n.mailboxSmtpAddress:"userid",i=e.odataItemId;return Object(U.c)("{0}/{1}/messages/{2}/adaptiveCardV2/action",r,a,i)},qe=function(){var e,t,n,r=null;return(null===(n=null===(t=null===(e=N.cache.data)||void 0===e?void 0:e.clientTimeouts)||void 0===t?void 0:t.default)||void 0===n?void 0:n.SnackBarTimeoutInMsec)&&(r=N.cache.data.clientTimeouts.default.SnackBarTimeoutInMsec),null!==r?r:8e3},Ge={registerActions:function(){_.AdaptiveCard.actionTypeRegistry.unregisterType(_.SubmitAction.JsonTypeName),_.AdaptiveCard.actionTypeRegistry.registerType(_.HttpAction.JsonTypeName,(function(){return new D(!1)}))},executeAction:function(e,t,n,r,i,o,c){return e instanceof D&&(Y(e,n,t,i,c).then((function(e){a.g.info("[ActionableMessageDebug] onExecuteAction: executeHttpAction response: "+e),r(e)})),!0)},parseLegacyMessageCardAction:function(e,t){switch(e["@type"]){case"HttpPOST":return ne(e)}return null},processAutoInvokeAction:function(e,t){if(e.type===_.HttpAction.JsonTypeName||e["@type"]===re){var n=void 0;return t.isAdaptiveCard?((n=new D(!1)).parse(e),n.hideCardOnInvoke=e.hideCardOnInvoke):n=ne(e),n}return null},registerHostCapabilities:function(e){Object(I.i)("rp-actionableMessages-aad-token")&&!Object(ae.a)()&&(e.AADAuthentication="*")}},We="TransactionCardDisabled",Ve="messageCardContext";var Ye="Action.Transaction",$e=n(2255),Ke=n(2442),Ze=n(15895),Xe={PPE:"https://interactive-ppe.outlook.com/ux/app",PROD:"https://interactive.outlook.com/ux/app",DEV:"https://opay-dev-wc-svc.cloudapp.net/ux/app"},Qe=function(e){function t(){var t=e.call(this)||this;return t.environment="prod",t.triggerContext=null,t.intent="",t.merchantId="",t.displayId="",t}return Object(s.__extends)(t,e),t.prototype.getJsonTypeName=function(){return Ye},t.prototype.parse=function(t){e.prototype.parse.call(this,t),this.isPrimary=t.isPrimary,t.initializationContext?(this.intent=t.initializationContext.intent,this.merchantId=t.initializationContext.merchantId,this.displayId=t.initializationContext.displayId,this.productContext=t.initializationContext.productContext,this.environment=t.initializationContext.environment):(this.intent=t.intent,this.merchantId=t.merchantId,this.displayId=t.displayId,this.productContext=t.productContext,this.environment=t.environment),this.triggerContext={MerchantId:this.merchantId,DisplayId:this.displayId,CorrelationId:Object(z.b)(),Culture:Object(L.a)().SessionSettings.UserCulture,Market:Object($e.f)(),Environment:this.environment},Ke.set("DefaultAnchorMailbox",Ke.get("DefaultAnchorMailbox"),{path:"/actions/"}),Object(I.i)("ring-dogfood")&&Ke.set("DefaultAnchorMailbox",Ke.get("DefaultAnchorMailbox"),{path:"/opay/"})},t.prototype.execute=function(){e.prototype.execute.call(this),this.triggerContext.CorrelationId=Object(z.b)()},t.prototype.getIFrameElement=function(){var e=Object(I.i)("rp-opay-modelb-endpoint")?window.location.origin+"/opay":this.getSvcEndpoint(),t=encodeURIComponent(JSON.stringify(this.productContext)),n=e+"/?triggerContext="+encodeURIComponent(JSON.stringify(this.triggerContext))+"&productContext="+t;return A.createElement("div",{className:Ze.opayFlexPaneContainer},A.createElement("iframe",{id:"opay_iframe",className:Ze.opayAppIFrameStyle,src:n}))},t.prototype.getSvcEndpoint=function(){return this.environment?0===this.environment.indexOf("dev")?Xe.DEV:"ppe"===this.environment.toLowerCase()?Xe.PPE:Xe.PROD:Xe.PROD},t}(_.Action),et={shouldShowModalFlexPane:!1,modalFlexPaneContent:void 0},tt=Object(T.createStore)("OPayPanel",et)(),nt=Object(T.mutatorAction)("SHOW_OPAY_PANEL",(function(e){tt.shouldShowModalFlexPane=!0,tt.modalFlexPaneContent=e})),rt="TransactionActionEvent",at="actionContext";var it={registerActions:function(){_.AdaptiveCard.actionTypeRegistry.registerType(Ye,(function(){return new Qe}))},executeAction:function(e,t,n,r,i,o,c){if(!(e instanceof Qe))return!1;a.g.info("[ActionableMessageDebug] Transaction executed");var s=e,u={id:s.id,type:s.getJsonTypeName()};return o.logTelemetry({cardDetails:t,elementDetails:u,eventName:rt,actionContext:e[at],messageContext:i}),nt(s.getIFrameElement()),!0},parseLegacyMessageCardAction:function(e,t){switch(e["@type"]){case"Transaction":return n=e,(r=new Qe).parse(n),r.title=n.name,r}var n,r;return null},registerHostCapabilities:function(e){e.Transaction="*",e["Transaction.MSA"]="*"}},ot=n(3394),ct=n(1596),st=n(375),ut=n(1840),dt=Object(T.mutatorAction)("HIDE_OPAY_PANEL",(function(){tt.shouldShowModalFlexPane=!1,tt.modalFlexPaneContent=void 0})),lt=Object(x.a)((function(e){return Object(ut.a)("message",(function(t){var n=t.origin.toLowerCase();if(Object.keys(Xe).some((function(e){return 0!==Xe[e].indexOf(n)}))){var r=null;try{r=JSON.parse(t.data)}catch(e){a.g.warn("Unable to parse post message data: "+t.data)}if(r){var i=r.action;if(i)switch(i){case"close":dt();break;case"token":Object(M.a)().then((function(t){var r=document.querySelector("#opay_iframe");r&&r.contentWindow.postMessage(JSON.stringify({action:"token",token:t,messageContext:{messageId:e.odataItemId,smtpAddressesSerialized:e.smtpAddressesSerialized},result:"Success"}),n)})).catch((function(){window.postMessage(JSON.stringify({action:"token",result:"Failed"}),n)}))}}}})),A.createElement(ct.a,{key:"modalFlexPane",onDismiss:function(){dt()},isOpen:tt.shouldShowModalFlexPane,type:st.a.smallFixedFar,closeButtonAriaLabel:Object(U.b)(ot.a)},tt.modalFlexPaneContent)})),pt=Object(T.mutatorAction)("addCardDetailsOnItem",(function(e,t){e.adaptiveCardDetails&&e.adaptiveCardDetails.length>0?a.g.info("[ActionableMessageDebug] addCardDetailsOnItem - item already has a card details"+e.adaptiveCardDetails):e.adaptiveCardDetails=t})),bt=Object(T.mutatorAction)("updateCardDetailsOnItem",(function(e,t){e.adaptiveCardDetails=t})),ft=Object(T.mutatorAction)("SET_SHOW_BODY_WITH_MESSAGE_CARD",(function(e,t){e?e.showBodyWithMessageCard=t:a.g.warn("[ActionableMessageDebug] setShowBodyWithMessageCard: viewState undefined")})),gt=Object(T.action)("showCardLoading",(function(e,t){return{viewState:e,showCardLoading:t}})),ht=(Object(T.mutator)(gt,(function(e){e.viewState.showCardLoading=e.showCardLoading})),n(2359)),mt=n(1654),vt=n(10040),Ot=/url\("(.*)"\)/g,yt=new vt.a(5,5e3),Ct=function(e,t,n){var r=e.querySelectorAll('img[src^="cid:"]');if(r)for(var a=0;a<r.length;a++)jt(r[a],t,n);var i=e.querySelectorAll("div[style*='background-image: url(\"cid:']");if(i)for(a=0;a<i.length;a++)At(i[a],t,n)},jt=function(e,t,n){if(e.src&&0===e.src.indexOf("cid:")){e.classList.add("ac-hidden");var r=xt(e.src,t,n);if(r){e.onload=function(t){e.classList.remove("ac-hidden"),yt.processNextRequest()},e.onerror=function(t){var n=t.target;0===n.src.indexOf("cid:")?a.g.info("[ActionableMessageDebug] imageSrcChangePending: image src has not been changed for cid: "+n.src):(e.classList.remove("ac-hidden"),yt.processNextRequest(),a.g.info("[ActionableMessageDebug] imageSrcError: image cannot be loaded for src: "+n.src))},yt.registerCallback((function(t){t||(e.src=r)}))}}},At=function(e,t,n){var r=e.style.backgroundImage,a=Ot.exec(r);if(a&&a.length>1&&a[1]){var i=xt(a[1],t,n);i&&(e.style.backgroundImage=Object(U.c)('url("{0}")',i))}},xt=function(e,t,n){if(!t.Attachments)return null;for(var r,i=St(e.substring("cid:".length)),o=0;o<t.Attachments.length;o++){var c=t.Attachments[o];if(i===St(c.Name)||i===St(c.ContentId)){r=c.AttachmentId;break}}if(!r)return a.g.warn("[ActionableMessageDebug] fixSrcForImage: attachment id not found for cid: "+i),null;var u=Object(ht.b)(Object(s.__assign)(Object(s.__assign)({},r),{mailboxInfo:n}),1);return u||(a.g.warn("[ActionableMessageDebug] fixSrcForImage: could not create attachment url for image with cid: "+i+" and attachment id: "+r),null)},St=function(e){if(Object(mt.g)(e)){var t=Object(mt.b)(e);return e.substring(0,e.length-t.length)}return e},wt=n(8361),It=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(s.__extends)(t,e),t.prototype.getJsonTypeName=function(){return"DisplayAppointmentForm"},t.prototype.parse=function(t){e.prototype.parse.call(this,t),this.itemId=t.itemId,this.isPrimary=t.isPrimary},t}(_.Action),Mt="Action.InvokeAddInCommand",_t="Action.PinAddInCommand",Dt="Action.DisplayReplyAllForm",Tt="Action.DisplayAppointmentForm",kt="Action.DisplayMessageForm",Et="Action.StartBotConversation",Pt=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(s.__extends)(t,e),t.prototype.getJsonTypeName=function(){return kt},t.prototype.parse=function(t){e.prototype.parse.call(this,t),this.itemId=t.itemId,this.isPrimary=t.isPrimary},t}(_.Action),Nt=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(s.__extends)(t,e),t.prototype.getJsonTypeName=function(){return"DisplayReplyAllForm"},t.prototype.parse=function(t){e.prototype.parse.call(this,t),this.isPrimary=t.isPrimary},t}(_.Action),Rt=function(e){function t(){var t=e.call(this)||this;return t.addinId="",t.desktopCommandId="",t.initializationContext="",t}return Object(s.__extends)(t,e),t.prototype.parse=function(t){e.prototype.parse.call(this,t),this.isPrimary=t.isPrimary,this.addinId=t.addInId?t.addInId:t.addinid,this.desktopCommandId=t.desktopCommandId?t.desktopCommandId:t.desktopcommandid,this.initializationContext=t.initializationContext?JSON.stringify(t.initializationContext):JSON.stringify(t.initializationcontext)},t.prototype.getJsonTypeName=function(){return Mt},t}(_.Action),Ut=function(e){function t(){var t=e.call(this)||this;return t.productId="",t.newPinnedStatus=!1,t}return Object(s.__extends)(t,e),t.prototype.parse=function(t){e.prototype.parse.call(this,t),this.isPrimary=t.isPrimary,this.productId=t.productId,this.newPinnedStatus=t.newPinnedStatus},t.prototype.getJsonTypeName=function(){return _t},t}(_.Action),Ft=function(e){function t(){var t=e.call(this)||this;return t.botId="",t.initialMessage="",t.botName="",t}return Object(s.__extends)(t,e),t.prototype.parse=function(t){e.prototype.parse.call(this,t),this.isPrimary=t.isPrimary,this.botId=t.botId,this.botName=t.botName,this.initialMessage=t.initialMessage},t.prototype.getJsonTypeName=function(){return Et},t}(_.Action),Jt=n(1657),Ht=n(1751),zt=n(873),Lt=n(8935),Bt=n(1762),qt=n(3052),Gt=n(7418),Wt=n(1667),Vt=n(1683),Yt="MessageCardInvokeAddinCommandClicked",$t="MessageCardPinAddinCommandClicked",Kt="DisplayAppointmentFormClicked",Zt="DisplayMessageFormClicked",Xt="actionContext";var Qt={registerActions:function(){_.AdaptiveCard.actionTypeRegistry.registerType(Mt,(function(){return new Rt})),_.AdaptiveCard.actionTypeRegistry.registerType(_t,(function(){return new Ut})),_.AdaptiveCard.actionTypeRegistry.registerType(Dt,(function(){return new Nt})),_.AdaptiveCard.actionTypeRegistry.registerType(Tt,(function(){return new It})),_.AdaptiveCard.actionTypeRegistry.registerType(kt,(function(){return new Pt})),Object(I.i)("mc-botConversation")&&_.AdaptiveCard.actionTypeRegistry.registerType(Et,(function(){return new Ft}))},executeAction:function(e,t,n,r,i,o,c){var u={id:e.id,type:e.getJsonTypeName()},d={cardDetails:t,elementDetails:u,messageContext:i,actionContext:e[Xt],eventName:void 0};if(e instanceof Nt){a.g.info("[ActionableMessageDebug] onExecuteAction: reply all with: "+e.title);var l=Wt.HtmlSanitizer.sanitizeHtml(e.title);Bt.o.importAndExecute({referenceItemId:{Id:i.itemId,mailboxInfo:i.mailboxInfo},isReplyAll:!0,useFullCompose:!1,actionSource:"Link",instrumentationContexts:null,conversationId:i.conversationId,body:l})}else if(e instanceof It){a.g.info("[ActionableMessageDebug] onExecuteAction: display appointment form for itemId: "+e.itemId),d.eventName=Kt,o.logTelemetry(d);var p="/calendar/item/"+encodeURIComponent(e.itemId);window.open(p,"_blank")}else if(e instanceof Pt)a.g.info("[AdaptiveCard] DisplayMessageFormAction executed"),d.eventName=Zt,o.logTelemetry(d),Object(qt.a)(e.itemId);else if(e instanceof Ut&&Object(I.i)("addin-pinThroughAM")){a.g.info("[AdaptiveCard] PinAddinCommandAction executed"),d.eventName=$t,o.logTelemetry(d),function(e){var t,n,r=Object(Vt.r)().Extensions;try{for(var a=Object(s.__values)(r),i=a.next();!i.done;i=a.next()){var o=i.value;if(o.Id===e.productId){var c={readMode:null!=o.ExtensionPointCollection.MessageReadCommandSurface,composeMode:null!=o.ExtensionPointCollection.MessageComposeCommandSurface,calendarMode:null!=o.ExtensionPointCollection.AppointmentOrganizerCommandSurface&&null!=o.ExtensionPointCollection.AppointmentAttendeeCommandSurface};zt.i.importAndExecute(e.productId.toLowerCase(),e.newPinnedStatus,c);break}}}catch(e){t={error:e}}finally{try{i&&!i.done&&(n=a.return)&&n.call(a)}finally{if(t)throw t.error}}}(e)}else if(e instanceof Rt){a.g.info("[AdaptiveCard] InvokeAddinCommandAction executed"),d.eventName=Yt,o.logTelemetry(d);var b=e,f=Object(Jt.p)(i.itemId);Jt.y.import().then((function(e){e(f,b.addinId.toLowerCase(),b.desktopCommandId,Ht.a.MessageRead,b.initializationContext)}))}else if(e instanceof Ft){var g=e,h=g.botId,m=g.botName,v=function(e){if(null==e?void 0:e.$data)return e.$data;return}(t.card);a.g.info("[ActionableMessageDebug] StartBotConversation executed with message: "+h),Lt.a.import().then((function(e){return e(i.mailboxInfo,{friendlyBotName:m,botId:h,botData:v,connectorSenderGuid:t.connectorSenderGuid,smtpAddressSerialized:t.smtpAddressesSerialized},"help")})),o.logTelemetry(d)}else{if(!(e instanceof _.OpenUrlAction))return!1;if("mailto:"===(p=new URL(e.url)).protocol.toLowerCase()){var O=Object(Gt.a)(p.href).composeInitProps;Bt.m.importAndExecute(O,2)}}return!0},parseLegacyMessageCardAction:function(e,t){switch(e["@type"].toLowerCase()){case"displayreplyallform":return n=e,(r=new Nt).title=n.name,r.htmlBody=n.htmlBody,r;case"invokeaddincommand":return function(e){var t=new Rt;return t.title=e.name,t.addinId=e.addInId,t.desktopCommandId=e.desktopCommandId,t.initializationContext=JSON.stringify(e.initializationContext),t}(e);case"pinaddincommand":return function(e){var t=new Ut;return t.title=e.name,t.productId=e.productId,t.newPinnedStatus=e.newPinnedStatus,t}(e)}var n,r;return null},processAutoInvokeAction:function(e,t){if(Object(I.i)("mc-botConversation")&&e.type===Et){var n=new Ft;return n.parse(e),n}return null},registerHostCapabilities:null},en=n(15897),tn=n(15898),nn=n(15899),rn=n(350);var an,on={ComponentDidMount:"11",ComponentWillUnMount:"12",ComponentDidUpdate:"13",FetchInProgress:"14",CardDetailsPresent:"15",FetchInitiated:"16",NotUpdatingCardDetailsAsItAlreadyPresent:"17",FetchSuccess:"18",CardId:"19",ItemId:"110",FetchError:"111",FetchException:"112",RenderCard:"113",NoCard:"114",ShowMessage:"115",UpdateOnItem:"116",UpdateLoadingState:"117",FinishLoading:"118",Render:"119"},cn=function(){return Object(I.i)("rp-actionableMessages-ACv2-support")},sn=n(3622),un=n(65);!function(e){e.Completed="Completed",e.Failed="Failed"}(an||(an={}));var dn,ln=function(e){function t(t,n,a,i){var o=e.call(this,t)||this;return o.parseCardFromStringOrObject=function(e){return Object(s.__awaiter)(o,void 0,void 0,(function(){var t=this;return Object(s.__generator)(this,(function(n){switch(n.label){case 0:return[4,r.f.import().then((function(n){return n(t.cardDetails,t.cardDetails.connectorSenderGuid,e.newCardPayload,e.newCardSignature,!0,t.cardDetails.cardId)}))];case 1:return[2,n.sent()]}}))}))},o.cardDetails=n,o.messageContext=a,o.onCardDetailsUpdated=i,o}return Object(s.__extends)(t,e),t.prototype.parseResponse=function(e,t){var n,r=t&&e.status===an.Completed;return n=e.displayMessage?e.displayMessage:e.errorMessage?e.errorMessage:r?Object(U.b)(J.a):Object(U.b)(F.a),{status:r?an.Completed:an.Failed,displayMessage:n,newCardPayload:e.refreshCardSerialized,newCardSignature:e.refreshCardSignature,authenticationUrl:e.authenticationUrl}},t.prototype.sendRequestAsync=function(e){var t,n;return Object(s.__awaiter)(this,void 0,void 0,(function(){var r,a,i,o,c,u,d,l,p,b;return Object(s.__generator)(this,(function(s){switch(s.label){case 0:return s.trys.push([0,6,,7]),r={connectorSenderGuid:this.cardDetails.connectorSenderGuid,inputParameters:[],senderAddress:this.messageContext.senderAddress,smtpAddressesSerialized:this.cardDetails.smtpAddressesSerialized,adaptiveCardSignature:this.cardDetails.cardSignature,adaptiveCardHash:this.cardDetails.cardHash,clientTelemetry:{}},e.activity.channelData=r,a=Object(un.h)(),i=null===(t=a.SessionSettings)||void 0===t?void 0:t.UserPrincipalName,o=null===(n=a.SessionSettings)||void 0===n?void 0:n.UserEmailAddress,e.activity.from={id:i||o},[4,Object(M.a)()];case 1:if(!(c=s.sent()))throw(u=new Error("Token is empty: "+c)).name="EmptyTokenError",u;return[4,fetch(this.url,{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer "+c},body:JSON.stringify(e.activity)})];case 2:return[4,(d=s.sent()).json()];case 3:return l=s.sent(),(p=this.parseResponse(l,d.ok)).newCardPayload?[4,this.parseCardFromStringOrObject(p)]:[3,5];case 4:b=s.sent(),this.cardDetails=b,this.onCardDetailsUpdated([b]),s.label=5;case 5:return void 0,[2,d.ok&&p.status===an.Completed?{request:e,status:sn.ActivityStatus.Success,content:p.newCardPayload?p.newCardPayload:p.displayMessage}:{request:e,status:sn.ActivityStatus.Failure,content:p.displayMessage}];case 6:throw s.sent();case 7:return[2]}}))}))},t}(sn.HttpChannelAdapter),pn=n(15903),bn=n(1577),fn=n(66),gn=n(880),hn=n(1772),mn=n(3),vn="ActionableMessageTeachingUI",On=""+vn,yn={CLICK:On+"_BtnClicked",GOTITCUSTOM:On+"_GotItClicked",LEARN:On+"_LearnMoreClicked",TRIGGERED:On+"_Triggered",DISMISSED:{BTNSCT:On+"_DismisByAction",UNMNT:On+"_DismissByUnmount"},SCOPE:{MOUNTED:On+"_Mounted",UNMNTED:On+"_Unmounted"},DISABLED:On+"_FlightDisabled",RENDERED:On+"_Rendered"},Cn={Transaction:"https://support.office.com/en-us/article/pay-bills-and-invoices-in-outlook-using-microsoft-pay-1196e7e6-c096-44f1-a18a-9df3af832a48"};function jn(e,t){Object(S.r)(e,t)}function An(e){if(e)try{a.g.info("[ActionableMessageTeachingUI] Corelation telemetry trace function called"),function(e){dn=dn||{correlationVector:"",adaptiveCardCorrelationId:"",owaVersion:"",messageId:"",lightningAction:"",tuiType:""},Object(hn.a)(dn,e)}(e)}catch(e){a.g.warn("[ActionableMessageDebug] teachingUITrace: Failed complete the logging of the telemetry - "+e.message)}return dn&&(dn.correlationVector=dn?Object(z.b)():void 0),dn}var xn=Object(gn.d)(Object(x.a)((function(e){e=Object(s.__assign)({hasSmallIcon:!0,hasSmallHeadline:!0,hasCloseIcon:!0,isWide:!0},e);var t=Object(s.__read)(A.useState(!0),2),n=t[0],r=t[1];A.useEffect((function(){return a.g.info("[ActionableMessageTeachingUI:TeachingBubble] Teaching Bubble DidMount"),jn("TeachingBubble_"+yn.SCOPE.MOUNTED,An()),function(){a.g.info("[ActionableMessageTeachingUI:TeachingBubble] Teaching Bubble WillUnmountMount"),jn("TeachingBubble_"+yn.SCOPE.UNMNTED,An())}}),[]);var i=function(t){void 0===t&&(t="Primary"),"Secondary"==t?(a.g.info("[ActionableMessageTeachingUI:TeachingBubble] teacing bubble dismissed by user interaction"),jn("TeachingBubble_"+yn.CLICK,An({lightningAction:t}))):(a.g.info("[ActionableMessageTeachingUI:TeachingBubble] teaching bubble passively dismissed"),jn("TeachingBubble_"+yn.DISMISSED.UNMNT,An({lightningAction:t}))),Object(gn.e)(e.lid,t),r(!1)};return n&&(a.g.info("[ActionableMessageTeachingUI:TeachingBubble] Using TeachingBubble for ActionableMessageTeachingUI"),jn("TeachingBubble_"+yn.RENDERED,An())),n&&A.createElement(bn.a,Object(s.__assign)({calloutProps:{beakWidth:15,directionalHint:fn.DirectionalHint.leftCenter,minPagePadding:50},targetElement:e.target(),primaryButtonProps:Object(s.__assign)(Object(s.__assign)({},e.gotItBtn),{onClick:function(){jn("TeachingBubble_"+yn.GOTITCUSTOM,An({lightningAction:"Secondary"})),i("Secondary")}}),secondaryButtonProps:Object(s.__assign)(Object(s.__assign)({},e.learnMoreBtn),{onClick:function(){jn("TeachingBubble_"+yn.LEARN,An({lightningAction:"Secondary"})),window.open(e.learnMoreBtnUri,"_blank"),i("Secondary")}}),onDismiss:function(){return e.onClose||i("Primary")}},e,{target:void 0}),e.bodyText)}))),Sn=n(2304),wn=(n(300),Object(x.a)((function(e){A.useEffect((function(){var t;t={adaptiveCardCorrelationId:e.acCorrelationId,messageId:e.messageId,tuiType:e.actionType},On=vn+"_",An({adaptiveCardCorrelationId:t.adaptiveCardCorrelationId,messageId:t.messageId,owaVersion:Object(mn.p)(),lightningAction:"",tuiType:t.tuiType})}),[]);var t;return"Transaction"==e.actionType&&A.createElement(xn,{target:e.target,when:function(e){jn(yn.TRIGGERED,An()),e()},gotItBtn:(t="TeachingBubble",{buttonType:Sn.a.primary,children:Object(U.b)(pn.a),onClick:t}),learnMoreBtn:In("TeachingBubble"),learnMoreBtnUri:Cn[e.actionType]||void 0,headline:Object(U.b)(pn.d),bodyText:Object(U.b)(pn.c),hasSmallHeadline:!0,lid:gn.b.ActionableMessageTeachingUiTeachingBubblePolicy})})));function In(e){return{buttonType:Sn.a.normal,children:Object(U.b)(pn.b),onClick:e}}var Mn=n(15904),_n=Object(x.a)((function(e){var t,n,o=this,c=e.actionableMessageLoggingHandler;A.useEffect((function(){return c.log(on.ComponentDidMount),a.g.info("[ActionableMessageDebug] ActionableMessageMailWrapper mount"),function(){yt.clearQueue(),c.log(on.ComponentWillUnMount),a.g.info("[ActionableMessageDebug] ActionableMessageMailWrapper unmount")}}),[]),A.useEffect((function(){c.log(on.ComponentDidUpdate),a.g.info("[ActionableMessageDebug] ActionableMessageMailWrapper update"),j()})),A.useEffect((function(){return b.current=setTimeout((function(){a.g.info("[ActionableMessageDebug] ActionableMessageMailWrapper card load timed out"),Object(S.r)("actionableMessageContentLoadTimeout"),f.current=!0,J(!0)}),4e3),function(){return clearTimeout(b.current)}}),[]);var u=A.useRef(Object(wt.a)(e.item)),d=A.useRef({loadStartTime:Object(w.Rb)()}),l=A.useRef([]),p=A.useRef(),b=A.useRef(),f=A.useRef(),g=Object(s.__read)(A.useState(!1),2),h=g[0],m=g[1],v=Object(s.__read)(A.useState(null),2),O=v[0],C=v[1],j=function(){return Object(s.__awaiter)(o,void 0,void 0,(function(){var t,n,r,i,o,u,l,b,f;return Object(s.__generator)(this,(function(s){switch(s.label){case 0:if(p.current)return c.log(on.FetchInProgress),a.g.info("[ActionableMessageDebug] ActionableMessageMailWrapper getCardProperties fetch already in process. Aborting this attempt"),[2];if(t=e.item,d.current.fetchStartTime=Object(w.Rb)(),(n=t.adaptiveCardDetails)&&n.length>0)return c.log(on.CardDetailsPresent+":"+(null===(l=n[0].cardId)||void 0===l?void 0:l.slice(0,8))),a.g.info("[ActionableMessageDebug] ActionableMessageMailWrapper getCardProperties already had cardDetails on the item. cardId: "+n[0].cardId),d.current.fetchEndTime=Object(w.Rb)(),[2];r=new S.b("MCActionableCardGetProperty"),s.label=1;case 1:return s.trys.push([1,3,4,5]),p.current=!0,c.log(on.FetchInitiated),a.g.info("[ActionableMessageDebug] ActionableMessageMailWrapper getCardProperties fetching cardDetails from the server"),[4,y(t)];case 2:return i=s.sent(),(o=t.adaptiveCardDetails)&&o.length>0?(c.log(on.NotUpdatingCardDetailsAsItAlreadyPresent+":"+(null===(b=o[0].cardId)||void 0===b?void 0:b.slice(0,8))),a.g.info("[ActionableMessageDebug] ActionableMessageMailWrapper getCardProperties not updating the details as its already present"+i[0].cardId)):i&&i.length>0?(r.end(),d.current.fetchEndTime=Object(w.Rb)(),c.log(on.FetchSuccess),c.log(on.CardId+":"+(null===(f=i[0].cardId)||void 0===f?void 0:f.slice(0,8))),a.g.info("[ActionableMessageDebug] ActionableMessageMailWrapper getCardProperties got card details from the server. cardId: "+i[0].cardId),pt(t,i)):(c.log(on.FetchError),a.g.info("[ActionableMessageDebug] ActionableMessageMailWrapper getCardProperties error getting card details from the server"),J(!0),r.endWithError("ServerError")),[3,5];case 3:return u=s.sent(),c.log(on.FetchException),a.g.info("[ActionableMessageDebug] ActionableMessageMailWrapper getCardProperties error getting card details from the server"),a.g.warn("[ActionableMessageDebug] ActionableMessageMailWrapper getCardProperties: exception during getCardDetails: "+u.message),J(!0),r.endWithError("ClientError"),[3,5];case 4:return p.current=!1,[7];case 5:return[2]}}))}))},x=function(e){return e.filter((function(e){return!e.isContextual}))},_=function(t){var n,o,p=x(t),b={onUndo:function(){return t=e.darkModeContentHandler,n=e.undoDarkMode,void(t&&n&&(a.g.info("[ActionableMessageDebug] ActionableMessageMailWrapper: applyDarkModeHandlerToCardElement: undoing dark mode"),t.undoHandler(l.current),l.current=[]));var t,n},onApply:function(t){return function(t){var n=e.undoDarkMode,r=e.darkModeContentHandler;if(t&&r&&!n)if(a.g.info("[ActionableMessageDebug] ActionableMessageMailWrapper: applyDarkModeHandlerToCardElement: applying dark mode to card elements"),r.cssSelector){r.handler(t),l.current.push(t);var i=t.querySelectorAll(r.cssSelector);if(i)for(var o=0;o<i.length;o++){var c=i.item(o);r.handler(c),l.current.push(c)}}else a.g.info("[ActionableMessageDebug] ActionableMessageMailWrapper: applyDarkModeHandlerToCardElement: no cssSelector specified by DarkMode handler")}(t)}},f=new r.b(i.c,u.current,d.current);if(p&&p.length>0&&(o=cn()?p[0]:p[p.length-1]),o&&function(t){var n,r=!0,a=null===(n=null==t?void 0:t.card)||void 0===n?void 0:n.originator;return a||(a=null==t?void 0:t.connectorSenderGuid),a&&(r=!Re(a,e.isDarkMode)),r}(o)){c.log(on.RenderCard+":"+(null===(n=o.cardId)||void 0===n?void 0:n.slice(0,8))),a.g.info("[ActionableMessageDebug] ActionableMessageMailWrapper renderCardFromDetails. cardId: "+o.cardId);var g=new ln(Be(u.current),o,u.current,T);return A.createElement("div",{className:Mn.container},A.createElement(r.a,{key:o.cardId,cardDetails:o,isActionableMessageV2Enabled:cn(),snackBarTimeout:qe(),showMessageBodyCallback:D,contentHandlerUndoMode:e.undoDarkMode,actionProviders:[Qt,Ge,it],adjustCardElementBeforeRenderCallback:E,fixImagesBeforeRenderCallback:P,onCardRendered:N,downloadThemeCallback:oe,onCardDetailsUpdated:T,getClientAuthToken:M.a,actionableMessageContentHandler:b,actionableMessageCardStrings:{format:U.c,placeholder:{textInput:Object(U.b)(en.g),numberInput:Object(U.b)(en.f),dateInput:Object(U.b)(en.e),choiceSetInput:Object(U.b)(en.d)},error:{generic:Object(U.b)(F.a)},warning:{invalidInput:Object(U.b)(en.h),missingRequiredInput:Object(U.b)(en.i),inputNumberNotNumeric:Object(U.b)(tn.c),inputNumberLessThanMin:Object(U.b)(tn.a),inputNumberMoreThanMax:Object(U.b)(tn.b),requiredField:Object(U.b)(nn.a)},information:{actionInProgress:Object(U.b)(en.a),authenticationFlowAcknowledgeMessage:Object(U.b)(en.c),authenticationFlowAcknowledgeButtonText:Object(U.b)(en.b)},datePicker:Object(s.__assign)(Object(s.__assign)({},Object(rn.a)()),{isRequiredErrorMessage:nn.a})},telemetryHandler:f,loggingHandler:c,httpChannelAdapter:g,isTrustedDomain:Le}))}return c.log(on.NoCard),a.g.info("[ActionableMessageDebug] ActionableMessageMailWrapper renderCardFromDetails - Did not find expected number of cards on the message"),D(!0),A.createElement("div",null)},D=function(t){c.log(on.ShowMessage),a.g.info("[ActionableMessageDebug] ActionableMessageMailWrapper setShowMessageBody: "+t),ft(e.viewState,t),t&&gt(e.viewState,!1),J(t)},T=function(t){c.log(on.UpdateOnItem),a.g.info("[ActionableMessageDebug] ActionableMessageMailWrapper updateCardOnItem"),bt(e.item,t)},k=function(){var t=e.item.adaptiveCardDetails;if(t&&t.length>0){var n=t[0].card.messageCardContext;return n?{acCorrelationId:n.correlationId,actionType:Object(r.e)(t[0]),messageId:e.item.ItemId.Id,target:function(){return O}}:{acCorrelationId:"",actionType:void 0,messageId:null,target:function(){return O}}}return null},E=function(t,n){a.g.info("[ActionableMessageDebug] ActionableMessageMailWrapper fixInlineImages"),Je(t,e.item.MailboxInfo,n),Ct(t,e.item,e.item.MailboxInfo)},P=function(t,n){Je(t,e.item.MailboxInfo,n)},N=function(t){c.log(on.UpdateLoadingState),a.g.info("[ActionableMessageDebug] ActionableMessageMailWrapper  onCardRendered. Updating loading state"),O!==t&&(m(!0),C(t),J(!1)),e.viewState.showCardLoading&&gt(e.viewState,!1)},R=function(e){return(null==e?void 0:e.actionType)&&null!=e.target?(a.g.info("[ActionableMessageCard] TeachingUI triggered"),A.createElement(wn,Object(s.__assign)({},e))):null},J=function(t){c.log(on.FinishLoading),a.g.info("[ActionableMessageDebug] Finish Loading - forceShowMessageBody:"+t),b.current&&(clearTimeout(b.current),b.current=null);var n=e.viewState;gt(n,!1),t&&ft(n,!0)},H=e.item.adaptiveCardDetails;return c.log(on.Render),c.log(on.CardId+":"+((null==H?void 0:H[0])?null===(n=null===(t=H[0])||void 0===t?void 0:t.cardId)||void 0===n?void 0:n.slice(0,8):" ")),a.g.info("[ActionableMessageDebug] ActionableMessageMailWrapper render. itemId: "+e.item.ItemId.Id+". CardDetails: "+((null==H?void 0:H[0])?H[0].cardId:"undefined")),H&&H.length>0?0!==function(t){var n=x(t);return n=n.filter((function(t){return function(e,t,n,a,i){var o=e.card;if(o&&o.hasOwnProperty(Ve)){if(!o.messageCardContext)return!1;var c=Object(r.e)(e)===r.c.XeroOpay&&n;return c&&i.logTelemetry({messageContext:a,eventName:We,cardDetails:e}),c}return!1}(t,e.item.MailboxInfo,Object(I.i)("rp-acDisableTransactionCard"),u.current,i.c)}))}(H).length?(J(!0),null):function(e){return f.current&&J(!0),!f.current&&A.createElement(A.Fragment,null,A.createElement("div",{className:Mn.cardArea},_(e)),A.createElement(lt,{odataItemId:u.current.odataItemId,smtpAddressesSerialized:e[0].smtpAddressesSerialized}),h&&R(e?k():null))}(H):null}));n.d(t,"logAdaptiveCardLinkInteraction",(function(){return c})),n.d(t,"getCardDetails",(function(){return y})),n.d(t,"ActionableMessageMailWrapper",(function(){return _n})),n.d(t,"doesActionableMessageEnabled",(function(){return Pe}))},1772:function(e,t,n){"use strict";var r=n(805),a=n(501),i=n(1022),o=n(654),c=n(658),s=n(566),u=Object.prototype.hasOwnProperty,d=Object(i.a)((function(e,t){if(Object(c.a)(t)||Object(o.a)(t))Object(a.a)(t,Object(s.a)(t),e);else for(var n in t)u.call(t,n)&&Object(r.a)(e,n,t[n])}));t.a=d},1858:function(e,t,n){"use strict";var r=n(65),a=n(33),i="PremiumConsumerSetting";function o(){var e,t,n,o,c,s;if(null===(t=null===(e=Object(r.h)())||void 0===e?void 0:e.SessionSettings)||void 0===t?void 0:t.IsPremiumConsumerMailbox)return!0;if(Object(a.i)("auth-PremiumCheckUpdates")){var u=null===(o=null===(n=Object(r.h)())||void 0===n?void 0:n.PrimeSettings)||void 0===o?void 0:o.Items,d=null==u?void 0:u.filter((function(e){return(null==e?void 0:e.Id)===i}));return null!==(s=null===(c=null==d?void 0:d[0])||void 0===c?void 0:c.Value)&&void 0!==s&&s}return!1}n.d(t,"a",(function(){return o}))},2255:function(e,t,n){"use strict";var r=n(1674),a=["AT","BE","BG","CH","CY","CZ","DE","DK","EE","ES","FI","FR","GB","GR","HR","HU","IE","IS","IT","LI","LT","LU","LV","MT","NL","NO","PL","PT","RO","SE","SI","SK"];function i(){var e=Object(r.h)(Object(r.e)());return a.indexOf(e)>=0}var o=n(33);function c(){var e;return Object(o.i)("fwk-gdprAdsV3-freString6")&&(e=!0),e}var s,u={};function d(e,t){return void 0===t&&(t=!0),u[e]&&s&&-1!=s.indexOf(e)||(u[e]=new Promise((function(n,r){var a=window.document.createElement("script");a.src=e,a.type="text/javascript",t&&(a.crossOrigin="anonymous"),a.onload=function(){s?s.push(e):s=[e],n()},a.onerror=function(){r("OnError "+e)},window.document.head.appendChild(a)}))),u[e]}var l=n(65);function p(e){l.v.importAndExecute([{key:"ConsumerAdsExperimentMode",valuetype:"Integer32",value:[String(e)]}])}var b,f,g,h=n(17),m=["en-us","en-gb","en-ca","en-au","fr-fr","de-de","en-de"];function v(){if(!f)if(O())if(Object(h.a)().UserOptions.IsFocusedInboxEnabled)f=1;else{var e=function(){if(Object(o.i)("adsExp-NativeInbox-e2-NoDisplayAd"))return 2;if(Object(o.i)("adsExp-NativeInbox-e3-NoDisplayAd")||Object(o.i)("adsExp-NativeInbox-e3-DisplayAd"))return 3;if(Object(o.i)("adsExp-NativeInbox-e4-NoDisplayAd"))return 4;return-1}();if(-1!=e){var t=function(e){switch(e){case"DisplayOffNativeOff":return 1;case"DisplayOffNativeOther":return 2;case"DisplayOffNativeInbox":return 3;case"DisplayOnNativeOff":return 4;case"DisplayOnNativeOther":return 5;case"DisplayOnNativeInbox":return 6;case"NoExperiment":default:return 0}}(Object(h.a)().UserOptions.ConsumerAdsExperimentMode);if(0==t||t>=e)p(1),f=2;else if(t<e){p(t+1==e?0:t),f=1}}else f=1}else f=0;return f}function O(){return void 0!==b?b:(b=!1,Object(l.s)()?(g=Object(r.e)(),Object(o.i)("fwk-nativeAds-bingOneClickOtherInboxOnly")||Object(o.i)("fwk-nativeAds-prebidOneClickOtherInboxOnly")||Object(o.i)("fwk-nativeAds-appNexusOneClickOtherInboxOnly")?Object(r.b)()?b:Object(r.c)()?b:Object(r.a)()?b:r.d.indexOf(g)>-1?b:b=!0:b):b)}n.d(t,"o",(function(){return i})),n.d(t,"p",(function(){return c})),n.d(t,"q",(function(){return d})),n.d(t,"l",(function(){return O})),n.d(t,"m",(function(){return v})),n.d(t,"a",(function(){return m})),n.d(t,"e",(function(){return r.d})),n.d(t,"f",(function(){return r.e})),n.d(t,"g",(function(){return r.f})),n.d(t,"i",(function(){return r.h})),n.d(t,"j",(function(){return r.i})),n.d(t,"k",(function(){return r.j})),n.d(t,"n",(function(){return r.k})),n.d(t,"b",(function(){return r.a})),n.d(t,"c",(function(){return r.b})),n.d(t,"d",(function(){return r.c})),n.d(t,"r",(function(){return r.l})),n.d(t,"h",(function(){return r.g}))},2304:function(e,t,n){"use strict";var r,a;n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return a})),function(e){e[e.button=0]="button",e[e.anchor=1]="anchor"}(r||(r={})),function(e){e[e.normal=0]="normal",e[e.primary=1]="primary",e[e.hero=2]="hero",e[e.compound=3]="compound",e[e.command=4]="command",e[e.icon=5]="icon",e[e.default=6]="default"}(a||(a={}))},3052:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(0),a=n(1755),i=n(787);function o(e,t,n,o){var c=Object(i.e)(n,e,null,t),s=Object(r.__assign)(Object(r.__assign)({},o),{includeFluidOnPopout:Object(a.b)(7)});Object(i.c)("mail",c,s,{resizable:!0})}},3394:function(e){e.exports=JSON.parse('{"a":"o6b"}')},350:function(e,t,n){"use strict";var r=n(620),a=n(621),i=n(622),o=n(623),c=n(624),s=n(625),u=n(626),d=n(526),l=n(527),p=n(528),b=n(529),f=n(530),g=n(531),h=n(532),m=n(533),v=n(534),O=n(535),y=n(536),C=n(537),j=n(171),A=n(725),x=n(627),S=n(628),w=n(629),I=n(630),M=n(631),_=n(632),D=n(633),T=n(634),k=n(635),E=n(636),P=n(637),N=n(638),R=n(6),U=n(12),F=function(){return J.get()},J=Object(U.computed)((function(){return{months:[Object(R.b)(C.a),Object(R.b)(y.a),Object(R.b)(O.a),Object(R.b)(v.a),Object(R.b)(m.a),Object(R.b)(h.a),Object(R.b)(g.a),Object(R.b)(f.a),Object(R.b)(b.a),Object(R.b)(p.a),Object(R.b)(l.a),Object(R.b)(d.a)],shortMonths:[Object(R.b)(N.a),Object(R.b)(P.a),Object(R.b)(E.a),Object(R.b)(k.a),Object(R.b)(T.a),Object(R.b)(D.a),Object(R.b)(_.a),Object(R.b)(M.a),Object(R.b)(I.a),Object(R.b)(w.a),Object(R.b)(S.a),Object(R.b)(x.a)],days:[Object(R.b)(u.a),Object(R.b)(s.a),Object(R.b)(c.a),Object(R.b)(o.a),Object(R.b)(i.a),Object(R.b)(a.a),Object(R.b)(r.a)],shortDays:[Object(R.b)(j.d),Object(R.b)(j.b),Object(R.b)(j.f),Object(R.b)(j.g),Object(R.b)(j.e),Object(R.b)(j.a),Object(R.b)(j.c)],goToToday:Object(R.b)(A.a),prevMonthAriaLabel:Object(R.b)(j.l),nextMonthAriaLabel:Object(R.b)(j.i),prevYearAriaLabel:Object(R.b)(j.n),nextYearAriaLabel:Object(R.b)(j.k),prevYearRangeAriaLabel:Object(R.b)(j.m),nextYearRangeAriaLabel:Object(R.b)(j.j),monthPickerHeaderAriaLabel:Object(R.b)(j.o),yearPickerHeaderAriaLabel:Object(R.b)(j.s),weekNumberFormatString:Object(R.b)(j.r),selectedDateFormatString:Object(R.b)(j.p),todayDateFormatString:Object(R.b)(j.q),dayMarkedAriaLabel:Object(R.b)(j.h)}})),H=n(65),z=function(e,t){return e?e.tz:t||Object(H.p)()},L=n(4),B=function(e,t){return Object(L.Rb)(e,t.getFullYear(),t.getMonth(),t.getDate())};n.d(t,"a",(function(){return F})),n.d(t,"c",(function(){return z})),n.d(t,"b",(function(){return B}))},413:function(e,t,n){"use strict";var r,a=n(789),i=n(299).a["__core-js_shared__"],o=(r=/[^.]+$/.exec(i&&i.keys&&i.keys.IE_PROTO||""))?"Symbol(src)_1."+r:"";var c=function(e){return!!o&&o in e},s=n(346),u=n(518),d=/^\[object .+?Constructor\]$/,l=Function.prototype,p=Object.prototype,b=l.toString,f=p.hasOwnProperty,g=RegExp("^"+b.call(f).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");var h=function(e){return!(!Object(s.a)(e)||c(e))&&(Object(a.a)(e)?g:d).test(Object(u.a)(e))};var m=function(e,t){return null==e?void 0:e[t]};t.a=function(e,t){var n=m(e,t);return h(n)?n:void 0}},501:function(e,t,n){"use strict";var r=n(805),a=n(793);t.a=function(e,t,n,i){var o=!n;n||(n={});for(var c=-1,s=t.length;++c<s;){var u=t[c],d=i?i(n[u],e[u],u,n,e):void 0;void 0===d&&(d=e[u]),o?Object(a.a)(n,u,d):Object(r.a)(n,u,d)}return n}},518:function(e,t,n){"use strict";var r=Function.prototype.toString;t.a=function(e){if(null!=e){try{return r.call(e)}catch(e){}try{return e+""}catch(e){}}return""}},522:function(e,t,n){"use strict";(function(e){var r=n(609),a="object"==typeof exports&&exports&&!exports.nodeType&&exports,i=a&&"object"==typeof e&&e&&!e.nodeType&&e,o=i&&i.exports===a&&r.a.process,c=function(){try{var e=i&&i.require&&i.require("util").types;return e||o&&o.binding&&o.binding("util")}catch(e){}}();t.a=c}).call(this,n(875)(e))},526:function(e){e.exports=JSON.parse('{"a":"qxa"}')},527:function(e){e.exports=JSON.parse('{"a":"pxa"}')},528:function(e){e.exports=JSON.parse('{"a":"oxa"}')},529:function(e){e.exports=JSON.parse('{"a":"nxa"}')},530:function(e){e.exports=JSON.parse('{"a":"mxa"}')},531:function(e){e.exports=JSON.parse('{"a":"lxa"}')},532:function(e){e.exports=JSON.parse('{"a":"kxa"}')},533:function(e){e.exports=JSON.parse('{"a":"jxa"}')},534:function(e){e.exports=JSON.parse('{"a":"ixa"}')},535:function(e){e.exports=JSON.parse('{"a":"hxa"}')},536:function(e){e.exports=JSON.parse('{"a":"gxa"}')},537:function(e){e.exports=JSON.parse('{"a":"eaa"}')},566:function(e,t,n){"use strict";var r=n(796),a=n(987),i=n(654);t.a=function(e){return Object(i.a)(e)?Object(r.a)(e):Object(a.a)(e)}},620:function(e){e.exports=JSON.parse('{"a":"Zva"}')},621:function(e){e.exports=JSON.parse('{"a":"dwa"}')},622:function(e){e.exports=JSON.parse('{"a":"cwa"}')},623:function(e){e.exports=JSON.parse('{"a":"bwa"}')},624:function(e){e.exports=JSON.parse('{"a":"awa"}')},625:function(e){e.exports=JSON.parse('{"a":"$va"}')},626:function(e){e.exports=JSON.parse('{"a":"_va"}')},627:function(e){e.exports=JSON.parse('{"a":"Nwa"}')},628:function(e){e.exports=JSON.parse('{"a":"Mwa"}')},629:function(e){e.exports=JSON.parse('{"a":"Lwa"}')},630:function(e){e.exports=JSON.parse('{"a":"Kwa"}')},631:function(e){e.exports=JSON.parse('{"a":"Jwa"}')},632:function(e){e.exports=JSON.parse('{"a":"Iwa"}')},633:function(e){e.exports=JSON.parse('{"a":"Hwa"}')},634:function(e){e.exports=JSON.parse('{"a":"Gwa"}')},635:function(e){e.exports=JSON.parse('{"a":"Fwa"}')},636:function(e){e.exports=JSON.parse('{"a":"Ewa"}')},637:function(e){e.exports=JSON.parse('{"a":"Dwa"}')},638:function(e){e.exports=JSON.parse('{"a":"Cwa"}')},654:function(e,t,n){"use strict";var r=n(789),a=n(791);t.a=function(e){return null!=e&&Object(a.a)(e.length)&&!Object(r.a)(e)}},656:function(e,t,n){"use strict";t.a=function(e,t){return e===t||e!=e&&t!=t}},658:function(e,t,n){"use strict";var r=Object.prototype;t.a=function(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||r)}},659:function(e,t,n){"use strict";var r=n(413),a=function(){try{var e=Object(r.a)(Object,"defineProperty");return e({},"",{}),e}catch(e){}}();t.a=a},660:function(e,t,n){"use strict";t.a=function(e){return function(t){return e(t)}}},725:function(e){e.exports=JSON.parse('{"a":"Owa"}')},789:function(e,t,n){"use strict";var r=n(412),a=n(346),i="[object AsyncFunction]",o="[object Function]",c="[object GeneratorFunction]",s="[object Proxy]";t.a=function(e){if(!Object(a.a)(e))return!1;var t=Object(r.a)(e);return t==o||t==c||t==i||t==s}},791:function(e,t,n){"use strict";var r=9007199254740991;t.a=function(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=r}},792:function(e,t,n){"use strict";var r=9007199254740991,a=/^(?:0|[1-9]\d*)$/;t.a=function(e,t){var n=typeof e;return!!(t=null==t?r:t)&&("number"==n||"symbol"!=n&&a.test(e))&&e>-1&&e%1==0&&e<t}},793:function(e,t,n){"use strict";var r=n(659);t.a=function(e,t,n){"__proto__"==t&&r.a?Object(r.a)(e,t,{configurable:!0,enumerable:!0,value:n,writable:!0}):e[t]=n}},795:function(e,t,n){"use strict";t.a=function(e){return e}},796:function(e,t,n){"use strict";var r=n(983),a=n(979),i=n(553),o=n(798),c=n(792),s=n(978),u=Object.prototype.hasOwnProperty;t.a=function(e,t){var n=Object(i.a)(e),d=!n&&Object(a.a)(e),l=!n&&!d&&Object(o.a)(e),p=!n&&!d&&!l&&Object(s.a)(e),b=n||d||l||p,f=b?Object(r.a)(e.length,String):[],g=f.length;for(var h in e)!t&&!u.call(e,h)||b&&("length"==h||l&&("offset"==h||"parent"==h)||p&&("buffer"==h||"byteLength"==h||"byteOffset"==h)||Object(c.a)(h,g))||f.push(h);return f}},797:function(e,t,n){"use strict";t.a=function(e,t){return function(n){return e(t(n))}}},798:function(e,t,n){"use strict";(function(e){var r=n(299),a=n(988),i="object"==typeof exports&&exports&&!exports.nodeType&&exports,o=i&&"object"==typeof e&&e&&!e.nodeType&&e,c=o&&o.exports===i?r.a.Buffer:void 0,s=(c?c.isBuffer:void 0)||a.a;t.a=s}).call(this,n(875)(e))},805:function(e,t,n){"use strict";var r=n(793),a=n(656),i=Object.prototype.hasOwnProperty;t.a=function(e,t,n){var o=e[t];i.call(e,t)&&Object(a.a)(o,n)&&(void 0!==n||t in e)||Object(r.a)(e,t,n)}},875:function(e,t){e.exports=function(e){if(!e.webpackPolyfill){var t=Object.create(e);t.children||(t.children=[]),Object.defineProperty(t,"loaded",{enumerable:!0,get:function(){return t.l}}),Object.defineProperty(t,"id",{enumerable:!0,get:function(){return t.i}}),Object.defineProperty(t,"exports",{enumerable:!0}),t.webpackPolyfill=1}return t}},8935:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return o}));var r=n(36),a=new r.c((function(){return Promise.all([n.e(8),n.e(13),n.e(145),n.e(200),n.e(198),n.e(680)]).then(n.bind(null,11104))})),i=new r.b(a,(function(e){return e.openBotConversation})),o=new r.b(a,(function(e){return e.openCortanaConversation}));new r.a(a,(function(e){return e.setEditorInterface}))},978:function(e,t,n){"use strict";var r=n(412),a=n(791),i=n(397),o={};o["[object Float32Array]"]=o["[object Float64Array]"]=o["[object Int8Array]"]=o["[object Int16Array]"]=o["[object Int32Array]"]=o["[object Uint8Array]"]=o["[object Uint8ClampedArray]"]=o["[object Uint16Array]"]=o["[object Uint32Array]"]=!0,o["[object Arguments]"]=o["[object Array]"]=o["[object ArrayBuffer]"]=o["[object Boolean]"]=o["[object DataView]"]=o["[object Date]"]=o["[object Error]"]=o["[object Function]"]=o["[object Map]"]=o["[object Number]"]=o["[object Object]"]=o["[object RegExp]"]=o["[object Set]"]=o["[object String]"]=o["[object WeakMap]"]=!1;var c=function(e){return Object(i.a)(e)&&Object(a.a)(e.length)&&!!o[Object(r.a)(e)]},s=n(660),u=n(522),d=u.a&&u.a.isTypedArray,l=d?Object(s.a)(d):c;t.a=l},979:function(e,t,n){"use strict";var r=n(412),a=n(397),i="[object Arguments]";var o=function(e){return Object(a.a)(e)&&Object(r.a)(e)==i},c=Object.prototype,s=c.hasOwnProperty,u=c.propertyIsEnumerable,d=o(function(){return arguments}())?o:function(e){return Object(a.a)(e)&&s.call(e,"callee")&&!u.call(e,"callee")};t.a=d},983:function(e,t,n){"use strict";t.a=function(e,t){for(var n=-1,r=Array(e);++n<e;)r[n]=t(n);return r}},987:function(e,t,n){"use strict";var r=n(658),a=n(797),i=Object(a.a)(Object.keys,Object),o=Object.prototype.hasOwnProperty;t.a=function(e){if(!Object(r.a)(e))return i(e);var t=[];for(var n in Object(e))o.call(e,n)&&"constructor"!=n&&t.push(n);return t}},988:function(e,t,n){"use strict";t.a=function(){return!1}},993:function(e,t,n){"use strict";var r=n(795),a=n(999),i=n(998);t.a=function(e,t){return Object(i.a)(Object(a.a)(e,t,r.a),e+"")}},998:function(e,t,n){"use strict";var r=function(e){return function(){return e}},a=n(659),i=n(795),o=a.a?function(e,t){return Object(a.a)(e,"toString",{configurable:!0,enumerable:!1,value:r(t),writable:!0})}:i.a,c=800,s=16,u=Date.now;var d=function(e){var t=0,n=0;return function(){var r=u(),a=s-(r-n);if(n=r,a>0){if(++t>=c)return arguments[0]}else t=0;return e.apply(void 0,arguments)}}(o);t.a=d},999:function(e,t,n){"use strict";var r=function(e,t,n){switch(n.length){case 0:return e.call(t);case 1:return e.call(t,n[0]);case 2:return e.call(t,n[0],n[1]);case 3:return e.call(t,n[0],n[1],n[2])}return e.apply(t,n)},a=Math.max;t.a=function(e,t,n){return t=a(void 0===t?e.length-1:t,0),function(){for(var i=arguments,o=-1,c=a(i.length-t,0),s=Array(c);++o<c;)s[o]=i[t+o];o=-1;for(var u=Array(t+1);++o<t;)u[o]=i[o];return u[t]=n(s),r(e,this,u)}}}}]);
//# sourceMappingURL=owa.MailBoot~ActionableMessageMail.js.map
self.scriptsLoaded['owa.MailBoot~ActionableMessageMail.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.MailBoot~ActionableMessageMail.js'] = (new Date()).getTime();