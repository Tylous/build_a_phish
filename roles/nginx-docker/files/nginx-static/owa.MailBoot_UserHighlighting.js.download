self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.MailBoot~UserHighlighting.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[791],{10863:function(e,t,n){var r=n(15888),i=n(95);"string"==typeof r&&(r=[[e.i,r]]);for(var a=0;a<r.length;a++)i.loadStyles(r[a][1],!1);r.locals&&(e.exports=r.locals)},15888:function(e,t,n){(t=e.exports=n(94)(!1)).push([e.i,'._1urPxDscnvJ7unrfTyqNOp{text-decoration:inherit}html[dir] ._1urPxDscnvJ7unrfTyqNOp{border-radius:2px;padding:0 1px;background-color:"[theme:highlightYellowLight, default:rgba(255, 241, 0, .16)]"}._1urPxDscnvJ7unrfTyqNOp:hover{cursor:pointer}html[dir] ._1urPxDscnvJ7unrfTyqNOp:hover{background-color:"[theme:highlightYellow, default:rgba(255, 241, 0, .30)]"}._3jeqMIU2uRa5T5yNWT7AGh{text-decoration:inherit}html[dir] ._3jeqMIU2uRa5T5yNWT7AGh{border-radius:2px;padding:0 1px;background-color:"[theme:themeLighter, default:#DEECF9]"}._3jeqMIU2uRa5T5yNWT7AGh:hover{cursor:pointer}html[dir] ._3jeqMIU2uRa5T5yNWT7AGh:hover{background-color:"[theme:themeLight, default:#C7E0F4]"}',""]),t.locals={userHighlight:"_1urPxDscnvJ7unrfTyqNOp",userNote:"_3jeqMIU2uRa5T5yNWT7AGh"}},15889:function(e,t,n){(t=e.exports=n(94)(!1)).push([e.i,'._3f4MFgCmXZw5tsAxv_YZmy,._2n2fxh7KEVUQ1c3qBZ0qfj{display:inline-block}html[dir] ._2n2fxh7KEVUQ1c3qBZ0qfj{padding:4px}._1dKkLlfJNDv2-dR32zwie5{width:32px;height:32px;color:"[theme:neutralSecondary, default:#605e5c]";-webkit-box-flex:0;-ms-flex:0 0 auto;flex:0 0 auto}html[dir] ._1dKkLlfJNDv2-dR32zwie5{background:"[theme:white, default:#ffffff]";border-radius:2px}html[dir=ltr] ._1dKkLlfJNDv2-dR32zwie5{margin:0 2px 2px 0}html[dir=rtl] ._1dKkLlfJNDv2-dR32zwie5{margin:0 0 2px 2px}._1dKkLlfJNDv2-dR32zwie5:hover{color:"[theme:neutralSecondary, default:#605e5c]"}html[dir] ._1dKkLlfJNDv2-dR32zwie5:hover{background-color:"[theme:neutralLight, default:#edebe9]"}._1dKkLlfJNDv2-dR32zwie5:active{color:"[theme:neutralSecondary, default:#605e5c]"}html[dir] ._1dKkLlfJNDv2-dR32zwie5:active{background-color:"[theme:neutralQuaternaryAlt, default:#e1dfdd]"}._1dKkLlfJNDv2-dR32zwie5.CtfJt9OARiXa7wunCa-4m{color:"[theme:neutralSecondary, default:#605e5c]"}html[dir] ._1dKkLlfJNDv2-dR32zwie5.CtfJt9OARiXa7wunCa-4m{background-color:"[theme:themeLight, default:#C7E0F4]"}html[dir] ._1dKkLlfJNDv2-dR32zwie5.CtfJt9OARiXa7wunCa-4m:hover{background-color:"[theme:themeTertiary, default:#71AFE5]"}html[dir] ._1dKkLlfJNDv2-dR32zwie5.ms-Button{padding:0;border-width:0}._1dKkLlfJNDv2-dR32zwie5 ._3N3w1Wq3DBCKJtrO0a1D-U{width:32px}._1dKkLlfJNDv2-dR32zwie5 ._3N3w1Wq3DBCKJtrO0a1D-U._2lcUKsWqVDEyMDh9nKdQ2r{-webkit-filter:brightness(175%);filter:brightness(175%)}',""]),t.locals={popup:"_3f4MFgCmXZw5tsAxv_YZmy",userMarkupCalloutWrapper:"_2n2fxh7KEVUQ1c3qBZ0qfj",userMarkupPopupButton:"_1dKkLlfJNDv2-dR32zwie5",isChecked:"CtfJt9OARiXa7wunCa-4m",image:"_3N3w1Wq3DBCKJtrO0a1D-U",brightenIcons:"_2lcUKsWqVDEyMDh9nKdQ2r"}},15890:function(e){e.exports=JSON.parse('{"f":"a4b","a":"b4b","b":"d4b","e":"e4b","d":"f4b","c":"g4b"}')},15891:function(e,t,n){var r=n(15892),i=n(95);"string"==typeof r&&(r=[[e.i,r]]);for(var a=0;a<r.length;a++)i.loadStyles(r[a][1],!1);r.locals&&(e.exports=r.locals)},15892:function(e,t,n){(t=e.exports=n(94)(!1)).push([e.i,'._3haK2IBjz_VRRC6iv_arlJ{color:"[theme:dimGray, default:#696969]"}html[dir] ._3haK2IBjz_VRRC6iv_arlJ{padding-top:10px}html[dir=ltr] ._1WrELIQNYHTrHDt1y2Pezg{margin-left:auto}html[dir=rtl] ._1WrELIQNYHTrHDt1y2Pezg{margin-right:auto}._33bppGTV-7vjiCRosXrTWH{color:"[theme:dimGray, default:#696969]"}._209abDxCFTw5mv45pdHR2H{font-size:20px;font-weight:700}html[dir=ltr] ._209abDxCFTw5mv45pdHR2H{padding:10px 0 10px 25px}html[dir=rtl] ._209abDxCFTw5mv45pdHR2H{padding:10px 25px 10px 0}._7yWKnFiI5dk-ijdh4WnbG{color:"[theme:black, default:#000000]";font-size:11px;overflow-y:auto;overflow-x:hidden;resize:none;-ms-overflow-style:-ms-autohiding-scrollbar;scrollbar-color:"[theme:neutralTertiaryAlt, default:#c8c6c4]" transparent;scrollbar-width:thin}html[dir] ._7yWKnFiI5dk-ijdh4WnbG{background-color:inherit;padding-top:10px}html[dir] ._7yWKnFiI5dk-ijdh4WnbG::-webkit-scrollbar-button:horizontal:increment{background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAMAAAAoLQ9TAAAABlBMVEXM09b///8OmaLeAAAAAnRSTlP/AOW3MEoAAAAgSURBVHgBY2BEA+QLMGAIMGAIMGAIMBAUIGQoZU5HAwB+ZgDtGYq3fgAAAABJRU5ErkJggg==)}html[dir] ._7yWKnFiI5dk-ijdh4WnbG::-webkit-scrollbar-button:horizontal:increment:hover{background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAMAAAAoLQ9TAAAABlBMVEWdtMT///8YSU3FAAAAAnRSTlP/AOW3MEoAAAAgSURBVHgBY2BEA+QLMGAIMGAIMGAIMBAUIGQoZU5HAwB+ZgDtGYq3fgAAAABJRU5ErkJggg==)}html[dir] ._7yWKnFiI5dk-ijdh4WnbG::-webkit-scrollbar-button:horizontal:decrement{background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAMAAAAoLQ9TAAAABlBMVEXM09b///8OmaLeAAAAAnRSTlP/AOW3MEoAAAAiSURBVHgBY2BEAxQJMKAJMKAJMKAJMOATgIkQMBTBooZfAH56AO2yINTrAAAAAElFTkSuQmCC)}html[dir] ._7yWKnFiI5dk-ijdh4WnbG::-webkit-scrollbar-button:horizontal:decrement:hover{background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAMAAAAoLQ9TAAAABlBMVEWdtMT///8YSU3FAAAAAnRSTlP/AOW3MEoAAAAiSURBVHgBY2BEAxQJMKAJMKAJMKAJMOATgIkQMBTBooZfAH56AO2yINTrAAAAAElFTkSuQmCC)}html[dir] ._7yWKnFiI5dk-ijdh4WnbG::-webkit-scrollbar-button:vertical:increment{background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAMAAAAoLQ9TAAAABlBMVEXM09b///8OmaLeAAAAAnRSTlP/AOW3MEoAAAAfSURBVHgBY2BEA7QTYIAChAoYH6EFxkeYwQBj0MelAH3GAO2C9+AaAAAAAElFTkSuQmCC)}html[dir] ._7yWKnFiI5dk-ijdh4WnbG::-webkit-scrollbar-button:vertical:increment:hover{background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAMAAAAoLQ9TAAAABlBMVEWdtMT///8YSU3FAAAAAnRSTlP/AOW3MEoAAAAfSURBVHgBY2BEA7QTYIAChAoYH6EFxkeYwQBj0MelAH3GAO2C9+AaAAAAAElFTkSuQmCC)}html[dir] ._7yWKnFiI5dk-ijdh4WnbG::-webkit-scrollbar-button:vertical:decrement{background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAMAAAAoLQ9TAAAABlBMVEXM09b///8OmaLeAAAAAnRSTlP/AOW3MEoAAAAgSURBVHgBY2BEAzQVYIAzYHwGGAvOZ4AyIXyECH1cCgB/GgDtpWTgqAAAAABJRU5ErkJggg==)}html[dir] ._7yWKnFiI5dk-ijdh4WnbG::-webkit-scrollbar-button:vertical:decrement:hover{background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAMAAAAoLQ9TAAAABlBMVEWdtMT///8YSU3FAAAAAnRSTlP/AOW3MEoAAAAgSURBVHgBY2BEAzQVYIAzYHwGGAvOZ4AyIXyECH1cCgB/GgDtpWTgqAAAAABJRU5ErkJggg==)}._7yWKnFiI5dk-ijdh4WnbG::-webkit-scrollbar{height:18px;width:18px}._7yWKnFiI5dk-ijdh4WnbG::-webkit-scrollbar:disabled{display:none}._7yWKnFiI5dk-ijdh4WnbG::-webkit-scrollbar-button,._7yWKnFiI5dk-ijdh4WnbG::-webkit-scrollbar-corner{cursor:pointer}html[dir] ._7yWKnFiI5dk-ijdh4WnbG::-webkit-scrollbar-button,html[dir] ._7yWKnFiI5dk-ijdh4WnbG::-webkit-scrollbar-corner{background:transparent}._7yWKnFiI5dk-ijdh4WnbG::-webkit-scrollbar-button:horizontal:decrement,._7yWKnFiI5dk-ijdh4WnbG::-webkit-scrollbar-button:horizontal:decrement:hover,._7yWKnFiI5dk-ijdh4WnbG::-webkit-scrollbar-button:horizontal:increment,._7yWKnFiI5dk-ijdh4WnbG::-webkit-scrollbar-button:horizontal:increment:hover,._7yWKnFiI5dk-ijdh4WnbG::-webkit-scrollbar-button:vertical:decrement,._7yWKnFiI5dk-ijdh4WnbG::-webkit-scrollbar-button:vertical:decrement:hover,._7yWKnFiI5dk-ijdh4WnbG::-webkit-scrollbar-button:vertical:increment,._7yWKnFiI5dk-ijdh4WnbG::-webkit-scrollbar-button:vertical:increment:hover{height:18px;width:18px}html[dir] ._7yWKnFiI5dk-ijdh4WnbG::-webkit-scrollbar-button:horizontal:decrement,html[dir] ._7yWKnFiI5dk-ijdh4WnbG::-webkit-scrollbar-button:horizontal:decrement:hover,html[dir] ._7yWKnFiI5dk-ijdh4WnbG::-webkit-scrollbar-button:horizontal:increment,html[dir] ._7yWKnFiI5dk-ijdh4WnbG::-webkit-scrollbar-button:horizontal:increment:hover,html[dir] ._7yWKnFiI5dk-ijdh4WnbG::-webkit-scrollbar-button:vertical:decrement,html[dir] ._7yWKnFiI5dk-ijdh4WnbG::-webkit-scrollbar-button:vertical:decrement:hover,html[dir] ._7yWKnFiI5dk-ijdh4WnbG::-webkit-scrollbar-button:vertical:increment,html[dir] ._7yWKnFiI5dk-ijdh4WnbG::-webkit-scrollbar-button:vertical:increment:hover{background-position:50%}html[dir] ._7yWKnFiI5dk-ijdh4WnbG::-webkit-scrollbar-track{background:transparent}html[dir] ._7yWKnFiI5dk-ijdh4WnbG::-webkit-scrollbar-thumb,html[dir] ._7yWKnFiI5dk-ijdh4WnbG::-webkit-scrollbar-thumb:hover{border-radius:9px;border:solid 6px transparent;background-clip:content-box}html[dir] ._7yWKnFiI5dk-ijdh4WnbG::-webkit-scrollbar-thumb{background-color:"[theme:neutralTertiaryAlt, default:#c8c6c4]"}html[dir] ._7yWKnFiI5dk-ijdh4WnbG::-webkit-scrollbar-thumb:hover{background-color:#98a3a6}._7yWKnFiI5dk-ijdh4WnbG::-webkit-scrollbar-thumb:vertical{min-height:50px}._7yWKnFiI5dk-ijdh4WnbG::-webkit-scrollbar-thumb:horizontal{min-width:50px}html[dir=ltr] ._1McOX38KQsqiZzFjJUUtx2,html[dir=ltr] ._2B8Pgwg5VPA665cTvewgP9{margin-right:10px}html[dir=rtl] ._1McOX38KQsqiZzFjJUUtx2,html[dir=rtl] ._2B8Pgwg5VPA665cTvewgP9{margin-left:10px}._1McOX38KQsqiZzFjJUUtx2{color:#0078d4}html[dir] ._1McOX38KQsqiZzFjJUUtx2{border:none}.E9GlcublNN_Nj0jZ_gaZf{display:block;max-height:300px!important;width:300px}._2Xg-H84pjRPXZSgAecFgp9{display:-webkit-box;display:-ms-flexbox;display:flex;height:35px}._2IhBNUkyfJIRC8pb_wLw75,._2Xg-H84pjRPXZSgAecFgp9{position:relative}html[dir] ._2IhBNUkyfJIRC8pb_wLw75{padding:10px 35px}._2WlTfPvzy9Gg6SLFfnlSFe{display:inline-block;position:relative;width:100%}html[dir] ._2WlTfPvzy9Gg6SLFfnlSFe{padding-bottom:8px}html[dir=ltr] ._2WlTfPvzy9Gg6SLFfnlSFe{text-align:right}html[dir=rtl] ._2WlTfPvzy9Gg6SLFfnlSFe{text-align:left}._3n0whWUPf6VsDgPMJQRlu8{color:"[theme:redDark, default:#a80000]"}html[dir=ltr] ._3n0whWUPf6VsDgPMJQRlu8{float:right;padding:0 10px 15px 0}html[dir=rtl] ._3n0whWUPf6VsDgPMJQRlu8{float:left;padding:0 0 15px 10px}',""]),t.locals={vaultInstructionStyle:"_3haK2IBjz_VRRC6iv_arlJ",vaultButtonStyles:"_1WrELIQNYHTrHDt1y2Pezg",vaultButtonIconStyles:"_33bppGTV-7vjiCRosXrTWH",vaultHeaderStyle:"_209abDxCFTw5mv45pdHR2H",vaultTextField:"_7yWKnFiI5dk-ijdh4WnbG",manageVaultButtonStyles:"_1McOX38KQsqiZzFjJUUtx2",saveButtonStyles:"_2B8Pgwg5VPA665cTvewgP9",vaultPopupCalloutStyles:"E9GlcublNN_Nj0jZ_gaZf",headerContainer:"_2Xg-H84pjRPXZSgAecFgp9",contentContainer:"_2IhBNUkyfJIRC8pb_wLw75",footerContainer:"_2WlTfPvzy9Gg6SLFfnlSFe",errorLabel:"_3n0whWUPf6VsDgPMJQRlu8"}},17223:function(e,t,n){"use strict";n.r(t);var r=n(0),i=n(3400),a=n(1996),o=n(370),c=n(2151),l=n(2139),u=n(161);function s(e,t){var n=function(e,t){var n=Object(i.a)("UserHighlightData",t),r=Object(a.a)({Updates:[n],ItemId:Object(o.a)({Id:e})});return Object(c.a)({ItemChanges:[r],ConflictResolution:"AlwaysOverwrite",MessageDisposition:"SaveOnly"})}(e,t);return Object(l.a)({Header:Object(u.b)(),Body:n}).then((function(e){return e.Body.ResponseMessages.Items[0]}))}var d=n(4156),b=n(10304);function m(e,t,n,r,i){var a=function(a){var o=e.getClientRects();je(Object(b.a)(o,n),n,e,t,!r,r,null,i)};e.addEventListener("click",a),e[d.b]=a}var h=n(12),f=n(2),A={highlightIds:new h.ObservableMap},g=Object(f.createStore)("userHighlights",A)(),p=Object(f.mutatorAction)("addHighlightId",(function(e,t){var n=g.highlightIds;n.has(e)||n.set(e,t)})),v=n(4043),k=n(2163);function w(e){var t=e.indexOf(k.b),n=k.b.length+k.a;return e.substring(t,t+n)}var _=n(10863);function O(e,t,n){Object(v.a)(e,[n],(function(e){return function(n){!function(e){var t;return null===(t=null==e?void 0:e.parentElement)||void 0===t?void 0:t.classList.contains(_.userNote)}(n)?j(n,t,e):n.classList.add(k.d)}}),!1,"partially")}function j(e,t,n){e.classList.add(_.userHighlight),p(w(e.className),n),m(e,t,n,!1)}var I=n(114),y=Object(f.mutatorAction)("addUserHighlight",(function(e,t,n){var r=t.userHighlightData;r&&-1==r.indexOf(n)&&(r.push(n),s(t.ItemId.Id,r),O(e,t,n),Object(I.r)("UserMarkup_UserHighlightAdded"))}));function C(e){var t=e[d.b];t&&(e.removeEventListener("click",t),e[d.b]=null)}var E=Object(f.mutatorAction)("removeUserHighlight",(function(e,t){var n=w(e.className),i=g.highlightIds.get(n),a=t.userHighlightData,o=a&&a.indexOf(i),c=o>-1;c&&(a.splice(o,1),s(t.ItemId.Id,a),function(e,t){Object(r.__awaiter)(this,void 0,void 0,(function(){var n,i,a,o;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return[4,Object(k.e)()];case 1:for(n=r.sent(),i=document.querySelectorAll("."+e),n.call(n,i).unmark({className:e}),a=0;a<i.length;a++)o=i[a],t(o);return[2]}}))}))}(n,C)),Object(I.r)("UserMarkup_UserHighlightRemoved",[!c])})),T=n(22),x=n(699),N=n(995),D=n(6),W=n(1),F=n.n(W),S=n(6563),U=n(5678),B=Object(T.a)((function(e){var t=e.selectedText,n=e.element,i=e.item,a=e.isForExistingUserHighlight,o=e.destroyPopupDivCallback;var c=F.a.useCallback((function(){y(n,i,t),window.getSelection().removeAllRanges(),o()}),[t,n,i,o]),l=F.a.useCallback((function(){E(n,i),o()}),[n,i,o]),u=a?{iconProps:{iconName:"Delete"},onClick:l}:{iconProps:{iconName:"Highlight"},onClick:c};return F.a.createElement(N.a,{hostClassName:U.userHighlightButtonWrapper,content:a?Object(D.b)(S.d):Object(D.b)(S.a)},F.a.createElement(x.a,Object(r.__assign)({className:U.UserMarkupPopupButton},u)))})),M=n(3094),P=n(3018),R=n(5678),K=Object(T.a)((function(e){var t=e.target,n=e.selectedText,r=e.element,i=e.item,a=e.isForExistingUserNote,o=e.selectionRange,c=e.selectionInstance,l=e.destroyPopupDivCallback,u=F.a.useCallback((function(){l(),Object(M.d)("Honeybee"),P.c.importAndExecute(n)}),[t,n,r,i,a,o,c,l]);return F.a.createElement(N.a,{content:a?Object(D.b)(S.h):Object(D.b)(S.b)},F.a.createElement(x.a,{className:R.UserMarkupPopupButton,iconProps:a?{iconName:"View"}:{iconName:"EditNote"},onClick:u}))})),G=n(8954),H=n(3111);function V(e){var t=Object(H.a)(e);return Object(G.a)(t)}var L=n(2127),J=n(10299),z=n(5678),Q=Object(T.a)((function(e){var t=e.selectedText,n=e.item,r=e.isForExistingUserHighlight,i=e.destroyPopupDivCallback,a=F.a.useCallback((function(){L.j.importAndExecute(n.ItemId.Id,n.ConversationId.Id,t,0).then((function(){Object(I.r)("UserMarkup_ReplyWithQuote",[r?d.a:d.d])})),i()}),[t,n,r,i]),o=Object(J.a)(n),c=V(n);return F.a.createElement(N.a,{content:o?Object(D.b)(S.e):Object(D.b)(S.f)},F.a.createElement(x.a,{className:z.UserMarkupPopupButton,iconProps:{iconName:"Comment"},onClick:a,disabled:c}))})),q=n(380),Y=n(2660),Z=n(5678),X=Object(T.a)((function(e){var t=e.selectedText,n=e.item,r=e.destroyPopupDivCallback,i=F.a.useCallback((function(){var e={initializePayload:{},actionPayload:{type:"switchListAndCreateTodos",todos:[{Subject:t,LinkedEmail:{Id:n.ItemId.Id,EntitySubtype:q.d,DisplayName:t}}]}};Y.h.importAndExecute("CreateTaskFromHighlight",e),Object(I.r)("UserMarkup_createTask"),r()}),[t,n,r]),a=V(n);return F.a.createElement(N.a,{content:Object(D.b)(S.c)},F.a.createElement(x.a,{className:Z.UserMarkupPopupButton,iconProps:{iconName:"ToDoLogoOutline"},onClick:i,disabled:a}))})),$=n(66);function ee(e){return e.length<d.c?$.DirectionalHint.topCenter:$.DirectionalHint.bottomCenter}var te=n(876),ne=n(879),re=n(746),ie=n(1280),ae=n(2183),oe=n(23),ce=n(4923),le=n(7381),ue=n(229),se=n(15890),de=n(15891),be=null,me=Object(T.a)((function(e){var t=this,n=e.target,i=e.selectedText,a=F.a.useRef(),o=Object(r.__read)(F.a.useState(""),2),c=o[0],l=o[1];return F.a.createElement(re.a,{gapSpace:d.e,className:de.vaultPopupCalloutStyles,isBeakVisible:!1,directionalHint:ee(i),target:n,onDismiss:he},F.a.createElement("div",{className:de.headerContainer},F.a.createElement("div",{className:de.vaultHeaderStyle},Object(D.b)(se.a)),F.a.createElement(te.a,{className:de.vaultButtonStyles,iconProps:{iconName:"Cancel",styles:{root:de.vaultButtonIconStyles}},onClick:he})),F.a.createElement("div",{className:de.contentContainer},F.a.createElement(ie.a,{componentRef:a,className:de.vaultTextField,autoFocus:!0}),F.a.createElement(ie.a,{className:de.vaultTextField,disabled:!0,multiline:i.length>30,resizable:!1,value:i}),F.a.createElement("div",{className:de.vaultInstructionStyle},Object(D.b)(se.b))),F.a.createElement("div",{className:de.footerContainer},F.a.createElement(te.a,{className:de.manageVaultButtonStyles,onClick:function(){Object(ae.b)("OwaVaultPanel")},text:Object(D.b)(se.e)}),F.a.createElement(ne.a,{text:Object(D.b)(se.f),className:de.saveButtonStyles,onClick:function(){return Object(r.__awaiter)(t,void 0,void 0,(function(){var e,t,n;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return 0===(e=a.current?a.current.value:"").length?(l(se.d),[2]):(t={key:e,value:i,categoryName:"UserInfo",dataSource:1,property:{isPinned:!1}},[4,Object(le.a)(t,2)]);case 1:switch((n=r.sent()).status){case 1:l(""),ce.b.importAndExecute("UserInfo",n.userDataItem),he();break;case 2:l(se.c);break;default:oe.g.info("Invalid UserDataStore request status: ["+n.status+"].")}return[2]}}))}))}})),(null==c?void 0:c.length)>0&&F.a.createElement("span",{className:de.errorLabel},Object(D.b)(c)))}));function he(){be&&(ue.unmountComponentAtNode(be),be.parentNode.removeChild(be),be=null)}function fe(e,t){be||(be=document.createElement("div"),document.body.appendChild(be)),ue.render(F.a.createElement(F.a.StrictMode,null,F.a.createElement(me,{target:e,selectedText:t})),be)}var Ae=n(5678),ge=Object(T.a)((function(e){var t=e.target,n=e.selectedText,r=e.destroyPopupDivCallback,i=F.a.useCallback((function(){r(),fe(t,n)}),[t,n,r]);return F.a.createElement(N.a,{content:Object(D.b)(S.g)},F.a.createElement(x.a,{className:Ae.UserMarkupPopupButton,iconProps:{iconName:"Save"},onClick:i}))})),pe=n(33),ve=n(1951),ke=n(5678),we=Object(T.a)((function(e){var t=e.target,n=e.selectedText,r=e.element,i=e.item,a=e.isForExistingUserHighlight,o=e.isForExistingUserNote,c=e.selectionRange,l=e.selectionInstance;return i&&r&&n?W.createElement(re.a,{isBeakVisible:!1,gapSpace:d.e,onDismiss:Oe,directionalHint:ee(n),target:t},W.createElement("div",{className:ke.userMarkupCalloutWrapper},Object(pe.i)("rp-userMarkup")&&!o&&W.createElement(B,{selectedText:n,element:r,item:i,isForExistingUserHighlight:a,destroyPopupDivCallback:Oe}),Object(pe.i)("rp-userMarkup")&&!a&&W.createElement(K,{target:t,selectedText:n,element:r,item:i,isForExistingUserNote:o,selectionRange:c,selectionInstance:l,destroyPopupDivCallback:Oe}),Object(pe.i)("honeybee-saveToVault-rp")&&W.createElement(ge,{target:t,selectedText:n,destroyPopupDivCallback:Oe}),W.createElement(Q,{selectedText:n,item:i,isForExistingUserHighlight:a,destroyPopupDivCallback:Oe}),Object(ve.c)()&&W.createElement(X,{selectedText:n,item:i,destroyPopupDivCallback:Oe}))):null})),_e=null;function Oe(){_e&&(ue.unmountComponentAtNode(_e),_e.parentNode.removeChild(_e),_e=null)}var je=function(e,t,n,r,i,a,o,c){_e||(_e=document.createElement("div"),document.body.appendChild(_e)),ue.render(W.createElement(W.StrictMode,null,W.createElement(we,{target:e,selectedText:t,element:n,item:r,isForExistingUserHighlight:i,isForExistingUserNote:a,selectionRange:o,selectionInstance:c})),_e),Object(I.r)("UserMarkup_PopupShown",[i?d.a:d.d])},Ie=n(10863);function ye(e,t,n,r){e.classList.add(Ie.userNote),m(e,t,n,!0,r)}function Ce(e,t,n,r,i){var a;i&&(i.isNote&&(null===(a=i.noteInstances)||void 0===a?void 0:a.has(r))?ye(e,t,n,r):i.isHighlight?j(e,t,n):i.isNote&&e.classList.add(k.d))}var Ee=n(3606),Te=n(8956);function xe(e){return Object(r.__awaiter)(this,void 0,void 0,(function(){var t;return Object(r.__generator)(this,(function(n){switch(n.label){case 0:return[4,Ne(e)];case 1:return t=n.sent()||[],De(e,t),[2]}}))}))}function Ne(e){return Object(r.__awaiter)(this,void 0,void 0,(function(){var t;return Object(r.__generator)(this,(function(n){switch(n.label){case 0:t=null,n.label=1;case 1:return n.trys.push([1,4,,5]),[4,Ee.c.import()];case 2:return[4,n.sent()(e.ItemId.Id,Te.b)];case 3:return t=n.sent(),[3,5];case 4:return n.sent(),[3,5];case 5:return t?[2,t.UserHighlightData]:[2,null]}}))}))}var De=Object(f.mutatorAction)("setUserHighlightDataForItem",(function(e,t){e.userHighlightData=t})),We=n(8957),Fe=n(2955);function Se(e){return Object(r.__awaiter)(this,void 0,void 0,(function(){var t;return Object(r.__generator)(this,(function(n){switch(n.label){case 0:return[4,Ue(e)];case 1:return t=n.sent()||[],Be(e,t),[2]}}))}))}function Ue(e){return Object(r.__awaiter)(this,void 0,void 0,(function(){var t,n;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:t=null,r.label=1;case 1:return r.trys.push([1,4,,5]),[4,Ee.c.import()];case 2:return[4,r.sent()(e.ItemId.Id,We.c)];case 3:return t=r.sent(),[3,5];case 4:return r.sent(),[3,5];case 5:return t?[2,(n=Object(Fe.a)(t,null,We.a))?JSON.parse(n):null]:[2,null]}}))}))}var Be=Object(f.mutatorAction)("setUserNoteDataForItem",(function(e,t){e.userNoteData=t}));function Me(e){return Object(r.__awaiter)(this,void 0,void 0,(function(){var t;return Object(r.__generator)(this,(function(n){switch(n.label){case 0:return t={userHighlightData:null,userNoteData:null},e?e.userHighlightData?[3,2]:[4,xe(e)]:[3,5];case 1:n.sent(),n.label=2;case 2:return t.userHighlightData=e.userHighlightData,e.userNoteData?[3,4]:[4,Se(e)];case 3:n.sent(),n.label=4;case 4:t.userNoteData=e.userNoteData,n.label=5;case 5:return[2,t]}}))}))}function Pe(e,t){var n=[];return e.forEach((function(e){return n.push(e)})),t.forEach((function(e){var t=e.keyword;-1==n.indexOf(t)&&n.push(t)})),n}function Re(e,t){var n=new Map;return e.forEach((function(e){n.set(e,{isHighlight:!0,isNote:!1})})),t.forEach((function(e){var t=e.keyword,r=e.instance,i=n.get(t),a=(null==i?void 0:i.noteInstances)||new Set;a.add(r),i?(i.isNote=!0,i.noteInstances=a):i={isHighlight:!1,isNote:!0,noteInstances:a},n.set(t,i)})),n}n.d(t,"showUserMarkupPopup",(function(){return je})),n.d(t,"destroyPopupDiv",(function(){return Oe})),n.d(t,"markInstanceOfUserMarkup",(function(){return Ce})),n.d(t,"removeUserMarkupPopupEventListener",(function(){return C})),n.d(t,"getItemUserMarkupData",(function(){return Me})),n.d(t,"getItemUserMarkupKeywords",(function(){return Pe})),n.d(t,"getItemUserMarkupMap",(function(){return Re}))},1864:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(0);function i(e){return Object(r.__assign)({__type:"Message:#Exchange"},e)}},1951:function(e,t,n){"use strict";var r=n(2),i=Object(r.action)("openTimePanel",(function(e){return{source:e}})),a=Object(r.action)("handleTimePanelClosed",(function(e,t,n,r){return{source:e,sessionDuration:t,lastView:n,clientItemId:r}})),o=Object(r.action)("popView"),c=n(490);function l(){return!Object(c.v)()||!window.opener}var u=n(2389);function s(){return l()&&Object(u.a)("Tasks")}n.d(t,"d",(function(){return i})),n.d(t,"a",(function(){return a})),n.d(t,"e",(function(){return o})),n.d(t,"b",(function(){return l})),n.d(t,"c",(function(){return s}))},1989:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return a}));var r=n(2),i=Object(r.action)("NEW_MESSAGE_V3",(function(e,t,n,r,i){return{actionSource:e,groupId:t,toEmailAddressWrappers:n,subject:r,body:i}})),a=Object(r.action)("ON_CLOSE_COMPOSE",(function(e){return{closeReason:e}}))},1996:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(0);function i(e){return Object(r.__assign)({__type:"ItemChange:#Exchange"},e)}},2031:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(0);function i(e){return Object(r.__assign)({__type:"SetItemField:#Exchange"},e)}},2127:function(e,t,n){"use strict";var r=n(2),i=n(1989);Object(r.orchestrator)(i.a,(function(e){l.importAndExecute(e.actionSource,e.groupId,e.toEmailAddressWrappers,e.subject,e.body)}));var a=n(2395),o=(Object(r.orchestrator)(a.a,(function(e){var t=e.source,n=e.groupId,r=e.toRecipients,a=e.subject,o=e.body;Object(i.a)(t,n,r,a,o)})),n(36));n.d(t,"c",(function(){return l})),n.d(t,"h",(function(){return u})),n.d(t,"a",(function(){return s})),n.d(t,"f",(function(){return d})),n.d(t,"i",(function(){return b})),n.d(t,"b",(function(){return m})),n.d(t,"g",(function(){return h})),n.d(t,"k",(function(){return f})),n.d(t,"j",(function(){return A})),n.d(t,"e",(function(){return g})),n.d(t,"d",(function(){return p}));var c=new o.c((function(){return Promise.all([n.e(28),n.e(34),n.e(38),n.e(43),n.e(646)]).then(n.bind(null,17254))})),l=new o.a(c,(function(e){return e.newMessage}),{captureBundleTime:!0}),u=new o.a(c,(function(e){return e.replyToConversation})),s=new o.a(c,(function(e){return e.forwardConversation})),d=new o.a(c,(function(e){return e.printConversation})),b=new o.a(c,(function(e){return e.replyToItem})),m=new o.a(c,(function(e){return e.forwardItem})),h=new o.a(c,(function(e){return e.printItem})),f=new o.a(c,(function(e){return e.showConversationInImmersiveReader})),A=new o.a(c,(function(e){return e.replyWithText})),g=new o.a(c,(function(e){return e.onKeyboardReply})),p=new o.a(c,(function(e){return e.onKeyboardForward}))},2139:function(e,t,n){"use strict";var r=n(30),i=n(0);function a(e,t){var n;return void 0===e||e.__type||(n=e,e=Object(i.__assign)({__type:"UpdateItemJsonRequest:#Exchange"},n)),Object(r.a)("UpdateItem",e,t)}n.d(t,"a",(function(){return a}))},2151:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(0);function i(e){return Object(r.__assign)({__type:"UpdateItemRequest:#Exchange"},e)}},2188:function(e,t,n){"use strict";var r=n(0),i={abovePanelHeight:n(2318).b,initialPanelView:"Calendar",initialCalendarView:"Agenda",areFREsDisabled:!1,isInlineComposeDisabled:!1,isClosePaneButtonEnabled:!1,isTasksViewDisabled:!1};function a(e){i=Object(r.__assign)({},e)}function o(){return i}n.d(t,"b",(function(){return a})),n.d(t,"a",(function(){return o}))},2318:function(e,t,n){"use strict";n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return i}));var r=48,i=65},2389:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(2431),i=n(2188),a=n(1768);function o(e){return"Tasks"!==Object(r.a)(e)||Object(a.c)()&&!Object(i.a)().isTasksViewDisabled}},2395:function(e,t,n){"use strict";var r=n(2);t.a=Object(r.action)("createFeedbackForCortana",(function(e,t,n,r,i){return{source:e,groupId:t,toRecipients:n,subject:r,body:i}}))},2431:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r={Conflicts:"Calendar",EventDetails:"Calendar",AttendeeTracking:"Calendar",Calendar:"Calendar",ComposeForm:"Calendar",Tasks:"Tasks",TaskDetails:"Tasks"};function i(e){return e?r[e]:null}},2660:function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return c})),n.d(t,"d",(function(){return l})),n.d(t,"f",(function(){return u})),n.d(t,"h",(function(){return s})),n.d(t,"i",(function(){return d})),n.d(t,"e",(function(){return b})),n.d(t,"c",(function(){return m})),n.d(t,"g",(function(){return h}));var r=n(1951),i=n(36),a=new i.c((function(){return Promise.all([n.e(0),n.e(1),n.e(2),n.e(6),n.e(21),n.e(25),n.e(27),n.e(32),n.e(42),n.e(82),n.e(133),n.e(171),n.e(280),n.e(934)]).then(n.bind(null,3789))}));Object(i.f)(r.d,a,(function(e){return e.openTimePanelOrchestrator}));var o=Object(i.d)(a,(function(e){return e.TimePanel})),c=Object(i.d)(a,(function(e){return e.TimePanelHeaderBar})),l=new i.a(a,(function(e){return e.loadTimePanelData})),u=new i.a(a,(function(e){return e.openEventDetailsView})),s=(new i.a(a,(function(e){return e.openAttendeeTrackingView})),new i.a(a,(function(e){return e.closeAttendeeTrackingView})),new i.a(a,(function(e){return e.openTasksView}))),d=new i.a(a,(function(e){return e.openCalendarView})),b=new i.a(a,(function(e){return e.openConflictsView})),m=new i.a(a,(function(e){return e.closeConflictsView})),h=new i.a(a,(function(e){return e.openEventQuickComposeView}))},2940:function(e,t,n){"use strict";var r=n(2),i=Object(r.createStore)("notesStore",{isPanelInitialized:!1,isPanelOpen:!1,sessionId:void 0,panelOpenTimestamp:void 0,source:void 0,selectedNoteId:void 0,selectedNoteColor:void 0});t.a=i},3018:function(e,t,n){"use strict";n.d(t,"f",(function(){return o})),n.d(t,"c",(function(){return c})),n.d(t,"d",(function(){return l})),n.d(t,"e",(function(){return u})),n.d(t,"b",(function(){return s})),n.d(t,"g",(function(){return d}));var r=n(36),i=n(2940);n.d(t,"a",(function(){return i.a}));var a=new r.c((function(){return Promise.all([n.e(0),n.e(1),n.e(2),n.e(3),n.e(4),n.e(9),n.e(15),n.e(41),n.e(54),n.e(58),n.e(87),n.e(162),n.e(179),n.e(264),n.e(689),n.e(876)]).then(n.bind(null,5359))})),o=new r.b(a,(function(e){return e.getNotesSDK})),c=(new r.b(a,(function(e){return e.ContextType})),new r.a(a,(function(e){return e.createAndOpenNote}))),l=new r.a(a,(function(e){return e.createNewNote})),u=new r.a(a,(function(e){return e.deleteNote})),s=new r.a(a,(function(e){return e.changeNoteColor})),d=new r.a(a,(function(e){return e.viewEmailFromNote}))},3094:function(e,t,n){"use strict";var r=n(36),i=n(2),a=Object(i.action)("openOneNoteFeedPanel",(function(e){return{source:e}})),o=Object(i.action)("handleOneNoteFeedPanelClosed",(function(e,t){return{source:e,sessionDuration:t}}));n.d(t,"b",(function(){return l})),n.d(t,"c",(function(){return u})),n.d(t,"d",(function(){return a})),n.d(t,"a",(function(){return o}));var c=new r.c((function(){return Promise.all([n.e(3),n.e(868)]).then(n.bind(null,17336))})),l=new r.a(c,(function(e){return e.initializeOneNoteFeed})),u=new r.b(c,(function(e){return e.isOneNoteFeedEnabled}))},3400:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(1864),i=n(782),a=n(2031);function o(e,t){var n;return Object(a.a)({Path:Object(i.a)({FieldURI:e}),Item:Object(r.a)((n={},n[e]=t,n))})}},380:function(e,t,n){"use strict";var r,i="dragged_email";!function(e){e.Normal="Normal",e.High="High",e.Low="Low"}(r||(r={}));var a=r;function o(e){return"Todo"===(null==e?void 0:e.__type)}var c=n(0),l=n(203);function u(e){return e=null!==e?e:{},Object(c.__assign)(Object(c.__assign)({},e),{CompletedDateTime:e.CompletedDateTime?e.CompletedDateTime:null,Id:e.Id?e.Id:Object(l.a)(),IsCompleted:!!e.IsCompleted&&e.IsCompleted,OrderDateTime:e.OrderDateTime?e.OrderDateTime:null,Subject:e.Subject?e.Subject:null})}function s(e){var t=(e=null!==e?e:{}).Id?e.Id:Object(l.a)();return Object(c.__assign)(Object(c.__assign)({},e),{__type:"Todo",Id:t,ParentFolderId:e.ParentFolderId?e.ParentFolderId:null,Subject:e.Subject?e.Subject:null,ReminderDateTime:e.ReminderDateTime?e.ReminderDateTime:null,IsReminderOn:!!e.IsReminderOn&&e.IsReminderOn,CompletedDateTime:e.CompletedDateTime?e.CompletedDateTime:null,DueDateTime:e.DueDateTime?e.DueDateTime:null,OrderDateTime:e.OrderDateTime?e.OrderDateTime:null,Status:e.Status?e.Status:"NotStarted",Subtasks:e.Subtasks?e.Subtasks:null,Importance:e.Importance?e.Importance:a.Normal,Note:e.Note?e.Note:null,LinkedEmail:e.LinkedEmail?e.LinkedEmail:null,CommittedDay:e.CommittedDay?e.CommittedDay:null,CommittedOrder:e.CommittedOrder?e.CommittedOrder:null,CreatedWithLocalId:t})}function d(e){return e=null!==e?e:{},Object(c.__assign)(Object(c.__assign)({},e),{Id:e.Id?e.Id:Object(l.a)(),Name:e.Name?e.Name:null,IsDefaultFolder:!!e.IsDefaultFolder&&e.IsDefaultFolder,IsSharedFolder:!!e.IsSharedFolder&&e.IsSharedFolder,IsOwner:!!e.IsOwner&&e.IsOwner,FolderType:e.FolderType?e.FolderType:"Other",SyncStatus:e.SyncStatus?e.SyncStatus:"Synced",OrderDateTime:e.OrderDateTime?e.OrderDateTime:null})}function b(e){return e&&e.subjects&&0!==e.subjects.length?e.subjects.map((function(t,n){return{Subject:t,LinkedEmail:{Id:e.latestItemIds[n],EntitySubtype:i,DisplayName:t}}})):[]}n.d(t,"c",(function(){return"message"})),n.d(t,"b",(function(){return i})),n.d(t,"d",(function(){return"highlight_from_email"})),n.d(t,"a",(function(){return"context_menu_email"})),n.d(t,"e",(function(){return a})),n.d(t,"j",(function(){return o})),n.d(t,"f",(function(){return u})),n.d(t,"g",(function(){return s})),n.d(t,"h",(function(){return d})),n.d(t,"i",(function(){return b}))},4923:function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return o})),n.d(t,"c",(function(){return c}));var r=n(36),i=new r.c((function(){return Promise.all([n.e(0),n.e(1),n.e(2),n.e(8),n.e(282),n.e(793)]).then(n.bind(null,9140))})),a=Object(r.d)(i,(function(e){return e.VaultPanel})),o=new r.a(i,(function(e){return e.addUserDataItemToVault})),c=new r.a(i,(function(e){return e.initializeVaultInfo}))},5678:function(e,t,n){var r=n(15889),i=n(95);"string"==typeof r&&(r=[[e.i,r]]);for(var a=0;a<r.length;a++)i.loadStyles(r[a][1],!1);r.locals&&(e.exports=r.locals)},6563:function(e){e.exports=JSON.parse('{"a":"U3b","b":"V3b","h":"W3b","e":"X3b","f":"Y3b","d":"Z3b","c":"_3b","g":"$3b"}')},6564:function(e,t,n){"use strict";function r(e){return(null==e?void 0:e.MailboxInfo)&&"GroupMailbox"==e.MailboxInfo.type}n.d(t,"a",(function(){return r}))},8954:function(e,t,n){"use strict";function r(e){return!(e.CopyAllowed&&e.ForwardAllowed&&e.ReplyAllAllowed&&e.ReplyAllowed&&e.PrintAllowed)}n.d(t,"a",(function(){return r}))},8956:function(e,t,n){"use strict";n.d(t,"b",(function(){return c}));var r=n(6564),i=n(33),a=n(1629),o=n(782),c="UserHighlight",l=Object(o.a)({FieldURI:"UserHighlightData"}),u={featureId:c,propertyPaths:[l],isPropertyExistedOnItem:function(e){var t=a.a.items.get(e);return t&&null!=t.userHighlightData},shouldGetItemPropertiesFromServer:function(e,t){if(!Object(i.i)("rp-userMarkup"))return!1;var n=a.a.items.get(e);return n&&!Object(r.a)(n)}};t.a=u},8957:function(e,t,n){"use strict";n.d(t,"c",(function(){return c})),n.d(t,"a",(function(){return l}));var r=n(6564),i=n(33),a=n(1629),o=n(4156),c="UserNote",l="UserNoteData",u={featureId:c,propertyPaths:[o.f],isPropertyExistedOnItem:function(e){var t=a.a.items.get(e);return t&&null!=t.userNoteData},shouldGetItemPropertiesFromServer:function(e,t){if(!Object(i.i)("rp-userMarkup"))return!1;var n=a.a.items.get(e);return n&&!Object(r.a)(n)}};t.b=u}}]);
//# sourceMappingURL=owa.MailBoot~UserHighlighting.js.map
self.scriptsLoaded['owa.MailBoot~UserHighlighting.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.MailBoot~UserHighlighting.js'] = (new Date()).getTime();