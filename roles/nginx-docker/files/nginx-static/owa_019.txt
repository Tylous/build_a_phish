self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.MailBoot~AttachmentFileProviderFolderPicker~AttachmentModelStore~AttachmentOps~AttachmentPreviewSxS~~d642b683.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[31],{11164:function(e,t,r){"use strict";function n(e,t,r,n,o,i){var a=!1;return{task:function(){return new Promise((function(s,c){for(var u=0,l=0,d=0,f=function(){var h,v,b,p,O;a&&s(1),u<r&&d<t.length&&((h=d,v=t[h],b=v.start,p=v.end,O=e.slice(b,p),n(O,i(h),o)).then((function(){return u-=1,(l+=1)===t.length&&s(0),void f()})).catch(c),d+=1,u+=1)},h=0;h<r;h++)f()}))},cancelTask:function(){return a=!0}}}var o=Object.freeze({sliceSize:14680064,numberOfSlicesToParallelize:2});function i(e,t,r){void 0===r&&(r=o),function(e){e.sliceSize=e.sliceSize||o.sliceSize,e.numberOfSlicesToParallelize=e.numberOfSlicesToParallelize||o.numberOfSlicesToParallelize}(r);var i=r.sliceSize,c=r.numberOfSlicesToParallelize,u=Math.ceil(e.size/i),l=function(e,t,r){for(var n=[],o=0,i=0;i<e;i++){var a=Math.min(o+t,r);n.push({start:o,end:a}),o=a}return n}(u,i,e.size),d=n(e,[l[0]],1,t,u,(function(){return 0})),f=l.length>2?n(e,l.slice(1,l.length-1),c,t,u,(function(e){return e+1})):s(),h=l.length>1?n(e,[l[l.length-1]],1,t,u,(function(){return l.length-1})):s();return{onCompletePromise:d.task().then(a(f.task)).then(a(h.task)),cancel:function(){d.cancelTask(),f.cancelTask(),h.cancelTask()}}}function a(e){return function(t){return 0===t?e():Promise.resolve(t)}}function s(){var e=!1;return{task:function(){return e?Promise.resolve(1):Promise.resolve(0)},cancelTask:function(){return e=!0}}}r.d(t,"a",(function(){return i}))},2564:function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));var n=r(0);function o(e){return Object(n.__assign)({__type:"FetchDataProviderResourceRequest:#Exchange"},e)}},2601:function(e,t,r){"use strict";var n=r(3242),o=r(5483);function i(e){var t;try{t=btoa(e)}catch(r){t=btoa(unescape(encodeURIComponent(e)))}finally{return"u!"+t.replace(/=+$/,"").replace("/","_").replace("+","-")}}r.d(t,"d",(function(){return n.d})),r.d(t,"a",(function(){return n.a})),r.d(t,"b",(function(){return n.b})),r.d(t,"e",(function(){return n.e})),r.d(t,"c",(function(){return n.c})),r.d(t,"f",(function(){return o.a})),r.d(t,"g",(function(){return i}))},2828:function(e,t,r){"use strict";var n=r(0),o="https://www.googleapis.com/drive/v3/files",i=r(3168);function a(e,t,r){return void 0===r&&(r={forceTokenRefresh:!1,requestInit:{}}),Object(n.__awaiter)(this,void 0,void 0,(function(){var o,a,s;return Object(n.__generator)(this,(function(n){switch(n.label){case 0:return o=r.forceTokenRefresh,a=r.requestInit||{},[4,Object(i.d)(t,o,e)];case 1:return s=n.sent(),a.headers||(a.headers=new Headers),a.headers.set("Authorization",s),[4,fetch(e,a)];case 2:return[2,n.sent()]}}))}))}function s(e,t){return void 0===t&&(t=!1),Object(n.__awaiter)(this,void 0,void 0,(function(){var r,i;return Object(n.__generator)(this,(function(n){switch(n.label){case 0:return[4,a(o+"?"+e,5,{forceTokenRefresh:t})];case 1:return(r=n.sent()).ok?[4,r.text()]:[3,3];case 2:return i=n.sent(),[2,{errorResponse:null,result:JSON.parse(i)}];case 3:return[2,{errorResponse:r,result:null}]}}))}))}function c(e){return Object(n.__awaiter)(this,void 0,void 0,(function(){var t,r;return Object(n.__generator)(this,(function(n){switch(n.label){case 0:return[4,a(o+"/"+e+"?fields=id,mimeType,name,size,modifiedTime,createdTime,thumbnailLink,webViewLink,webContentLink,fileExtension",5)];case 1:return(t=n.sent()).ok?[4,t.text()]:[3,3];case 2:return r=n.sent(),[2,{errorResponse:null,result:JSON.parse(r)}];case 3:return[2,{errorResponse:t,result:null}]}}))}))}var u=r(96),l=r(2601),d=r(300),f=Object.freeze({name:"name",size:"size",lastModifiedBy:"lastModifiedBy",lastModifiedDateTime:"lastModifiedDateTime",file:"file",folder:"folder",id:"id",webDavUrl:"webDavUrl",package:"package",shared:"shared"});function h(){return Object.keys(f).map((function(e){return f[e]})).join(",")}var v,b="_api/v2.0",p="/v1.0",O="root";function m(e){switch(e){case 1:return p;case 0:return b;default:return Object(u.a)(e)}}function _(e){return m(e)+"/drive"}function w(e){return m(e)+"/shares"}function j(e){return _(e)+"/items"}function g(e,t,r,o,i,a,s){return void 0===a&&(a=v.None),Object(n.__awaiter)(this,void 0,void 0,(function(){var c,b,p,m,_,w,g,k,y;return Object(n.__generator)(this,(function(n){switch(n.label){case 0:return i=i||O,c=function(e){switch(e){case 0:return f.name;case 1:return f.size;default:return f.lastModifiedDateTime}}(r),b=function(e){switch(e){case 0:return"asc";case 1:return"desc";default:return Object(u.a)(e)}}(o),p=function(e,t,r){switch(e){case 0:return"folder,"+t+" "+r;case 1:return t+" "+r;default:return Object(u.a)(e)}}(t,c,b),m="expand=thumbnails(select=medium)&orderby="+p+"&select="+h(),a!==v.None&&(m=m+"&filter="+function(e){switch(e){case v.None:return"";case v.Folder:return"("+f.folder+" ne null)";default:return Object(u.a)(e)}}(a)),s&&(m=m+"&$top="+s.maxEntries,s.skipToken&&(m=m+"&$skiptoken="+s.skipToken)),_=e+"/"+j(t)+"/"+i+"/children?"+m,w={Prefer:"HonorNonIndexedQueriesWarningMayFailRandomly"},[4,Object(l.f)(t,encodeURI(_),_,{method:l.b,mode:l.a,datapointNamePrefix:"getOneDriveItems"},w)];case 1:return g=n.sent(),k=JSON.parse(g),y=k["@odata.nextLink"]?function(e){var t=Object(d.parse)(e,!0);return t.query?t.query.$skiptoken:null}(decodeURI(k["@odata.nextLink"])):null,[2,{errorResponse:null,result:{items:k.value,skipToken:y}}]}}))}))}function k(e,t,r,o){return Object(n.__awaiter)(this,void 0,void 0,(function(){var i,a,s,c,u;return Object(n.__generator)(this,(function(n){switch(n.label){case 0:o=o||O,i="expand=thumbnails(select=medium)&select="+h(),a=t+"/"+j(e)+"/"+o+"/children?"+i,s={name:r,folder:{}},(c=new Headers).append("Content-Type","application/json"),c.append("Accept","application/json"),n.label=1;case 1:return n.trys.push([1,3,,4]),[4,Object(l.f)(e,encodeURI(a),a,{method:l.d,mode:l.a,body:JSON.stringify(s),datapointNamePrefix:"createNewFolder"},null)];case 2:return u=n.sent(),[2,{errorResponse:null,result:JSON.parse(u)}];case 3:return[2,{errorResponse:n.sent(),result:null}];case 4:return[2]}}))}))}!function(e){e[e.None=0]="None",e[e.Folder=1]="Folder"}(v||(v={}));var y=r(11164),S=r(5483),T=r(218);var R=Object.freeze({folderInfo:{type:0,identifier:O},sliceSize:10485760,conflictBehavior:"rename",onProgress:function(){}});function P(e,t,r){var o=this,i=function(){return Promise.resolve({errorResponse:null,result:null})};return{uploadPromise:Object(n.__awaiter)(o,void 0,void 0,(function(){var o,a,s,c,d,f,h,v,b,p,O,m,w,g,k;return Object(n.__generator)(this,(function(P){switch(P.label){case 0:switch(function(e){Object.keys(R).forEach((function(t){e[t]=e[t]||R[t]}))}(r),o=r.fileToUpload,a=o.fileName,s=o.fileBlob,c=r.folderInfo,d=c.type,f=c.identifier,h=r.conflictBehavior,v=r.sliceSize,b=r.onProgress,d){case 0:p=t+"/"+j(e)+"/"+f+":/"+encodeURI(a)+":/createUploadSession";break;case 1:p=t+"/"+_(e)+"/"+f+":/"+encodeURI(a)+":/createUploadSession";break;default:Object(u.a)(d)}return O={item:{"@name.conflictBehavior":h}},[4,Object(S.a)(e,p,p,{method:l.d,mode:l.a,body:JSON.stringify(O),datapointNamePrefix:"createUploadSession"},null)];case 1:return m=P.sent(),w=function(e,t,r,o){var i=this,a=e.uploadUrl,s=t.size,c=null,l=null,d=function(e,t,r,o,i,a){var s=this;return function(c,u){return Object(n.__awaiter)(s,void 0,void 0,(function(){var s,l,d,f,h;return Object(n.__generator)(this,(function(n){switch(n.label){case 0:return s=function(e,t,r){var n=x(e,t,r),o=n.rangeStart,i=n.rangeEnd;return new Headers({"Content-Range":"bytes "+o+"-"+i+"/"+r,Accept:"application/json"})}(u,t,r),l=function(e){var n=x(e,t,r).rangeStart;return function(e){var t=e.loaded;o({loaded:n+t,total:r})}}(u),[4,(v=e,b=l,p={method:"PUT",body:c,headers:s},void 0===p&&(p={method:"POST"}),new Promise((function(e,t){var r=p.method,n=p.body,o=p.headers,i=new XMLHttpRequest;i.onreadystatechange=function(){4===i.readyState&&e({status:i.status,text:function(){return Promise.resolve(i.responseText)}})},i.ontimeout=function(){t(new Error("Request timed out"))},i.onerror=function(){t(new Error("Request failed"))},i.onabort=function(){t(new Error("Request aborted"))},b&&(i.upload.onprogress=b),i.open(r,v,!0),new Headers(o).forEach((function(e,t){i.setRequestHeader(t,e)})),n?i.send(n):i.send()})))];case 1:return 201!==(d=n.sent()).status&&200!==d.status?[3,3]:[4,d.text()];case 2:f=n.sent(),h=JSON.parse(f),i(h),n.label=3;case 3:if(!Object(T.a)(d.status))throw a(d),new Error("Unable to upload file");return[2]}var v,b,p}))}))}}(a,r,s,o,(function(e){c=e}),(function(e){l=e})),f=Object(y.a)(t,d,{sliceSize:r,numberOfSlicesToParallelize:1}),h=f.onCompletePromise,v=f.cancel,b=Object(n.__awaiter)(i,void 0,void 0,(function(){var e;return Object(n.__generator)(this,(function(t){switch(t.label){case 0:e=null,t.label=1;case 1:return t.trys.push([1,3,,4]),[4,h];case 2:return e=t.sent(),[3,4];case 3:return t.sent(),[2,{errorResponse:l,result:null}];case 4:switch(e){case 0:return c?[2,{errorResponse:null,result:c}]:[2,{errorResponse:l,result:null}];case 1:throw new Error("Upload was cancelled");default:return[2,Object(u.a)(e)]}return[2]}}))}));return{uploadPromise:b,cancel:function(){return Object(n.__awaiter)(i,void 0,void 0,(function(){return Object(n.__generator)(this,(function(e){switch(e.label){case 0:v(),e.label=1;case 1:return e.trys.push([1,,3,5]),[4,b];case 2:return e.sent(),[3,5];case 3:return[4,N(a)];case 4:return[2,e.sent()];case 5:return[2]}}))}))}}}(JSON.parse(m),s,v,b),g=w.uploadPromise,k=w.cancel,i=k,[4,g];case 2:return[2,P.sent()]}}))})),cancel:function(){return Object(n.__awaiter)(o,void 0,void 0,(function(){return Object(n.__generator)(this,(function(e){switch(e.label){case 0:return[4,i()];case 1:return[2,e.sent()]}}))}))}}}function x(e,t,r){var n=e*t;return{rangeStart:n,rangeEnd:Math.min(n+t,r)-1}}function N(e){return Object(n.__awaiter)(this,void 0,void 0,(function(){var t;return Object(n.__generator)(this,(function(r){switch(r.label){case 0:return[4,fetch(e,{method:"DELETE"})];case 1:return t=r.sent(),Object(T.a)(t.status)?[2,{errorResponse:null,result:null}]:[2,{errorResponse:t,result:null}]}}))}))}var E="https://api.dropboxapi.com/2/files";function D(e,t){switch(e){case 0:return t;case 1:return null;default:Object(u.a)(e)}return null}var A=r(114);function z(e,t){return Object(n.__awaiter)(this,void 0,void 0,(function(){var r,o,i,s,c;return Object(n.__generator)(this,(function(n){switch(n.label){case 0:switch(r=new A.b("GetOneDriveMRUItems"),t){case 1:o="https://api.onedrive.com/v2.1/drive/recent?top=50";break;case 0:o=e+"/_api/v2.1/drive/recent?top=50";break;default:throw Error("OneDriveMRUItems only supports OneDrive providers!")}i=null,n.label=1;case 1:return n.trys.push([1,3,,4]),[4,a(o,t,{forceTokenRefresh:!1})];case 2:return i=n.sent(),[3,4];case 3:return n.sent(),[3,4];case 4:return r.addCosmosOnlyData(JSON.stringify({providerType:t,validResponse:null!==i,success:null==i?void 0:i.ok})),(null==i?void 0:i.ok)?[4,i.text()]:[3,6];case 5:return s=n.sent(),c=JSON.parse(s),r.end(),[2,{errorResponse:null,result:c}];case 6:return r.endWithError("ClientError"),[2,{errorResponse:i,result:null}]}}))}))}function I(e){return"file"===e[".tag"]}function U(e){return"folder"===e[".tag"]}function C(e){return"deleted"===e[".tag"]}function F(e){return"folder"===e.type}function J(e){return Object(n.__awaiter)(this,void 0,void 0,(function(){var t,r,o,i;return Object(n.__generator)(this,(function(n){switch(n.label){case 0:return e.path=e.path||"",t=E+"/list_folder",r={method:"POST",headers:new Headers({"Content-Type":"application/json",Accept:"application/json"}),body:JSON.stringify(e)},[4,a(t,2,{requestInit:r})];case 1:return(o=n.sent()).ok?[4,o.text()]:[3,3];case 2:return i=n.sent(),[2,{errorResponse:null,result:JSON.parse(i).entries}];case 3:return[2,{errorResponse:o,result:null}]}}))}))}var M,B="https://api.box.com/2.0",q=2e3;function H(e,t){return void 0===t&&(t=q),Object(n.__awaiter)(this,void 0,void 0,(function(){var r,o;return Object(n.__generator)(this,(function(n){switch(n.label){case 0:return[4,a(B+"/folders/"+(e=e||"0")+"/items?fields=id,size,name,type,path_collection,modified_at,modified_by&limit="+t+"&offset=0",3)];case 1:return(r=n.sent()).ok?[4,r.text()]:[3,3];case 2:return o=n.sent(),[2,{errorResponse:null,result:JSON.parse(o).entries}];case 3:return[2,{errorResponse:r,result:null}]}}))}))}!function(e){e.Uploaded="uploaded",e.Tagged="tagged"}(M||(M={}));var L=M,W="https://graph.facebook.com/v2.7",G=200;function V(e,t){return void 0===t&&(t=G),Object(n.__awaiter)(this,void 0,void 0,(function(){var r,o;return Object(n.__generator)(this,(function(n){switch(n.label){case 0:return[4,a(W+"/me/photos/?fields=id,name,images,from,link,album,place,created_time&type="+e.toString()+"&limit="+t,6)];case 1:return(r=n.sent()).ok?[4,r.text()]:[3,3];case 2:return o=n.sent(),[2,{errorResponse:null,result:JSON.parse(o).data}];case 3:return[2,{errorResponse:r,result:null}]}}))}))}var $=r(1056),X=r(1057),Q=r(554),K=r(954),Y=r(1747),Z=r(788),ee=r(161),te=r(23);function re(e,t){var r=function(e,t){return Object(X.a)({ParentFolderIds:[Object(Q.a)({Id:e})],ItemShape:Object(Z.a)({BaseShape:"IdOnly"}),ShapeName:"MailListItem",Traversal:"Shallow",Paging:t,FocusedViewFilter:-1,ViewFilter:"All",SortOrder:null})}(e,t);return Object($.a)({Header:Object(ee.b)(),Body:r})}function ne(e,t){return Object(n.__awaiter)(this,void 0,void 0,(function(){var r,o,i;return Object(n.__generator)(this,(function(n){switch(n.label){case 0:return r=Object(Y.a)({BasePoint:"Beginning",Offset:t,MaxEntriesReturned:100}),[4,re(e=e||Object(K.a)("inbox"),r)];case 1:return o=n.sent(),(i=o.Body.ResponseMessages.Items[0])&&"Success"===i.ResponseClass&&i.RootFolder.Items?[2,{errorResponse:null,result:i.RootFolder.Items}]:(te.g.warn("Find Item Response of get mail messages failed with "+i),[2,{errorResponse:{body:null,headers:null,ok:!1,redirected:!1,status:1,statusText:"Get mail message items error",type:null,url:null,clone:null,bodyUsed:null,arrayBuffer:null,blob:null,formData:null,json:null,text:null,trailer:null},result:null}])}}))}))}r.d(t,"m",(function(){return s})),r.d(t,"l",(function(){return c})),r.d(t,"o",(function(){return g})),r.d(t,"f",(function(){return v})),r.d(t,"g",(function(){return k})),r.d(t,"w",(function(){return P})),r.d(t,"i",(function(){return _})),r.d(t,"r",(function(){return w})),r.d(t,"e",(function(){return"https://api.onedrive.com"})),r.d(t,"b",(function(){return"https://api.dropboxapi.com/2/sharing"})),r.d(t,"d",(function(){return o})),r.d(t,"q",(function(){return D})),r.d(t,"p",(function(){return z})),r.d(t,"u",(function(){return I})),r.d(t,"v",(function(){return U})),r.d(t,"t",(function(){return C})),r.d(t,"j",(function(){return J})),r.d(t,"s",(function(){return F})),r.d(t,"h",(function(){return H})),r.d(t,"a",(function(){return B})),r.d(t,"c",(function(){return L})),r.d(t,"k",(function(){return V})),r.d(t,"n",(function(){return ne}))},2961:function(e,t,r){"use strict";r.d(t,"a",(function(){return i}));var n=r(30),o=r(2564);function i(e,t){return void 0===e||e.__type||(e=Object(o.a)(e)),Object(n.a)("FetchDataProviderResource",e,t)}},3168:function(e,t,r){"use strict";var n=r(0),o=r(5041),i=r.n(o),a=r(6),s=r(233),c=r(371),u=r(300),l=r(30);function d(e){return Object(n.__assign)({__type:"GetAccessTokenForDataProviderRequest:#Exchange"},e)}function f(e,t){return void 0===e||e.__type||(e=d(e)),Object(l.a)("GetAccessTokenforDataProvider",e,t)}function h(e,t,r){return Object(n.__awaiter)(this,void 0,void 0,(function(){var o,i,a,s;return Object(n.__generator)(this,(function(n){switch(n.label){case 0:return o=d({DataProviderType:e,ResourceUrl:t,IsGroupRequest:!1}),i=r?"getAccessTokenForDataProvider_"+r:"getAccessTokenForDataProvider",(a=new Headers).append("X-OWA-ActionName",i),[4,f(o,{headers:a,datapoint:{customData:{actionSource:r},headersCustomData:function(e){return{tokenResultDetails:e.get("x-tokenresult")}},jsonCustomData:function(e){return{tokenStatus:e.TokenResultCode.toString()}}},returnFullResponseOnSuccess:!0})];case 1:return[4,(s=n.sent()).json()];case 2:return[2,{token:n.sent(),response:s}]}}))}))}var v="onedrive_implicit.access",b="Bearer ",p=r(33),O=function(e,t,r){return Object(n.__assign)({resultCode:t,isAdalException:r,_typeSpec:"TokenRetrievalError"},e)},m=function(e){return"TokenRetrievalError"===e._typeSpec},_=[],w={},j=1,g=30,k="",y="Microsoft.IdentityModel.Clients.ActiveDirectory.AdalServiceException";function S(e){w[e]=null}function T(e,t,r){return Object(n.__awaiter)(this,void 0,void 0,(function(){var o;return Object(n.__generator)(this,(function(n){switch(n.label){case 0:return[4,h(e,t,r)];case 1:return o=n.sent(),function(e,t,r){_=_.filter((function(e){return e!==t}));var n=r.token;if(0!==n.TokenResultCode||!n.AccessToken||""===n.AccessToken){var o="Access token request failed for token key "+e+" with response code "+n.TokenResultCode,i=r.response.headers.get("x-tokenresult"),a=null!=i&&i.indexOf(y)>0;throw O(new Error(o),n.TokenResultCode,a)}var s=w[e]||{};s[t]=n,w[e]=s}(e,t,o),[2,o.token]}}))}))}function R(e,t,r){return Object(n.__awaiter)(this,void 0,void 0,(function(){var o,i;return Object(n.__generator)(this,(function(n){return o=k,0===e&&r&&(i=Object(u.parse)(r),o=Object(a.c)("{0}//{1}/",i.protocol,i.hostname)),Object(p.i)("doc-attachment-testAuthFallback")?[2,""]:[2,x(e,o,t,null)]}))}))}function P(e,t,r){return Object(n.__awaiter)(this,void 0,void 0,(function(){return Object(n.__generator)(this,(function(n){return[2,x(0,e,t,r)]}))}))}function x(e,t,r,o){return Object(n.__awaiter)(this,void 0,void 0,(function(){var a,s;return Object(n.__generator)(this,(function(n){switch(n.label){case 0:return r||!function(e,t){var r=w[e];if(!r)return!1;var n=r[t];if(!n||!n.AccessTokenExpiry)return!1;var o=new Date(n.AccessTokenExpiry),a=i()(new Date(Date.now()),j);return null!=o&&a<o}(e,t)?[3,1]:(a=w[e],s=a[t],i()(new Date(Date.now()),g)>new Date(s.AccessTokenExpiry)&&-1===_.indexOf(t)&&(_.push(t),T(e,t,o)),[2,s.AccessToken]);case 1:return[4,T(e,t,o)];case 2:return[2,(s=n.sent()).AccessToken]}}))}))}function N(e,t,r){return Object(n.__awaiter)(this,void 0,void 0,(function(){var o;return Object(n.__generator)(this,(function(n){switch(n.label){case 0:return Object(s.a)()&&1===e?[4,Object(c.getDelegationTokenForOwa)(v)]:[3,2];case 1:return o=n.sent(),[3,4];case 2:return[4,R(e,t,r)];case 3:o=n.sent(),n.label=4;case 4:return[2,b+o]}}))}))}r.d(t,"d",(function(){return N})),r.d(t,"c",(function(){return R})),r.d(t,"e",(function(){return P})),r.d(t,"b",(function(){return S})),r.d(t,"f",(function(){return m})),r.d(t,"a",(function(){return b}))},3242:function(e,t,r){"use strict";r.d(t,"d",(function(){return n})),r.d(t,"a",(function(){return o})),r.d(t,"b",(function(){return i})),r.d(t,"e",(function(){return a})),r.d(t,"c",(function(){return s}));var n="POST",o="cors",i="GET",a="PUT",s="PATCH"},4328:function(e,t,r){var n=r(1874);e.exports=function(e,t){var r=n(e).getTime(),o=Number(t);return new Date(r+o)}},5041:function(e,t,r){var n=r(4328),o=6e4;e.exports=function(e,t){var r=Number(t);return n(e,r*o)}},5483:function(e,t,r){"use strict";r.d(t,"a",(function(){return h}));var n=r(0),o=r(114),i=r(3168),a=r(218),s=r(2564),c=r(2961),u=r(33),l=r(23),d=r(6855),f=r(3242);function h(e,t,r,a,s){return Object(n.__awaiter)(this,void 0,void 0,(function(){var c;return Object(n.__generator)(this,(function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,Object(i.d)(e,!1,r)];case 1:return c=n.sent(),[3,3];case 2:return n.sent(),[3,3];case 3:return Object(u.i)("doc-authContext")&&0===e&&(s?s["x-ms-cc"]="t":s={"x-ms-cc":"t"}),c&&c.split(i.a)[1]?(Object(o.r)("fetchServiceViaDataProvider",[e]),l.g.info("fetchServiceViaDataProvider"),[4,v(t,c,a,s)]):[3,5];case 4:return[2,n.sent()];case 5:Object(o.r)("fetchServiceFailedToGetToken",[e]),n.label=6;case 6:return 0!==e?[3,8]:(Object(o.r)("fetchServiceViaOWAServer"),l.g.info("fetchServiceViaOWAServer"),[4,b(e,t,a,s)]);case 7:return[2,n.sent()];case 8:throw new Error("Fetch service has failed to retrieve client token.")}}))}))}function v(e,t,r,i){return Object(n.__awaiter)(this,void 0,void 0,(function(){var s,c,l,f,h,v,b,p;return Object(n.__generator)(this,(function(n){switch(n.label){case 0:return s=r.datapointNamePrefix+"DataProvider",c=new o.b(s),l={Authorization:t,"Content-Type":"application/json",Accept:"application/json"},i&&Object.keys(i).forEach((function(e){l[e]=i[e]})),[4,fetch(e,{method:r.method,mode:r.mode,headers:l,body:r.body})];case 1:return f=n.sent(),Object(a.a)(f.status)?(c.end(),[4,f.json()]):[3,3];case 2:return h=n.sent(),[2,JSON.stringify(h)];case 3:return v=new Error(s+" : Response status = "+f.status+", body = "+f.body),c.endWithError("ServerError",v),b={datapointName:s,responseStatus:f.status,responseBody:f.body,headers:f.headers},Object(u.i)("doc-authContext")?(p=f.headers.get("www-authenticate"),[4,d.a.import()]):[3,6];case 4:return[4,n.sent()(p)];case 5:n.sent(),n.label=6;case 6:throw JSON.stringify(b)}}))}))}function b(e,t,r,i){return Object(n.__awaiter)(this,void 0,void 0,(function(){var u,l,d,h,v,b;return Object(n.__generator)(this,(function(n){switch(n.label){case 0:return u=r.datapointNamePrefix+"OWA",l=new o.b(u),d=Object(s.a)({ProviderType:e,Url:t,Method:r.method,Body:r.body?r.body:JSON.stringify({}),Headers:JSON.stringify(i),IsJsonPost:r.method===f.d}),[4,Object(c.a)(d)];case 1:if(h=n.sent(),Object(a.a)(h.Status))return l.end(),[2,h.Body];throw v=new Error(u+" : Response status = "+h.Status+", ServerTraceLog = "+h.ServerTraceLog),l.endWithError("ServerError",v),b={datapointName:u,responseStatus:h.Status,responseServerTraceLog:h.ServerTraceLog},JSON.stringify(b)}}))}))}},6855:function(e,t,r){"use strict";r.d(t,"a",(function(){return i}));var n=r(36),o=new n.c((function(){return r.e(321).then(r.bind(null,11180))})),i=new n.b(o,(function(e){return e.launchRemediateAuthDialogAndRefresh}));new n.b(o,(function(e){return e.remediateAuth}))}}]);
//# sourceMappingURL=owa.MailBoot~AttachmentFileProviderFolderPicker~AttachmentModelStore~AttachmentOps~AttachmentPreviewSxS~~d642b683.js.map
self.scriptsLoaded['owa.MailBoot~AttachmentFileProviderFolderPicker~AttachmentModelStore~AttachmentOps~AttachmentPreviewSxS~~d642b683.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.MailBoot~AttachmentFileProviderFolderPicker~AttachmentModelStore~AttachmentOps~AttachmentPreviewSxS~~d642b683.js'] = (new Date()).getTime();