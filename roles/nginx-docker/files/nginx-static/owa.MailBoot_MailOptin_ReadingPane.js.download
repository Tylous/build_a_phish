self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.MailBoot~MailOptin~ReadingPane.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[258],{1635:function(e,n,t){"use strict";function r(e){if(!e)return null;var n=e.lastIndexOf(".");return n>0?e.substr(n).toLowerCase():null}function i(e){var n=r(e);return n?n.replace(".",""):null}function u(e){var n;return(null===(n=i(e))||void 0===n?void 0:n.substring(0,4))||""}t.d(n,"a",(function(){return r})),t.d(n,"b",(function(){return i})),t.d(n,"c",(function(){return u}))},1638:function(e,n,t){"use strict";var r;t.d(n,"a",(function(){return r})),function(e){e[e.Base64InlineImage=0]="Base64InlineImage",e[e.Cloud=1]="Cloud",e[e.Local=2]="Local",e[e.MailItem=3]="MailItem",e[e.Uri=4]="Uri",e[e.AttachmentItem=5]="AttachmentItem",e[e.CloudSuggestion=6]="CloudSuggestion",e[e.AttachmentItemSuggestion=7]="AttachmentItemSuggestion",e[e.Inline=8]="Inline",e[e.Smime=9]="Smime",e[e.FilesHub=10]="FilesHub",e[e.GroupFilesHub=11]="GroupFilesHub",e[e.MailSearchFileSuggestion=12]="MailSearchFileSuggestion",e[e.Unknown=13]="Unknown",e[e.ContextualSuggestion=14]="ContextualSuggestion",e[e.ConsumerGroupFilesHub=15]="ConsumerGroupFilesHub",e[e.SmartDoc=16]="SmartDoc",e[e.ExpirableBase64InlineImage=17]="ExpirableBase64InlineImage"}(r||(r={}))},1654:function(e,n,t){"use strict";var r=t(1635),i=t(1823),u=t(6);function o(e){var n;return e>=1073741824?(e/=1073741824,n=Object(u.b)(i.b)):e>=1048576?(e/=1048576,n=Object(u.b)(i.d)):e>=1024?(e/=1024,n=Object(u.b)(i.c)):n=Object(u.b)(i.a),Object(u.c)(n,Math.round(e))}var a,c=t(1694),d=t(33),s=[".pdf",".doc",".docx",".odt",".rtf",".ppt",".pptx",".pptm",".potx",".potm",".pot",".ppxx",".pps",".odp"];function f(e){if(!Object(d.i)("doc-attachment-documentThumbnail"))return!1;var n=Object(r.a)(e);return!!n&&s.indexOf(n.toLowerCase())>=0}function l(e){switch(e){case".doc":case".docm":case".docx":case".dot":case".dotm":case".dotx":case".odt":case".rtf":return a.Word;case".csv":case".ods":case".xls":case".xlsb":case".xlsm":case".xlsx":return a.Excel;case".odp":case".pot":case".potm":case".potx":case".pps":case".ppsm":case".ppsx":case".ppt":case".pptm":case".pptx":return a.PowerPoint;default:return null}}!function(e){e[e.Word=0]="Word",e[e.Excel=1]="Excel",e[e.PowerPoint=2]="PowerPoint"}(a||(a={}));var m=t(1665);t.d(n,"b",(function(){return r.a})),t.d(n,"c",(function(){return r.b})),t.d(n,"d",(function(){return r.c})),t.d(n,"i",(function(){return o})),t.d(n,"g",(function(){return c.a})),t.d(n,"h",(function(){return f})),t.d(n,"f",(function(){return l})),t.d(n,"e",(function(){return m.b})),t.d(n,"a",(function(){return a}))},1665:function(e,n,t){"use strict";function r(e){return n=e||"",(t=u.exec(n))&&t.length>1&&i[t[1].toLowerCase()];var n,t}t.d(n,"a",(function(){return r})),t.d(n,"b",(function(){return o}));var i={"image/bmp":".bmp","image/x-ms-bmp":".bmp","image/gif":".gif","image/jpeg":".jpeg","image/png":".png","image/vnd.adobe.photoshop":".psd","image/tiff":".tiff"},u=/^\s*([^;\s]*)(?:;|\s|$)/;function o(e){var n="";return Object.entries(i).forEach((function(t){t[1]===e&&(n=t[0])})),n}},1694:function(e,n,t){"use strict";t.d(n,"a",(function(){return c})),t.d(n,"b",(function(){return d}));var r=t(1635),i=t(1665),u=t(89),o=[".bmp",".gif",".jpe",".jpeg",".jpg",".jfif",".dib",".png",".psd"],a=[".tiff",".tif"];function c(e,n,t){return void 0===t&&(t=!0),d(Object(r.a)(e)||Object(i.a)(n),t)}function d(e,n){return void 0===n&&(n=!0),!!e&&(o.indexOf(e.toLowerCase())>=0||n&&a.indexOf(e.toLowerCase())>=0&&(Object(u.e)()||Object(u.d)()||Object(u.h)()||Object(u.g)()&&!Object(u.l)()))}},1703:function(e,n,t){"use strict";var r=new RegExp("^data:(image\\/\\w+);base64,([A-Za-z0-9+/=]+?)$","i");function i(e){var n=null,t=r.exec(e);if(t){var i=t[1],u=t[2],o=null;try{o=atob(u)}catch(e){}if(o){for(var a=new ArrayBuffer(o.length),c=new Uint8Array(a),d=0;d<o.length;d++)c[d]=o.charCodeAt(d);n=new File([a],"image.png",{type:i})}}return n}var u=t(1638),o=t(1654);function a(e){return e.map((function(e){return{fileType:u.a.Uri,name:e.name,type:Object(o.b)(e.url)||"",size:0,uri:e.url}}))}var c=t(23);function d(e,n,t){if(e.length!=n.length)return c.d("The sizes of subjects and latestItemIds are different"),null;for(var r=[],i=0;i<e.length;i++){var o={fileType:u.a.MailItem,name:e[i],size:(null==t?void 0:t[i])||0,itemId:n[i]};r.push(o)}return r}function s(e,n,t){var r=[],i={fileType:u.a.MailItem,name:e,size:t||0,mimeContent:n};return r.push(i),r}function f(e){if(!e)return null;for(var n=[],t=0;t<e.length;t++){var r=e[t],i={fileType:u.a.Local,name:r.name,size:r.size,type:r.type,fileObject:r};n.push(i)}return n}function l(e){if(!e)return null;for(var n=[],t=0;t<e.length;t++){var r=e[t],i={fileType:r.fileType,name:r.name,size:r.size,type:r.type,dataUri:r.dataUri};n.push(i)}return n}function m(e){var n,t;return null===e?null:{fileType:u.a.Cloud,name:e.Name,size:e.Size,providerId:e.AttachmentProviderId,providerType:e.ProviderType,location:e.Location,providerEndpointUrl:e.ProviderEndpointUrl,isFolder:1===e.Type,fileId:e.Id,fileParentId:e.ParentId,thumbnailUrl:(null===(n=e.Thumbnail)||void 0===n?void 0:n.Url)||"",previewUrl:(null===(t=e.Preview)||void 0===t?void 0:t.Url)||"",type:e.MimeType}}function p(e){return null===e?null:{attachmentItemId:e.Id,name:e.Name,size:e.Size,fileType:u.a.AttachmentItem,type:"ItemIdAttachment:#Exchange"}}var b={BOX:"Box",DROPBOX:"Dropbox",FACEBOOK:"Facebook",GDRIVE:"GDrive",MAILBOX:"Mailbox",ONE_DRIVE_CONSUMER:"OneDriveConsumer",ONE_DRIVE_PRO:"OneDrivePro",RECENT_ATTACHMENTS:"RecentAttachments",WOPI:"Wopi",WOPI_BOX:"WopiBox",WOPI_EGNYTE:"WopiEgnyte"};function v(e){switch(e?e.toLowerCase():null){case b.ONE_DRIVE_PRO.toLowerCase():return 0;case b.GDRIVE.toLowerCase():return 5;case b.ONE_DRIVE_CONSUMER.toLowerCase():return 1;case b.DROPBOX.toLowerCase():return 2;case b.BOX.toLowerCase():return 3;case b.WOPI_BOX.toLowerCase():return 7;case b.WOPI_EGNYTE.toLowerCase():return 8;case b.MAILBOX.toLowerCase():return 4;case b.FACEBOOK.toLowerCase():return 6;default:return null}}t.d(n,"f",(function(){return i})),t.d(n,"j",(function(){return a})),t.d(n,"i",(function(){return d})),t.d(n,"h",(function(){return s})),t.d(n,"g",(function(){return f})),t.d(n,"d",(function(){return l})),t.d(n,"e",(function(){return m})),t.d(n,"c",(function(){return p})),t.d(n,"b",(function(){return v})),t.d(n,"a",(function(){return u.a}))},1715:function(e,n,t){"use strict";t.d(n,"q",(function(){return u})),t.d(n,"z",(function(){return o})),t.d(n,"d",(function(){return a})),t.d(n,"u",(function(){return c})),t.d(n,"x",(function(){return d})),t.d(n,"y",(function(){return s})),t.d(n,"w",(function(){return f})),t.d(n,"v",(function(){return l})),t.d(n,"e",(function(){return m})),t.d(n,"f",(function(){return p})),t.d(n,"h",(function(){return b})),t.d(n,"m",(function(){return v})),t.d(n,"A",(function(){return g})),t.d(n,"r",(function(){return w})),t.d(n,"j",(function(){return O})),t.d(n,"s",(function(){return h})),t.d(n,"t",(function(){return I})),t.d(n,"a",(function(){return C})),t.d(n,"l",(function(){return x})),t.d(n,"p",(function(){return E})),t.d(n,"i",(function(){return j})),t.d(n,"b",(function(){return A})),t.d(n,"n",(function(){return y})),t.d(n,"c",(function(){return T})),t.d(n,"g",(function(){return P})),t.d(n,"o",(function(){return S})),t.d(n,"k",(function(){return R}));var r=t(36),i=new r.c((function(){return Promise.all([t.e(0),t.e(1),t.e(2),t.e(3),t.e(4),t.e(5),t.e(6),t.e(21),t.e(20),t.e(25),t.e(28),t.e(43),t.e(60),t.e(85),t.e(119),t.e(150),t.e(205),t.e(204),t.e(481)]).then(t.bind(null,3286))})),u=new r.b(i,(function(e){return e.removeExtensibilityNotification})),o=new r.b(i,(function(e){return e.updatePersistentNotifications})),a=new r.b(i,(function(e){return e.closeTaskPaneAddinCommand})),c=new r.b(i,(function(e){return e.triggerAppointmentTimeChangedEvent})),d=new r.b(i,(function(e){return e.triggerRecipientsChangedEvent})),s=new r.b(i,(function(e){return e.triggerRecurrenceChangedEvent})),f=new r.b(i,(function(e){return e.triggerLocationsChangedEvent})),l=new r.b(i,(function(e){return e.triggerAttachmentsChangedEvent})),m=new r.b(i,(function(e){return e.deinitializeAddinsForItem})),p=new r.b(i,(function(e){return e.initializeAddinsForItem})),b=new r.a(i,(function(e){return e.initializeExtensibilityContext})),v=new r.b(i,(function(e){return e.onHostItemChanged})),g=new r.b(i,(function(e){return e.whenItemHasContextualAddinKeywords})),w=new r.b(i,(function(e){return e.runContextualEvaluationAndUpdate})),O=new r.b(i,(function(e){return e.launchTranslateCommand})),h=new r.b(i,(function(e){return e.setPersistedAddin})),I=new r.b(i,(function(e){return e.shouldForceOnSendCompliantBehavior})),C=(Object(r.d)(i,(function(e){return e.AddinBarView})),Object(r.d)(i,(function(e){return e.TaskPaneCollection}))),x=new r.b(i,(function(e){return e.onComposeClose})),E=new r.b(i,(function(e){return e.openContextualCallout})),j=new r.b(i,(function(e){return e.launchAddinCommand})),A=new r.b(i,(function(e){return e.observeAddinCommandSurfaceItems})),y=new r.b(i,(function(e){return e.onItemNavigation})),T=new r.b(i,(function(e){return e.allowItemSendEvent})),P=new r.a(i,(function(e){return e.ExecuteEntryPoint})),S=new r.a(i,(function(e){return e.onLaunchEventTriggered})),R=new r.a(i,(function(e){return e.logAppTeachingUICalloutTelemetry}))},1823:function(e){e.exports=JSON.parse('{"b":"uub","d":"vub","c":"wub","a":"xub"}')},3795:function(e,n,t){"use strict";var r=t(1657),i=t(36),u=t(8329),o=t(6),a=t(6421);var c=t(2366);function d(e){if(!e)return!1;if(function(e){return null!=e.RightsManagementLicenseData}(e))return!1;if(e.IsDraft)return!1;if(Object(c.a)()&&e.MailboxInfo&&"GroupMailbox"===e.MailboxInfo.type)return!1;var n=e.ItemClass.toLowerCase();return!function(e){return 0==e.indexOf("ipm.note.smime")&&-1==e.indexOf("ipm.note.smime.multipartsigned")}(n)&&!function(e){return 0==e.indexOf("report")}(n)}var s=t(146),f=t(203),l=t(114),m=t(873),p="ows/api/beta/Addins/PinAddins";function b(){var e=Object(f.a)(),n=new l.b("ExtPinRequest");Object(s.d)(p,{correlationId:e,defaults:Object(m.d)()[m.b.SurfaceActions]},e,!0).then((function(t){n.addCustomData([e,t.status]),200==t.status&&t.text().then((function(e){m.f.importAndExecute(m.b.SurfaceActions,JSON.parse(e))})),n.end()})).catch((function(){n.end()}))}var v,g,w=t(0),O=t(1751),h=t(17);!function(e){e[e.None=0]="None",e[e.Compose=1]="Compose",e[e.Read=2]="Read"}(g||(g={}));var I=((v={})[g.None]="NoAddins",v[g.Compose]="ComposeAddinOnly",v[g.Read]="ReadAddinOnly",v[g.Compose|g.Read]="BothAddins",v);function C(e){var n=JSON.parse(e);return{addinId:n.id,commandId:n.controlId}}function x(){return Object(w.__awaiter)(this,void 0,void 0,(function(){var e,n,t,i,u,o,a;return Object(w.__generator)(this,(function(c){switch(c.label){case 0:return e=Object(h.a)().ViewStateConfiguration,[4,r.I.import()];case 1:return n=c.sent(),t=g.None,(i=e.PinnedComposeAddin)&&(u=C(i),n(O.a.MessageCompose,u),t|=g.Compose),(o=e.PinnedReadAddin)&&(a=C(o),n(O.a.MessageRead,a),t|=g.Read),Object(l.r)("ExtPersistedAddinMigration",[I[t]]),[2]}}))}))}var E=t(233);function j(e,n){return void 0===n&&(n=null),Object(w.__awaiter)(this,void 0,void 0,(function(){return Object(w.__generator)(this,(function(t){switch(t.label){case 0:return!Object(E.a)()?[4,r.D.import()]:[3,2];case 1:t.sent()(e,n),t.label=2;case 2:return[2]}}))}))}var A=t(1695);function y(){Object(A.f)()?j(r.h.NotSupported):j(r.h.Empty)}t.d(n,"b",(function(){return P})),t.d(n,"a",(function(){return S})),t.d(n,"e",(function(){return d})),t.d(n,"c",(function(){return b})),t.d(n,"d",(function(){return x})),t.d(n,"f",(function(){return j})),t.d(n,"g",(function(){return y}));var T=new i.c((function(){return Promise.all([t.e(0),t.e(1),t.e(2),t.e(3),t.e(4),t.e(5),t.e(6),t.e(21),t.e(20),t.e(25),t.e(28),t.e(43),t.e(60),t.e(85),t.e(119),t.e(150),t.e(205),t.e(204),t.e(481)]).then(t.bind(null,17201))})),P=new i.b(T,(function(e){return e.createMailReadAdapter})),S=new i.b(T,(function(e){return e.createMailComposeAdapter}));r.i.sendFeedback=function(){var e=[{Name:Object(o.b)(u.a),EmailAddress:"outlookinclientstorefeedback@service.microsoft.com"}];a.a(e,[],[],Object(o.b)(u.c),Object(o.b)(u.b),[])}},5612:function(e,n,t){"use strict";t.d(n,"a",(function(){return a}));var r=t(0),i=t(1657),u=t(1703),o=t(1654);function a(e){var n,t,a=[];try{for(var c=Object(r.__values)(e),d=c.next();!d.done;d=c.next()){var s=d.value,f=null;s.attachmentType==i.a.Item?f={fileType:u.a.MailItem,name:s.name,size:s.size,itemId:s.id}:s.attachmentType==i.a.File&&(f={fileType:u.a.Uri,name:s.name,size:s.size,uri:s.id,type:Object(o.b)(s.id)}),f&&a.push({file:f,isInline:s.isInline})}}catch(e){n={error:e}}finally{try{d&&!d.done&&(t=c.return)&&t.call(c)}finally{if(n)throw n.error}}return a}},6421:function(e,n,t){"use strict";t.d(n,"a",(function(){return u}));var r=t(5612),i=t(1762);function u(e,n,t,u,o,a){var c={operation:0,bodyType:"HTML",subject:u,newContent:o,to:e,cc:n,bcc:t,preferAsyncSend:!0,attachmentFilesToUpload:Object(r.a)(a)};i.m.importAndExecute(c,2)}},8329:function(e){e.exports=JSON.parse('{"a":"tYb","c":"uYb","b":"vYb"}')}}]);
//# sourceMappingURL=owa.MailBoot~MailOptin~ReadingPane.js.map
self.scriptsLoaded['owa.MailBoot~MailOptin~ReadingPane.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.MailBoot~MailOptin~ReadingPane.js'] = (new Date()).getTime();