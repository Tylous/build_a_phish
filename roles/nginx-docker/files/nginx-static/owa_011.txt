self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.MailBoot~Folders.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[238],{17269:function(e,n,i){"use strict";i.r(n);var t=i(0),a=i(5889),r=i(2781),d=i(6755),s=i(6756),o=i(4290),l=i(65);var u=i(2454),c=i(17);function m(){var e=Object(u.b)();return e||Object(c.a)().SessionSettings.UserEmailAddress}var v=i(114),k=i(2),b=i(1637),f=i(6754),p=i(4612),N=i(5229),g=i(708),F=i(5890),O={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"FoldersReplicaList"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"ids"}},type:{kind:"NonNullType",type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"mailboxInfo"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"MailboxInfoInput"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"folders"},arguments:[{kind:"Argument",name:{kind:"Name",value:"ids"},value:{kind:"Variable",name:{kind:"Name",value:"ids"}}},{kind:"Argument",name:{kind:"Name",value:"options"},value:{kind:"ObjectValue",fields:[{kind:"ObjectField",name:{kind:"Name",value:"mailboxInfo"},value:{kind:"Variable",name:{kind:"Name",value:"mailboxInfo"}}},{kind:"ObjectField",name:{kind:"Name",value:"additionalProperties"},value:{kind:"ListValue",values:[{kind:"StringValue",value:"ReplicaList",block:!1}]}}]}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"FolderId"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"Id"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"ReplicaList"},arguments:[],directives:[]}]}}]}}]};function j(e,n){return Object(t.__awaiter)(this,void 0,void 0,(function(){var i;return Object(t.__generator)(this,(function(t){switch(t.label){case 0:return[4,Object(g.a)()];case 1:i=t.sent(),t.label=2;case 2:return t.trys.push([2,4,,5]),[4,i.query({query:O,variables:{ids:e,mailboxInfo:n}})];case 3:return[2,t.sent().data.folders];case 4:return t.sent(),[2,null];case 5:return[2]}}))}))}Object(k.orchestrator)(r.b,(function(e){return Object(t.__awaiter)(void 0,void 0,void 0,(function(){var n,i,r,u,c,k,O,y;return Object(t.__generator)(this,(function(S){switch(S.label){case 0:return(n=Object(d.a)(b.d))===o.a.Loading||n===o.a.Loaded&&!e.isLoadingMore?[2]:(Object(a.a)(b.d,o.a.Loading),r=Object(s.a)(b.d),u=Object(p.a)(b.d,!1),[4,Promise.all([Object(g.a)(),N.a.import()])]);case 1:c=t.__read.apply(void 0,[S.sent(),2]),k=c[0],O=c[1],S.label=2;case 2:return S.trys.push([2,4,,5]),[4,k.query({query:O,variables:{baseFolderDistinguishedIds:[b.d],indexedPageOffset:r,mailboxInfo:{userIdentity:u.userIdentity,mailboxSmtpAddress:u.mailboxSmtpAddress,type:u.type},shouldPopulateChildFolderIds:!1}})];case 3:return y=S.sent(),i=y.data.folderHierarchy,[3,5];case 4:return S.sent(),Object(a.a)(b.d,o.a.ErrorLoading),[2];case 5:return Object(F.a)(i.RootFolder,i.Folders,b.d,m(),Object(l.h)().SessionSettings.ArchiveDisplayName,b.d,null,i.IncludesLastItemInRange,i.IndexedPagingOffset),h=i.RootFolder,_=i.Folders,Object(l.a)(h.DistinguishedFolderId,h.FolderId.Id),_.filter((function(e){return e.DistinguishedFolderId&&e.ParentFolderId.Id==h.FolderId.Id})).forEach((function(e){return Object(l.a)(e.DistinguishedFolderId,e.FolderId.Id)})),0===r&&(Object(f.a)(),I=e.source,Object(v.r)("Triage_LoadArchiveMailboxFolders",[I])),function(e,n){Object(t.__awaiter)(this,void 0,void 0,(function(){var i;return Object(t.__generator)(this,(function(t){switch(t.label){case 0:return 0==e.length?[2]:[4,j(e,n)];case 1:return(i=t.sent())&&i.forEach((function(e){(null==e?void 0:e.ReplicaList)&&Object(f.c)(e.FolderId.Id,e.ReplicaList)})),[2]}}))}))}(i.Folders.map((function(e){return e.FolderId.Id})),u),[2]}var I,h,_}))}))}));Object(k.orchestrator)(f.a,(function(){return Object(t.__awaiter)(void 0,void 0,void 0,(function(){var e,n,i,a,r,d,s;return Object(t.__generator)(this,(function(o){switch(o.label){case 0:return e=Object(p.a)(b.b,!1),[4,Promise.all([Object(g.a)(),N.a.import()])];case 1:n=t.__read.apply(void 0,[o.sent(),2]),i=n[0],a=n[1],o.label=2;case 2:return o.trys.push([2,4,,5]),[4,i.query({query:a,variables:{baseFolderDistinguishedIds:[b.b],mailboxInfo:{userIdentity:e.userIdentity,mailboxSmtpAddress:e.mailboxSmtpAddress,type:e.type}}})];case 3:return d=o.sent(),r=d.data.folderHierarchy,[3,5];case 4:return o.sent(),[2];case 5:return Object(f.b)(r.RootFolder,r.Folders,m()),s=r.RootFolder,Object(l.a)(s.DistinguishedFolderId,s.FolderId.Id),[2]}}))}))}));var y=i(9187),S=i(23),I=i(44);Object(k.orchestrator)(r.c,(function(e){return Object(t.__awaiter)(void 0,void 0,void 0,(function(){var n,i,a,d;return Object(t.__generator)(this,(function(t){switch(t.label){case 0:n=e.folderId,t.label=1;case 1:return t.trys.push([1,3,,4]),[4,Object(y.b)(n)];case 2:return i=t.sent(),[3,4];case 3:throw a=t.sent(),Object(r.d)(),a;case 4:return i?(d=i.PermissionSet.Permissions,Object(r.i)(n,d),Object(r.e)(),function(e){var n=e.length;Object(v.r)("Triage_FolderPermissions_Load",[Object(I.e)({value:n})])}(d)):(Object(r.d)(),S.d("Get folder permission server call returned with no matching folders.")),[2]}}))}))}));var h=i(2119);function _(e,n){return!e&&!n||!(!e||!n)&&(e.length===n.length&&!e.some((function(e,i){return!P(e,n[i])})))}function P(e,n){return!e&&!n||!(!e||!n)&&!Object.keys(e).some((function(i){if("UserId"===i){var t=e[i];return t.PrimarySmtpAddress?t.PrimarySmtpAddress!==n[i].PrimarySmtpAddress:t.DistinguishedUser!==n[i].DistinguishedUser}return e[i]!==n[i]}))}var D=i(6753),V=i(5616),w={kind:"Document",definitions:Object(t.__spread)([{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"UpdateFolderPermissions"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"id"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"permissionSet"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"PermissionsInput"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"mailboxInfo"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"MailboxInfoInput"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"updateFolderPermissions"},arguments:[{kind:"Argument",name:{kind:"Name",value:"input"},value:{kind:"ObjectValue",fields:[{kind:"ObjectField",name:{kind:"Name",value:"id"},value:{kind:"Variable",name:{kind:"Name",value:"id"}}},{kind:"ObjectField",name:{kind:"Name",value:"permissionSet"},value:{kind:"Variable",name:{kind:"Name",value:"permissionSet"}}},{kind:"ObjectField",name:{kind:"Name",value:"mailboxInfo"},value:{kind:"Variable",name:{kind:"Name",value:"mailboxInfo"}}}]}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"FragmentSpread",name:{kind:"Name",value:"MailFolderPermissionsFragment"},directives:[]}]}}]}}],V.a.definitions)};Object(k.orchestrator)(r.g,(function(e){return Object(t.__awaiter)(void 0,void 0,void 0,(function(){var n,i,a,d,s,o,l;return Object(t.__generator)(this,(function(u){switch(u.label){case 0:if(n=e.folderId,i=e.permissions,a=e.mailboxInfo,d=Object(h.a)().get(n),_(null===(l=d.PermissionSet)||void 0===l?void 0:l.Permissions,i))return Object(r.j)(),[2];u.label=1;case 1:return u.trys.push([1,3,,4]),[4,x.invokeUpdateFolderPermissionsMutation(n,{Permissions:i},a)];case 2:return s=u.sent(),[3,4];case 3:return o=u.sent(),Object(r.h)(),S.d("Update folder permission on server call failed with error "+o),[2];case 4:return s?(Object(r.i)(n,i),Object(r.j)(),function(e){var n,i,a=e.length,r={};e.forEach((function(e){var t=e.PermissionLevel,a=e.UserId;"Default"===a.DistinguishedUser?n=e:"Anonymous"===a.DistinguishedUser&&(i=e),r[t]||(r[t]=0),r[t]+=1})),Object(v.r)("Triage_FolderPermissions_Edit",Object(t.__assign)({owa_1:Object(I.e)({value:a}),owa_2:n.PermissionLevel,owa_3:i.PermissionLevel},r))}(i)):(Object(r.h)(),S.d("Update folder permission on server call failed")),[2]}}))}))}));var x={invokeUpdateFolderPermissionsMutation:function(e,n,i){return Object(t.__awaiter)(this,void 0,void 0,(function(){var a,r;return Object(t.__generator)(this,(function(d){switch(d.label){case 0:return a=Object(D.a)(e),r=function(e){var n;return{Permissions:null===(n=e.Permissions)||void 0===n?void 0:n.map((function(e){return function(e){var n=Object(t.__assign)({},e);if(delete n.__typename,n.UserId){var i=Object(t.__assign)({},n.UserId);delete i.__typename,n.UserId=i}return n}(e)}))}}(n),[4,Object(g.a)()];case 1:return[4,d.sent().mutate({variables:{id:a.Id,permissionSet:r,mailboxInfo:i},mutation:w})];case 2:return[2,!!d.sent().data.updateFolderPermissions]}}))}))}};Object(k.mutator)(r.i,(function(e){var n=e.folderId,i=function(e){return e.map((function(e){return Object(t.__assign)(Object(t.__assign)({},e),{IsFolderContact:!0===e.IsFolderContact})}))}(e.permissions),a=Object(h.a)().get(n);a&&(a.PermissionSet?a.PermissionSet.Permissions=i:a.PermissionSet={Permissions:i})})),Object(k.mutator)(f.c,(function(e){var n=Object(h.a)().get(e.folderId);n&&(n.ReplicaList=e.replicaList,n.mailboxInfo.auxiliaryMailboxGuid=e.replicaList[0])}));var T=i(7061),A=i(5617),L=i(4035);function U(e){return Object(t.__awaiter)(this,void 0,void 0,(function(){var n,i,a,r;return Object(t.__generator)(this,(function(d){switch(d.label){case 0:return n=Object(s.a)(b.j),[4,Promise.all([Object(g.a)(),N.b.import()])];case 1:return i=t.__read.apply(void 0,[d.sent(),2]),a=i[0],r=i[1],[4,a.query({query:r,variables:{baseFolderDistinguishedIds:[b.j],indexedPageOffset:n,mailboxInfo:e,foldersToShowFirst:[],shouldShowJunkEmailFolder:Object(L.a)("junkemail"),shouldShowNotesFolder:Object(L.a)("notes"),shouldPopulateChildFolderIds:!1}})];case 2:return[2,d.sent().data.folderHierarchy]}}))}))}i.d(n,"getArchiveFolders",(function(){return r.b})),i.d(n,"getFolderPermissions",(function(){return r.c})),i.d(n,"updateFolderPermissions",(function(){return r.g})),i.d(n,"updateFolderPermissionsInStore",(function(){return r.i})),i.d(n,"getSharedFolders",(function(){return T.a})),i.d(n,"arePermissionArraysEqual",(function(){return _})),i.d(n,"arePermissionsEqual",(function(){return P})),i.d(n,"updateFolder",(function(){return A.a})),i.d(n,"fetchPrimaryMailFolders",(function(){return U}))},2454:function(e,n,i){"use strict";i.d(n,"b",(function(){return d})),i.d(n,"a",(function(){return s}));var t=i(37),a=i(31),r=i(65);function d(){var e=Object(t.a)("targetServer"),n="DefaultAnchorMailbox"+(e?"_"+e.toLocaleLowerCase():"");return Object(t.a)(n)}function s(){var e,n,i=(e="",(n=Object(a.a)().pathname.split("/").filter((function(e){return e.length}))).length>=2&&n[1].match(/.+@.+/)&&(e=n[1]),e);if(0===i.length){var t=Object(r.h)();if(null==t?void 0:t.SessionSettings){var s=t.SessionSettings.ExternalDirectoryTenantGuid,o=t.SessionSettings.UserPuid;o&&s&&(i="PUID:"+o+"@"+s)}}return 0===i.length&&(i=d()),i}},3142:function(e,n,i){"use strict";i.d(n,"a",(function(){return a}));var t=i(0);function a(e){return Object(t.__assign)({__type:"UpdateFolderRequest:#Exchange"},e)}},3177:function(e,n,i){"use strict";var t=i(30),a=i(0);function r(e,n){var i;return void 0===e||e.__type||(i=e,e=Object(a.__assign)({__type:"UpdateFolderJsonRequest:#Exchange"},i)),Object(t.a)("UpdateFolder",e,n)}i.d(n,"a",(function(){return r}))},347:function(e,n,i){"use strict";var t=i(0);function a(e,n){return e?Object(t.__assign)({mailboxInfo:e},n):null!=n?n:void 0}i.d(n,"a",(function(){return a}))},520:function(e,n,i){"use strict";i.d(n,"b",(function(){return r})),i.d(n,"e",(function(){return d})),i.d(n,"d",(function(){return s})),i.d(n,"c",(function(){return o})),i.d(n,"a",(function(){return l}));var t=i(13),a=new t.b((function(){return Promise.all([i.e(37),i.e(50),i.e(104),i.e(151),i.e(486)]).then(i.bind(null,1266))})),r=new t.a(a,(function(e){return e.createApolloClient})),d=new t.a(a,(function(e){return e.wrapInApolloProvider})),s=new t.a(a,(function(e){return e.unblockBootResolvers})),o=new t.a(a,(function(e){return e.getApolloClient})),l=new t.c(a,(function(e){return e.ApolloProvider}))},5229:function(e,n,i){"use strict";i.d(n,"a",(function(){return r})),i.d(n,"b",(function(){return d}));var t=i(13),a=new t.b((function(){return i.e(874).then(i.bind(null,8942))})),r=new t.c(a,(function(e){return e.FolderHierarchyDocument})),d=new t.c(a,(function(e){return e.PrimaryFolderHierarchyDocument}))},5616:function(e,n,i){"use strict";i.d(n,"a",(function(){return t}));var t={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"MailFolderPermissionsFragment"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"MailFolderPermissions"}},directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"PermissionSet"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"Permissions"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"PermissionLevel"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"ReadItems"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"UserId"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"PrimarySmtpAddress"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"DisplayName"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"DistinguishedUser"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"CanCreateItems"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"CanCreateSubFolders"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"IsFolderOwner"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"IsFolderVisible"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"IsFolderContact"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"EditItems"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"DeleteItems"},arguments:[],directives:[]}]}}]}}]}}]}},5617:function(e,n,i){"use strict";i.d(n,"a",(function(){return o}));var t=i(3142),a=i(554),r=i(161),d=i(3177),s=i(347);function o(e,n,i,o){return Object(d.a)({Header:Object(r.b)(),Body:Object(t.a)({FolderChanges:[{Updates:n,FolderId:Object(a.a)({Id:e})}]})},Object(s.a)(i,o)).then((function(e){return e.Body.ResponseMessages.Items[0]}))}},612:function(e,n,i){"use strict";i.d(n,"a",(function(){return s})),i.d(n,"b",(function(){return o})),i.d(n,"c",(function(){return l}));var t=i(0),a=i(520),r=null,d=null;function s(){return u(r),r}function o(){return u(d),d}function l(e){var n=e.lazyResolvers,i=e.lazyLocalStateResolvers,s=e.lazyCreateManagedQueryLink,o=e.context;return r=Promise.all([a.b.import(),n,i,s]).then((function(e){var n=Object(t.__read)(e,4),i=n[0],a=n[1],r=n[2],s=n[3];return d=i({resolvers:a,localStateResolvers:r,createManagedQueryLink:s,context:o})}))}function u(e){if(!e)throw new Error("Apollo client has not been initialized yet.")}},7061:function(e,n,i){"use strict";i.d(n,"a",(function(){return r}));var t=i(2),a=i(65),r=Object(t.action)("GET_SHARED_FOLDERS",(function(e,n,i,t){return t||(t=Object(a.b)()),{sharedUserMailboxSmtpAddress:e,actionSource:n,isLoadingMore:i,userIdentity:t}}))},708:function(e,n,i){"use strict";var t=i(612);i.d(n,"a",(function(){return t.a})),i.d(n,"b",(function(){return t.c}));var a=i(520);i.d(n,"c",(function(){return a.a})),i.d(n,"d",(function(){return a.c})),i.d(n,"e",(function(){return a.d})),i.d(n,"f",(function(){return a.e}))},9187:function(e,n,i){"use strict";var t=i(0),a=i(708),r={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"FolderCounts"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"id"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"mailboxInfo"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"MailboxInfoInput"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"folder"},arguments:[{kind:"Argument",name:{kind:"Name",value:"id"},value:{kind:"Variable",name:{kind:"Name",value:"id"}}},{kind:"Argument",name:{kind:"Name",value:"options"},value:{kind:"ObjectValue",fields:[{kind:"ObjectField",name:{kind:"Name",value:"mailboxInfo"},value:{kind:"Variable",name:{kind:"Name",value:"mailboxInfo"}}},{kind:"ObjectField",name:{kind:"Name",value:"additionalProperties"},value:{kind:"ListValue",values:[{kind:"StringValue",value:"TotalCount",block:!1},{kind:"StringValue",value:"UnreadCount",block:!1}]}}]}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"FolderId"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"Id"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"TotalCount"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"UnreadCount"},arguments:[],directives:[]}]}}]}}]},d=i(5616),s={kind:"Document",definitions:Object(t.__spread)([{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"FolderCountsAndPermissions"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"id"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"mailboxInfo"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"MailboxInfoInput"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"folder"},arguments:[{kind:"Argument",name:{kind:"Name",value:"id"},value:{kind:"Variable",name:{kind:"Name",value:"id"}}},{kind:"Argument",name:{kind:"Name",value:"options"},value:{kind:"ObjectValue",fields:[{kind:"ObjectField",name:{kind:"Name",value:"mailboxInfo"},value:{kind:"Variable",name:{kind:"Name",value:"mailboxInfo"}}},{kind:"ObjectField",name:{kind:"Name",value:"additionalProperties"},value:{kind:"ListValue",values:[{kind:"StringValue",value:"TotalCount",block:!1},{kind:"StringValue",value:"UnreadCount",block:!1},{kind:"StringValue",value:"PermissionSet",block:!1}]}}]}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"FolderId"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"Id"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"TotalCount"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"UnreadCount"},arguments:[],directives:[]},{kind:"FragmentSpread",name:{kind:"Name",value:"MailFolderPermissionsFragment"},directives:[]}]}}]}}],d.a.definitions)},o={kind:"Document",definitions:Object(t.__spread)([{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"FolderPermissions"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"id"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"mailboxInfo"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"MailboxInfoInput"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"folder"},arguments:[{kind:"Argument",name:{kind:"Name",value:"id"},value:{kind:"Variable",name:{kind:"Name",value:"id"}}},{kind:"Argument",name:{kind:"Name",value:"options"},value:{kind:"ObjectValue",fields:[{kind:"ObjectField",name:{kind:"Name",value:"mailboxInfo"},value:{kind:"Variable",name:{kind:"Name",value:"mailboxInfo"}}},{kind:"ObjectField",name:{kind:"Name",value:"additionalProperties"},value:{kind:"ListValue",values:[{kind:"StringValue",value:"PermissionSet",block:!1}]}}]}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"FolderId"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"Id"},arguments:[],directives:[]}]}},{kind:"FragmentSpread",name:{kind:"Name",value:"MailFolderPermissionsFragment"},directives:[]}]}}]}}],d.a.definitions)},l=i(4612);function u(e,n){return c(e,"Permissions",n||Object(l.a)(e,!0))}function c(e,n,i){return Object(t.__awaiter)(this,void 0,void 0,(function(){var d,l;return Object(t.__generator)(this,(function(t){switch(t.label){case 0:return[4,Object(a.a)()];case 1:switch(d=t.sent(),n){case"Counts":l=r;break;case"CountsAndPermissions":l=s;break;case"Permissions":l=o}t.label=2;case 2:return t.trys.push([2,4,,5]),[4,d.query({query:l,variables:{id:e,mailboxInfo:i}})];case 3:return[2,t.sent().data.folder];case 4:return t.sent(),[2,null];case 5:return[2]}}))}))}i.d(n,"b",(function(){return u})),i.d(n,"a",(function(){return c}))}}]);
//# sourceMappingURL=owa.MailBoot~Folders.js.map
self.scriptsLoaded['owa.MailBoot~Folders.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.MailBoot~Folders.js'] = (new Date()).getTime();