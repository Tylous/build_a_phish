self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.MailBoot~AttachmentPreviewSxSInitialize~Attachments~HtmlEditorLinkPlugin~OwaFluidLink~OwaInsertLink~~78567fbf.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[95],{1004:function(e,t,n){"use strict";n.d(t,"c",(function(){return s})),n.d(t,"a",(function(){return l})),n.d(t,"b",(function(){return f}));var r=n(0),a=n(1),i=n(374),o=n(219),u=n(169),c=n(711);function s(e,t){for(var n=[],i=2;i<arguments.length;i++)n[i-2]=arguments[i];var o=e;return o.isSlot?0===(n=a.Children.toArray(n)).length?o(t):o(Object(r.__assign)(Object(r.__assign)({},t),{children:n})):a.createElement.apply(a,Object(r.__spreadArrays)([e,t],n))}function l(e,t){void 0===t&&(t={});var n=t.defaultProp,o=void 0===n?"children":n;return function(t,n,s,l,d){if(a.isValidElement(n))return n;var f=function(e,t){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];for(var a={},o=[],s=0,l=n;s<l.length;s++){var d=l[s];o.push(d&&d.className),Object(c.a)(a,d)}return a.className=Object(i.a)([e,o],{rtl:Object(u.a)(t)}),a}(l,d,t,function(e,t){var n,r;"string"==typeof t||"number"==typeof t||"boolean"==typeof t?((n={})[e]=t,r=n):r=t;return r}(o,n));if(s){if(s.component){var b=s.component;return a.createElement(b,Object(r.__assign)({},f))}if(s.render)return s.render(f,e)}return a.createElement(e,Object(r.__assign)({},f))}}var d=Object(o.c)((function(e){return l(e)}));function f(e,t){var n={},r=e,a=function(e){if(t.hasOwnProperty(e)){var a=function(n){for(var a=[],i=1;i<arguments.length;i++)a[i-1]=arguments[i];if(a.length>0)throw new Error("Any module using getSlots must use withSlots. Please see withSlots javadoc for more info.");return b(t[e],n,r[e],r.slots&&r.slots[e],r._defaultStyles&&r._defaultStyles[e],r.theme)};a.isSlot=!0,n[e]=a}};for(var i in t)a(i);return n}function b(e,t,n,r,a,i){return void 0!==e.create?e.create(t,n,r,a):d(e)(t,n,r,a,i)}},1025:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(0);function a(e){return Object(r.__assign)({__type:"FindItemJsonRequest:#Exchange"},e)}},10265:function(e){e.exports=JSON.parse('{"a":"Kob"}')},10269:function(e){e.exports=JSON.parse('{"a":"Hob"}')},10270:function(e){e.exports=JSON.parse('{"a":"Oob"}')},1056:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(30),a=n(1025);function i(e,t){return void 0===e||e.__type||(e=Object(a.a)(e)),Object(r.a)("FindItem",e,t)}},1057:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(0);function a(e){return Object(r.__assign)({__type:"FindItemRequest:#Exchange"},e)}},1102:function(e){e.exports=JSON.parse('{"a":"emb"}')},1251:function(e,t,n){"use strict";e.exports=function(e,t){return"string"!=typeof e?e:(/^['"].*['"]$/.test(e)&&(e=e.slice(1,-1)),/["'() \t\n]/.test(e)||t?'"'.concat(e.replace(/"/g,'\\"').replace(/\n/g,"\\n"),'"'):e)}},1566:function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var r=n(0),a=n(1),i=n(7),o=n(336),u=n(154),c=n(1004),s=n(711);function l(e,t){void 0===t&&(t={});var n=t.factoryOptions,l=(void 0===n?{}:n).defaultProp,d=function(n){var c,l,d,f=(c=t.displayName,l=a.useContext(o.a),d=t.fields,u.a.getSettings(d||["theme","styles","tokens"],c,l.customizations)),b=t.state;b&&(n=Object(r.__assign)(Object(r.__assign)({},n),b(n)));var v=n.theme||f.theme,p=function e(t,n){for(var a=[],i=2;i<arguments.length;i++)a[i-2]=arguments[i];for(var o={},u=0,c=a;u<c.length;u++){var l=c[u];l&&(l="function"==typeof l?l(t,n):l,Array.isArray(l)&&(l=e.apply(void 0,Object(r.__spreadArrays)([t,n],l))),Object(s.a)(o,l))}return o}(n,v,t.tokens,f.tokens,n.tokens),m=function(e,t,n){for(var r=[],a=3;a<arguments.length;a++)r[a-3]=arguments[a];return i.concatStyleSets.apply(void 0,r.map((function(r){return"function"==typeof r?r(e,t,n):r})))}(n,v,p,t.styles,f.styles,n.styles),h=Object(r.__assign)(Object(r.__assign)({},n),{styles:m,tokens:p,_defaultStyles:m,theme:v});return e(h)};return d.displayName=t.displayName||e.name,l&&(d.create=Object(c.a)(d,{defaultProp:l})),Object(s.a)(d,t.statics),d}},1638:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.Base64InlineImage=0]="Base64InlineImage",e[e.Cloud=1]="Cloud",e[e.Local=2]="Local",e[e.MailItem=3]="MailItem",e[e.Uri=4]="Uri",e[e.AttachmentItem=5]="AttachmentItem",e[e.CloudSuggestion=6]="CloudSuggestion",e[e.AttachmentItemSuggestion=7]="AttachmentItemSuggestion",e[e.Inline=8]="Inline",e[e.Smime=9]="Smime",e[e.FilesHub=10]="FilesHub",e[e.GroupFilesHub=11]="GroupFilesHub",e[e.MailSearchFileSuggestion=12]="MailSearchFileSuggestion",e[e.Unknown=13]="Unknown",e[e.ContextualSuggestion=14]="ContextualSuggestion",e[e.ConsumerGroupFilesHub=15]="ConsumerGroupFilesHub",e[e.SmartDoc=16]="SmartDoc",e[e.ExpirableBase64InlineImage=17]="ExpirableBase64InlineImage"}(r||(r={}))},1654:function(e,t,n){"use strict";var r=n(1635),a=n(1823),i=n(6);function o(e){var t;return e>=1073741824?(e/=1073741824,t=Object(i.b)(a.b)):e>=1048576?(e/=1048576,t=Object(i.b)(a.d)):e>=1024?(e/=1024,t=Object(i.b)(a.c)):t=Object(i.b)(a.a),Object(i.c)(t,Math.round(e))}var u,c=n(1694),s=n(33),l=[".pdf",".doc",".docx",".odt",".rtf",".ppt",".pptx",".pptm",".potx",".potm",".pot",".ppxx",".pps",".odp"];function d(e){if(!Object(s.i)("doc-attachment-documentThumbnail"))return!1;var t=Object(r.a)(e);return!!t&&l.indexOf(t.toLowerCase())>=0}function f(e){switch(e){case".doc":case".docm":case".docx":case".dot":case".dotm":case".dotx":case".odt":case".rtf":return u.Word;case".csv":case".ods":case".xls":case".xlsb":case".xlsm":case".xlsx":return u.Excel;case".odp":case".pot":case".potm":case".potx":case".pps":case".ppsm":case".ppsx":case".ppt":case".pptm":case".pptx":return u.PowerPoint;default:return null}}!function(e){e[e.Word=0]="Word",e[e.Excel=1]="Excel",e[e.PowerPoint=2]="PowerPoint"}(u||(u={}));var b=n(1665);n.d(t,"b",(function(){return r.a})),n.d(t,"c",(function(){return r.b})),n.d(t,"d",(function(){return r.c})),n.d(t,"i",(function(){return o})),n.d(t,"g",(function(){return c.a})),n.d(t,"h",(function(){return d})),n.d(t,"f",(function(){return f})),n.d(t,"e",(function(){return b.b})),n.d(t,"a",(function(){return u}))},1665:function(e,t,n){"use strict";function r(e){return t=e||"",(n=i.exec(t))&&n.length>1&&a[n[1].toLowerCase()];var t,n}n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return o}));var a={"image/bmp":".bmp","image/x-ms-bmp":".bmp","image/gif":".gif","image/jpeg":".jpeg","image/png":".png","image/vnd.adobe.photoshop":".psd","image/tiff":".tiff"},i=/^\s*([^;\s]*)(?:;|\s|$)/;function o(e){var t="";return Object.entries(a).forEach((function(n){n[1]===e&&(t=n[0])})),t}},1694:function(e,t,n){"use strict";n.d(t,"a",(function(){return c})),n.d(t,"b",(function(){return s}));var r=n(1635),a=n(1665),i=n(89),o=[".bmp",".gif",".jpe",".jpeg",".jpg",".jfif",".dib",".png",".psd"],u=[".tiff",".tif"];function c(e,t,n){return void 0===n&&(n=!0),s(Object(r.a)(e)||Object(a.a)(t),n)}function s(e,t){return void 0===t&&(t=!0),!!e&&(o.indexOf(e.toLowerCase())>=0||t&&u.indexOf(e.toLowerCase())>=0&&(Object(i.e)()||Object(i.d)()||Object(i.h)()||Object(i.g)()&&!Object(i.l)()))}},1703:function(e,t,n){"use strict";var r=new RegExp("^data:(image\\/\\w+);base64,([A-Za-z0-9+/=]+?)$","i");function a(e){var t=null,n=r.exec(e);if(n){var a=n[1],i=n[2],o=null;try{o=atob(i)}catch(e){}if(o){for(var u=new ArrayBuffer(o.length),c=new Uint8Array(u),s=0;s<o.length;s++)c[s]=o.charCodeAt(s);t=new File([u],"image.png",{type:a})}}return t}var i=n(1638),o=n(1654);function u(e){return e.map((function(e){return{fileType:i.a.Uri,name:e.name,type:Object(o.b)(e.url)||"",size:0,uri:e.url}}))}var c=n(23);function s(e,t,n){if(e.length!=t.length)return c.d("The sizes of subjects and latestItemIds are different"),null;for(var r=[],a=0;a<e.length;a++){var o={fileType:i.a.MailItem,name:e[a],size:(null==n?void 0:n[a])||0,itemId:t[a]};r.push(o)}return r}function l(e,t,n){var r=[],a={fileType:i.a.MailItem,name:e,size:n||0,mimeContent:t};return r.push(a),r}function d(e){if(!e)return null;for(var t=[],n=0;n<e.length;n++){var r=e[n],a={fileType:i.a.Local,name:r.name,size:r.size,type:r.type,fileObject:r};t.push(a)}return t}function f(e){if(!e)return null;for(var t=[],n=0;n<e.length;n++){var r=e[n],a={fileType:r.fileType,name:r.name,size:r.size,type:r.type,dataUri:r.dataUri};t.push(a)}return t}function b(e){var t,n;return null===e?null:{fileType:i.a.Cloud,name:e.Name,size:e.Size,providerId:e.AttachmentProviderId,providerType:e.ProviderType,location:e.Location,providerEndpointUrl:e.ProviderEndpointUrl,isFolder:1===e.Type,fileId:e.Id,fileParentId:e.ParentId,thumbnailUrl:(null===(t=e.Thumbnail)||void 0===t?void 0:t.Url)||"",previewUrl:(null===(n=e.Preview)||void 0===n?void 0:n.Url)||"",type:e.MimeType}}function v(e){return null===e?null:{attachmentItemId:e.Id,name:e.Name,size:e.Size,fileType:i.a.AttachmentItem,type:"ItemIdAttachment:#Exchange"}}var p={BOX:"Box",DROPBOX:"Dropbox",FACEBOOK:"Facebook",GDRIVE:"GDrive",MAILBOX:"Mailbox",ONE_DRIVE_CONSUMER:"OneDriveConsumer",ONE_DRIVE_PRO:"OneDrivePro",RECENT_ATTACHMENTS:"RecentAttachments",WOPI:"Wopi",WOPI_BOX:"WopiBox",WOPI_EGNYTE:"WopiEgnyte"};function m(e){switch(e?e.toLowerCase():null){case p.ONE_DRIVE_PRO.toLowerCase():return 0;case p.GDRIVE.toLowerCase():return 5;case p.ONE_DRIVE_CONSUMER.toLowerCase():return 1;case p.DROPBOX.toLowerCase():return 2;case p.BOX.toLowerCase():return 3;case p.WOPI_BOX.toLowerCase():return 7;case p.WOPI_EGNYTE.toLowerCase():return 8;case p.MAILBOX.toLowerCase():return 4;case p.FACEBOOK.toLowerCase():return 6;default:return null}}n.d(t,"f",(function(){return a})),n.d(t,"j",(function(){return u})),n.d(t,"i",(function(){return s})),n.d(t,"h",(function(){return l})),n.d(t,"g",(function(){return d})),n.d(t,"d",(function(){return f})),n.d(t,"e",(function(){return b})),n.d(t,"c",(function(){return v})),n.d(t,"b",(function(){return m})),n.d(t,"a",(function(){return i.a}))},1736:function(e,t,n){"use strict";var r=n(2),a=n(12),i=n(1819),o={providers:new a.ObservableMap,loadState:i.a.NotLoaded,removalPending:new a.ObservableMap},u=Object(r.createStore)("fileProviderStore",o);t.a=u},1737:function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"a",(function(){return a})),n.d(t,"c",(function(){return o}));var r=n(2),a=Object(r.action)("FILE_PROVIDER_ADDED",(function(e){return{providerViewState:e}})),i=Object(r.action)("FILE_PROVIDER_REMOVED",(function(e){return{providerType:e}})),o=Object(r.action)("PROVIDERS_LOADED",(function(e){return{providers:e}}))},1760:function(e,t,n){"use strict";n.d(t,"l",(function(){return b})),n.d(t,"n",(function(){return v})),n.d(t,"k",(function(){return p})),n.d(t,"m",(function(){return m}));var r=n(36),a=n(1935);n.d(t,"b",(function(){return a.a}));var i=n(1893);n.d(t,"i",(function(){return i.a}));n(1736);var o=n(1737);n.d(t,"d",(function(){return o.a})),n.d(t,"e",(function(){return o.b})),n.d(t,"o",(function(){return o.c}));var u=n(1894);n.d(t,"a",(function(){return u.b}));var c=n(1797);n.d(t,"g",(function(){return c.a})),n.d(t,"h",(function(){return c.b}));var s=n(1885);n.d(t,"j",(function(){return s.a}));var l=n(1819);n.d(t,"c",(function(){return l.a}));var d=n(1883);n.d(t,"f",(function(){return d.b}));var f=new r.c((function(){return Promise.all([n.e(3),n.e(568)]).then(n.bind(null,3082))})),b=new r.b(f,(function(e){return e.loadProviders})),v=new r.b(f,(function(e){return e.removeFileProvider})),p=new r.b(f,(function(e){return e.addFileProvider})),m=new r.b(f,(function(e){return e.removeAndAddFileProvider}))},1797:function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"a",(function(){return o}));var r=n(0),a=n(1736),i=function(){return Object(r.__spread)(Object(a.a)().providers.values())},o=function(e){return Object(a.a)().providers.get(e)||null}},1819:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.Loaded=0]="Loaded",e[e.Loading=1]="Loading",e[e.NotLoaded=2]="NotLoaded",e[e.Throttled=3]="Throttled"}(r||(r={}))},1823:function(e){e.exports=JSON.parse('{"b":"uub","d":"vub","c":"wub","a":"xub"}')},1883:function(e,t,n){"use strict";var r=n(0),a=n(30);function i(e){return Object(r.__assign)({__type:"GetNewAttachmentDataProviderCreationInfoRequest:#Exchange"},e)}function o(e){var t,n,r=i({ProviderType:e});return void 0===(t=r)||t.__type||(t=i(t)),Object(a.a)("GetNewAttachmentDataProviderCreationInfo",t,n)}function u(e){return Object(r.__assign)({__type:"GetAttachmentDataProviderCreatorRequest:#Exchange"},e)}function c(e){var t,n,r=u({ProviderType:e});return void 0===(t=r)||t.__type||(t=u(t)),Object(a.a)("GetAttachmentDataProviderCreator",t,n)}var s=n(2192),l=n(2134);n.d(t,"a",(function(){return O})),n.d(t,"b",(function(){return w}));var d="code",f="token",b=3e3,v=3;function p(e){return{state:e}}function m(e){return e.state}function h(e){return e.code}function O(e,t,n,a,i){var u={providerType:e,getAuthUrlInfo:null,getCSRFToken:m,getOAuthCode:h};return function e(t,n,a,i,u,l,d){return Object(r.__awaiter)(this,void 0,void 0,(function(){var f,v;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return r.trys.push([0,5,,6]),f=void 0,7!==t&&9!==t&&8!==t?[3,2]:[4,c(t)];case 1:return v=r.sent(),f=v.AttachmentDataProviderCreator.ProviderAppKey,a=v.AttachmentDataProviderCreator.AuthorizationUri,[3,4];case 2:return[4,o(t)];case 3:v=r.sent(),f=v.ProviderAppKey,r.label=4;case 4:return n.getAuthUrlInfo=Object(s.d)(t,a,i,f,u,l),[3,6];case 5:return r.sent(),d>0&&setTimeout((function(){return e(t,n,a,i,u,l,--d)}),b),[3,6];case 6:return[2]}}))}))}(e,u,t,n,a,i,v),u}var g=null;function j(){if(!g){if(g={},Object(l.a)(3)&&(g[3]=O(3,"https://app.box.com/api/oauth2/authorize",Object(s.c)(3),d,p)),Object(l.a)(2)&&(g[2]=O(2,"https://www.dropbox.com/oauth2/authorize",Object(s.b)(2),d,p)),Object(l.a)(6)){var e=O(6,"https://www.facebook.com/dialog/oauth",Object(s.b)(6),f,(function(e){return{state:e,scope:"user_photos,email"}}));e.getCSRFToken=m,e.getOAuthCode=function(e){return e.access_token},g[6]=e}if(Object(l.a)(5)){var t=O(5,"https://accounts.google.com/o/oauth2/auth",s.a+"/ADPRedirect.aspx",d,(function(e){var t={state:e,provider:5..toString(),url:Object(s.b)()};return{state:JSON.stringify(t),scope:"https://www.googleapis.com/auth/drive",access_type:"offline",prompt:"consent",include_granted_scopes:"true"}}));t.getCSRFToken=function(e){return JSON.parse(e.state).state},g[5]=t}Object(l.a)(1)&&(g[1]=O(1,"https://login.live.com/oauth20_authorize.srf",Object(s.c)(1),d,(function(e){return{state:e,scope:"wl.basic onedrive.readwrite wl.offline_access"}}))),Object(l.a)(7)&&(g[7]=O(7,"",Object(s.c)(7),d,p)),Object(l.a)(8)&&(g[8]=O(8,"",Object(s.c)(8),d,p)),Object(l.a)(9)&&(g[9]=O(9,"",Object(s.c)(9),d,p))}return g}function w(e){var t=j();return e in t?t[e]:null}},1885:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(1736);function a(){return Object(r.a)().loadState}},1893:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(2224),a=n(2152),i=n(2202),o=n(6),u=n(96);function c(e,t){if(void 0===t&&(t=!1),t)return"";switch(e){case 0:return Object(o.b)(i.b);case 1:return Object(o.b)(i.a);case 2:case 9:return Object(o.b)(r.b);case 3:case 7:return Object(o.b)(r.a);case 5:return Object(o.b)(r.e);case 6:return Object(o.b)(r.d);case 4:return Object(o.b)(r.f);case 10:return Object(o.b)(a.b);case 8:return Object(o.b)(r.c);default:return Object(u.a)(e)}}},1894:function(e,t,n){"use strict";n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return i})),n.d(t,"c",(function(){return o}));var r,a=n(0);!function(e){e[e.Groups=1e4]="Groups"}(r||(r={}));var i=Object.freeze([1,3,2,6,5,7,8,9]),o=Object.freeze(Object(a.__spread)(i,[0,4,10]))},1935:function(e,t,n){"use strict";var r;!function(e){e[e.None=0]="None",e[e.Images=1]="Images"}(r||(r={})),t.a=r},1958:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(217),a=n(343);function i(e){if("ArchiveMailbox"==e.type)return Object(r.a)();var t=e.userIdentity&&Object(a.r)(e.userIdentity),n="GroupMailbox"===e.type;return t&&!n?Object(r.b)(e.mailboxSmtpAddress)+e.userIdentity:"UserMailbox"===e.type?Object(r.a)():e.mailboxSmtpAddress}},1963:function(e,t,n){"use strict";var r=n(343),a=n(0),i={};function o(e){return i[e]}function u(e,t){var n=i[e];i[e]=Object(a.__assign)(Object(a.__assign)({},n),t)}var c=n(65),s=n(30);var l=n(114),d=n(23),f=n(614),b=n(1646),v=n(1645);function p(e){return Object(a.__awaiter)(this,void 0,void 0,(function(){var t,n;return Object(a.__generator)(this,(function(r){switch(r.label){case 0:return(t={}).headers=new Headers,[4,Object(b.a)(e)];case 1:return n=r.sent(),Object(v.b)(t.headers,n),[2,t]}}))}))}var m=Object(f.b)({timeBetweenRetryInMS:function(){return 3e4}});function h(e,t){t=t<1?1:t,setInterval((function(){!function(e){Object(a.__awaiter)(this,void 0,void 0,(function(){var t,n,i,c,f,b,v=this;return Object(a.__generator)(this,(function(h){switch(h.label){case 0:if(t=function(){return Object(a.__awaiter)(v,void 0,void 0,(function(){var t,n;return Object(a.__generator)(this,(function(a){switch(a.label){case 0:return a.trys.push([0,3,,4]),t={},Object(r.r)(e.userIdentity)?[4,p(e.userIdentity)]:[3,2];case 1:t=a.sent(),a.label=2;case 2:return[2,(i=t,Object(s.a)("GetAttachmentDownloadToken",{},i))];case 3:throw n=a.sent(),d.g.warn("Unable to get the download token "+n),n.networkError=!0,n;case 4:return[2]}var i}))}))},null==(n=o(e.userIdentity))?void 0:n.isRefreshingDownloadToken)return[3,4];u(e.userIdentity,{isRefreshingDownloadToken:!0}),i=0,c=m((function(){return Object(a.__awaiter)(v,void 0,void 0,(function(){var n;return Object(a.__generator)(this,(function(r){switch(r.label){case 0:return i++,[4,t()];case 1:return n=r.sent(),d.g.info("update new token"),u(e.userIdentity,{downloadToken:n,isRefreshingDownloadToken:!1}),[2]}}))}))})).retriableFunc,f=new l.c("AttachmentRefreshDownloadToken"),h.label=1;case 1:return h.trys.push([1,3,,4]),[4,c()];case 2:return h.sent(),f.addCustomData([i]),f.end(),[3,4];case 3:return b=h.sent(),d.g.warn("Retry to refresh token failed: "+b),f.addCustomData([i]),f.endWithError("ServerError",b),u(e.userIdentity,{isRefreshingDownloadToken:!1}),[3,4];case 4:return[2]}}))}))}(e)}),6e4*t)}var O=n(96);function g(e){var t=Object(r.j)(null==e?void 0:e.userIdentity),n=o(null==e?void 0:e.userIdentity);if((null==n?void 0:n.downloadToken)&&(null==n?void 0:n.downloadUrlBase))return n;switch(t){case null:case"Outlook":!function(e){var t=Object(r.r)(e.userIdentity)?Object(c.i)(e.userIdentity):Object(c.h)(),n=null==t?void 0:t.ApplicationSettings;if(n){var a=n.DownloadUrlBase;u(e.userIdentity,{downloadUrlBase:a,downloadToken:n.FirstDownloadToken}),a&&h(e,n.DownloadTokenRefreshMinutes)}}(e);break;case"Google":case"ICloud":break;default:Object(O.a)(t)}var a=o(e.userIdentity);return a||(Object(l.r)("FilesUrlDataNotFound",{accountProviderType:t}),d.g.warn("Unable to get the url data")),a}function j(e){if(!e)return null;var t=g(e);return null==t?void 0:t.downloadToken}n.d(t,"b",(function(){return g})),n.d(t,"a",(function(){return j}))},2083:function(e,t,n){"use strict";var r=n(1),a=r.createContext(window);t.a=a},2123:function(e,t,n){"use strict";var r=n(2138);n.d(t,"a",(function(){return r.a})),n.d(t,"b",(function(){return r.b}));var a=n(1963);n.d(t,"c",(function(){return a.a}));var i=n(1958);n.d(t,"d",(function(){return i.a}))},2134:function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n(1663),a=n(233),i=n(96),o=n(33);function u(e){var t=Object(r.a)();switch(e){case 5:return(null==t?void 0:t.GoogleDriveAttachmentsEnabled)&&(null==t?void 0:t.ThirdPartyAttachmentsEnabled)&&Object(o.i)("doc-fileProvider-gdrive");case 4:case 0:return!0;case 3:return(null==t?void 0:t.BoxAttachmentsEnabled)&&(null==t?void 0:t.ThirdPartyAttachmentsEnabled)&&Object(o.i)("doc-fileProvider-box");case 2:return(null==t?void 0:t.DropboxAttachmentsEnabled)&&(null==t?void 0:t.ThirdPartyAttachmentsEnabled)&&Object(o.i)("doc-fileProvider-dropbox");case 6:return(null==t?void 0:t.ThirdPartyAttachmentsEnabled)&&Object(o.i)("doc-fileProvider-facebook");case 1:return!!Object(a.a)()||(null==t?void 0:t.OnedriveAttachmentsEnabled)&&(null==t?void 0:t.ThirdPartyAttachmentsEnabled);case 10:return Object(o.i)("doc-filePicker-mailMessageAttachment");case 7:case 8:case 9:return(null==t?void 0:t.ThirdPartyAttachmentsEnabled)&&Object(o.i)("doc-fileProvider-wopiClient");default:return Object(i.a)(e)}}},2138:function(e,t,n){"use strict";var r=n(96),a=n(6),i=n(52),o="/owa/",u="service.svc/s/GetFileAttachment?id={0}",c="service.svc/s/GetReferenceAttachment?attachmentId={0}&location={1}",s="service.svc/s/GetAttachmentThumbnail?id={0}&thumbnailType=2",l="service.svc/s/GetReferenceAttachment?attachmentId={0}&location={1}&isImagePreview=True",d="service.svc/s/GetAttachmentThumbnail?id={0}",f="pdfprint.aspx?id={0}",b="pdfprint.aspx?id={0}&location={1}",v=[".bmp",".gif",".jpe",".jpeg",".jpg",".jfif",".dib",".png",".psd",".tiff",".tif"];var p=n(233),m=n(59),h=n(3),O=n(28),g=n(1963),j=n(1958);function w(e,t,n,r,u){if(void 0===r&&(r=!1),void 0===u&&(u=null),!e||!e.Id||!e.mailboxInfo)return null;var c=Object(g.b)(e.mailboxInfo),s=null==c?void 0:c.downloadUrlBase,l=Object(j.a)(e.mailboxInfo);if(u=u||Object(a.c)(t,encodeURIComponent(e.Id)),!s||r&&"Firefox"===Object(m.a)().browser){var d=o+u+"&X-OWA-CANARY="+Object(i.a)();return Object(O.a)(d)}var f="{0}{1}/{2}";Object(p.a)()&&(f+="&isc=1");var b=Object(a.c)(f,s,l,u);return n&&(b+="&token="+(null==c?void 0:c.downloadToken),b+="&X-OWA-CANARY="+Object(i.a)()),Object(m.i)()||(b+="&owa="+window.location.hostname,b+="&scriptVer="+Object(h.p)()||!1),b}function x(e,t,n,u,s,d,f,p,m){var h;switch(void 0===s&&(s=0),void 0===d&&(d=0),void 0===f&&(f=!0),void 0===p&&(p=null),void 0===m&&(m=null),n){case 0:h=c;break;case 3:h=b;break;case 1:if(!function(e){if(!e)return!1;var t=null,n=e.lastIndexOf(".");return n>0&&(t=e.substr(n).toLowerCase()),!!t&&v.indexOf(t.toLowerCase())>=0}(p))return null;h=l;break;default:Object(r.a)(n)}var g=u?d:s;!g&&s&&(g=s);var j=Object(a.c)("{0}&permissionLevel={1}",Object(a.c)(h,encodeURIComponent(e.Id),encodeURIComponent(t)),g),x=w(e,h,!0,3===n,j);if(x)return x;var y=Object(a.c)("{0}{1}{2}",o,m,j);f&&(y=y+"&X-OWA-CANARY="+Object(i.a)());return Object(O.a)(y)}function y(e,t,n,i){var o;switch(void 0===n&&(n=!1),void 0===i&&(i=!0),t){case 0:o=u;break;case 1:o=s;break;case 2:o=d;break;case 3:o=f;break;default:return Object(r.a)(t)}if(!Object(a.f)(o)){var c=w(e,o,i,3===t);return Object(a.c)("{0}{1}{2}",c,n?"&isDownload=true":"","&animation=true")}return null}n.d(t,"b",(function(){return x})),n.d(t,"a",(function(){return y}))},2152:function(e){e.exports=JSON.parse('{"a":"bca","b":"cca"}')},2192:function(e,t,n){"use strict";var r=n(490),a=n(3);function i(e,t,n){if(!e||!t||!n)throw new Error("Key and Value parameters should not be null");return e.indexOf("?")>0?e+"&"+t+"="+n:e+"?"+t+"="+n}n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return u})),n.d(t,"c",(function(){return c})),n.d(t,"d",(function(){return s}));var o=Object(a.H)()?"https://exchangelabs.live-int.com/owa":"https://outlook.office.com/owa";function u(e){var t=e?encodeURIComponent("?provider="+e):"",n=e&&6===e?"AddFacebookFileProvider.html":"AddFileProvider.html";return Object(r.l)()+"/mail/"+n+t}function c(e){var t=Object(r.l)()+"/mail/AddFileProvider.html",n=encodeURIComponent("provider="+e+"&url="+t);return o+"/ADPRedirect.aspx?"+n}function s(e,t,n,r,a,o){return function(){var e=function(){for(var e="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789".split(""),t=e.length-1,n=[],r=0;r<16;r++)n.push(e[Math.round(Math.random()*t)]);return"owa_csrf_token_"+n.join("")}(),u=i(t,"client_id",r);if(u=i(u,"redirect_uri",n),u=i(u,"response_type",a),o){var c=o(e);u=Object.keys(c).reduce((function(e,t){return i(e,t,c[t])}),u)}return{authUrl:u,redirectUrl:n,csrfToken:e}}}},2202:function(e){e.exports=JSON.parse('{"b":"Iba","a":"Jba"}')},2224:function(e){e.exports=JSON.parse('{"b":"xba","a":"yba","e":"zba","d":"Aba","f":"Bba","c":"Cba"}')},2359:function(e,t,n){"use strict";var r=n(96),a=n(2123),i=n(52),o=n(2716);function u(e,t,n,i,u){var c;void 0===u&&(u=!0);var s=t,l=s.Name,d=s.OriginalPermissionType,f=s.PermissionType,b=Object(o.a)(t),v="GroupMailbox"===(null===(c=null==e?void 0:e.mailboxInfo)||void 0===c?void 0:c.type)?e.mailboxInfo.mailboxSmtpAddress+"/":null;switch(n){case 0:case 3:return a.b(e,b,n,i,f,d,u,l,v);case 1:return t.AttachmentPreviewUrl?t.AttachmentPreviewUrl:a.b(e,b,1,i,f,d,u,l,v);case 2:return t.AttachmentThumbnailUrl;default:return Object(r.a)(n)}}function c(e,t,n,r){return void 0===n&&(n=!1),void 0===r&&(r=!0),a.a(e,t,n,r)}function s(e,t,n,r,o){void 0===o&&(o=!1);var s=n?u(e,t,1,r,!1):c(e,1,o,!1);if(n)return{url:s,init:{credentials:"include"}};var l=Object(a.c)(e.mailboxInfo),d=new Headers;return d.set("X-Token",l),d.set("X-OWA-CANARY",Object(i.a)()),{url:s,init:{headers:d}}}function l(e,t,n,r,a,i){return void 0===i&&(i=!1),r?u(e,t,n,a):c(e,n,i)}n.d(t,"a",(function(){return l})),n.d(t,"b",(function(){return c})),n.d(t,"c",(function(){return s}))},2716:function(e,t,n){"use strict";function r(e){var t=null;return(t=e.AttachLongPathName)||(t=e.WebUrl),t}n.d(t,"a",(function(){return r}))},3089:function(e,t,n){"use strict";var r="OLK_Beautified_",a="olkBeautifulLink",i="true",o=n(1102),u=n(6),c=n(33);function s(e,t,n){return{name:Object(u.b)(o.a),key:"OpenInNewTab",iconProps:Object(c.i)("wvn-chicletEditOptions")||Object(c.i)("wvn-chicletEditOptionsNoDownload")?{iconName:"TabCenter"}:void 0,onClick:function(){(t||window).open(e,"_blank"),n&&n()}}}function l(e){var t;return"a"===e.tagName.toLowerCase()&&0===(null===(t=e.id)||void 0===t?void 0:t.indexOf(r))}function d(e,t,n){return l(t)&&t.setAttribute(a,i),null}n.d(t,"a",(function(){return"owaAttachmentRemoveOnSend"})),n.d(t,"b",(function(){return r})),n.d(t,"c",(function(){return a})),n.d(t,"d",(function(){return i})),n.d(t,"e",(function(){return"OWA"})),n.d(t,"f",(function(){return"OWAInsertLinkPlaceHolder"})),n.d(t,"g",(function(){return s})),n.d(t,"i",(function(){return d})),n.d(t,"h",(function(){return l}))},5601:function(e){e.exports=JSON.parse('{"a":"Job"}')},5602:function(e){e.exports=JSON.parse('{"a":"Iob"}')},7021:function(e){e.exports=JSON.parse('{"a":"xob"}')},7022:function(e){e.exports=JSON.parse('{"a":"hba"}')},711:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var r=n(0).__assign},893:function(e,t,n){"use strict";var r=n(1),a=n(1004),i=n(1566),o=n(7),u={root:"ms-StackItem"},c={start:"flex-start",end:"flex-end"};n.d(t,"a",(function(){return s}));var s=Object(i.a)((function(e){var t=e.children;if(r.Children.count(t)<1)return null;var n=Object(a.b)(e,{root:"div"});return Object(a.c)(n.root,null,t)}),{displayName:"StackItem",styles:function(e,t,n){var r=e.grow,a=e.shrink,i=e.disableShrink,s=e.align,l=e.verticalFill,d=e.order,f=e.className,b=Object(o.getGlobalClassNames)(u,t);return{root:[t.fonts.medium,b.root,{margin:n.margin,padding:n.padding,height:l?"100%":"auto",width:"auto"},r&&{flexGrow:!0===r?1:r},(i||!r&&!a)&&{flexShrink:0},a&&!i&&{flexShrink:1},s&&{alignSelf:c[s]||s},d&&{order:d},f]}}})},900:function(e,t,n){"use strict";var r=n(0),a=n(1),i=n(1004),o=n(1566),u=n(438),c=n(48),s=function(e,t){return t.spacing.hasOwnProperty(e)?t.spacing[e]:e},l=function(e){var t=parseFloat(e),n=isNaN(t)?0:t,r=isNaN(t)?"":t.toString();return{value:n,unit:e.substring(r.toString().length)||"px"}},d=function(e,t){if(void 0===e||"number"==typeof e||""===e)return e;var n=e.split(" ");return n.length<2?s(e,t):n.reduce((function(e,n){return s(e,t)+" "+s(n,t)}))},f=n(7),b={start:"flex-start",end:"flex-end"},v={root:"ms-Stack",inner:"ms-Stack-inner"},p=n(893);n.d(t,"a",(function(){return h}));var m={Item:p.a},h=Object(o.a)((function(e){var t=e.as,n=void 0===t?"div":t,o=e.disableShrink,s=e.wrap,l=Object(r.__rest)(e,["as","disableShrink","wrap"]);Object(u.a)("Stack",e,{gap:"tokens.childrenGap",maxHeight:"tokens.maxHeight",maxWidth:"tokens.maxWidth",padding:"tokens.padding"});var d=a.Children.map(e.children,(function(e,t){if(!e)return null;if((i=e)&&"object"==typeof i&&i.type&&i.type.displayName===p.a.displayName){var n={shrink:!o};return a.cloneElement(e,Object(r.__assign)(Object(r.__assign)({},n),e.props))}var i;return e})),f=Object(c.j)(l,c.k),b=Object(i.b)(e,{root:n,inner:"div"});return s?Object(i.c)(b.root,Object(r.__assign)({},f),Object(i.c)(b.inner,null,d)):Object(i.c)(b.root,Object(r.__assign)({},f),d)}),{displayName:"Stack",styles:function(e,t,n){var a,i,o,u,c,p,m,h=e.verticalFill,O=e.horizontal,g=e.reversed,j=e.grow,w=e.wrap,x=e.horizontalAlign,y=e.verticalAlign,_=e.disableShrink,I=e.className,A=Object(f.getGlobalClassNames)(v,t),S=n&&n.childrenGap?n.childrenGap:e.gap,k=n&&n.maxHeight?n.maxHeight:e.maxHeight,C=n&&n.maxWidth?n.maxWidth:e.maxWidth,P=n&&n.padding?n.padding:e.padding,E=function(e,t){if(void 0===e||""===e)return{rowGap:{value:0,unit:"px"},columnGap:{value:0,unit:"px"}};if("number"==typeof e)return{rowGap:{value:e,unit:"px"},columnGap:{value:e,unit:"px"}};var n=e.split(" ");if(n.length>2)return{rowGap:{value:0,unit:"px"},columnGap:{value:0,unit:"px"}};if(2===n.length)return{rowGap:l(s(n[0],t)),columnGap:l(s(n[1],t))};var r=l(s(e,t));return{rowGap:r,columnGap:r}}(S,t),T=E.rowGap,N=E.columnGap,R=""+-.5*N.value+N.unit,D=""+-.5*T.value+T.unit,G={textOverflow:"ellipsis"},L={"> *:not(.ms-StackItem)":{flexShrink:_?0:1}};return w?{root:[A.root,{flexWrap:"wrap",maxWidth:C,maxHeight:k,width:"auto",overflow:"visible",height:"100%"},x&&(a={},a[O?"justifyContent":"alignItems"]=b[x]||x,a),y&&(i={},i[O?"alignItems":"justifyContent"]=b[y]||y,i),I,{display:"flex"},O&&{height:h?"100%":"auto"}],inner:[A.inner,{display:"flex",flexWrap:"wrap",marginLeft:R,marginRight:R,marginTop:D,marginBottom:D,overflow:"visible",boxSizing:"border-box",padding:d(P,t),width:0===N.value?"100%":"calc(100% + "+N.value+N.unit+")",maxWidth:"100vw",selectors:Object(r.__assign)({"> *":Object(r.__assign)({margin:""+.5*T.value+T.unit+" "+.5*N.value+N.unit},G)},L)},x&&(o={},o[O?"justifyContent":"alignItems"]=b[x]||x,o),y&&(u={},u[O?"alignItems":"justifyContent"]=b[y]||y,u),O&&{flexDirection:g?"row-reverse":"row",height:0===T.value?"100%":"calc(100% + "+T.value+T.unit+")",selectors:{"> *":{maxWidth:0===N.value?"100%":"calc(100% - "+N.value+N.unit+")"}}},!O&&{flexDirection:g?"column-reverse":"column",height:"calc(100% + "+T.value+T.unit+")",selectors:{"> *":{maxHeight:0===T.value?"100%":"calc(100% - "+T.value+T.unit+")"}}}]}:{root:[A.root,{display:"flex",flexDirection:O?g?"row-reverse":"row":g?"column-reverse":"column",flexWrap:"nowrap",width:"auto",height:h?"100%":"auto",maxWidth:C,maxHeight:k,padding:d(P,t),boxSizing:"border-box",selectors:Object(r.__assign)((c={"> *":G},c[g?"> *:not(:last-child)":"> *:not(:first-child)"]=[O&&{marginLeft:""+N.value+N.unit},!O&&{marginTop:""+T.value+T.unit}],c),L)},j&&{flexGrow:!0===j?1:j},x&&(p={},p[O?"justifyContent":"alignItems"]=b[x]||x,p),y&&(m={},m[O?"alignItems":"justifyContent"]=b[y]||y,m),I]}},statics:m})}}]);
//# sourceMappingURL=owa.MailBoot~AttachmentPreviewSxSInitialize~Attachments~HtmlEditorLinkPlugin~OwaFluidLink~OwaInsertLink~~78567fbf.js.map
self.scriptsLoaded['owa.MailBoot~AttachmentPreviewSxSInitialize~Attachments~HtmlEditorLinkPlugin~OwaFluidLink~OwaInsertLink~~78567fbf.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.MailBoot~AttachmentPreviewSxSInitialize~Attachments~HtmlEditorLinkPlugin~OwaFluidLink~OwaInsertLink~~78567fbf.js'] = (new Date()).getTime();