self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.MailBoot~ActionableMessageMail~Attachments.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[199],{10040:function(e,t,n){"use strict";var o=n(23),i=function(){function e(e,t){var n=this;void 0===e&&(e=5),void 0===t&&(t=5e3),this.throttleCallbacks=[],this.activeRequests=0,this.processedRequests=0,this.lastProcessedRequests=0,this.watchDogTimer=null,this.clearQueue=function(){n.throttleCallbacks.length=0,n.activeRequests=0},this.maxConcurrentRequests=e,this.watchDogTimerInterval=t}return e.prototype.watchDogAction=function(){this.throttleCallbacks.length>0?this.processedRequests===this.lastProcessedRequests?(this.activeRequests=0,this.traceInfo("Watch dog is processing the queue."),this.processNextRequest()):(this.traceInfo("Watch dog is watching."),this.lastProcessedRequests=this.processedRequests):(window.clearInterval(this.watchDogTimer),this.watchDogTimer=null,this.traceInfo("Stop watch dog."))},e.prototype.traceInfo=function(e){o.g.info("ThrottleRequests:active="+this.activeRequests+";throttled="+this.throttleCallbacks.length+";processed="+this.processedRequests+";lastProcessed="+this.lastProcessedRequests+";info="+e)},e.prototype.processNextRequest=function(){(this.processedRequests++,0===this.throttleCallbacks.length)?(this.activeRequests>0&&this.activeRequests--,this.traceInfo("Queue is empty.")):(this.throttleCallbacks.shift()(!1),this.traceInfo("Process next."))},e.prototype.registerCallback=function(e){var t=this;if(null==e)throw new Error("A null callback is registered to Throttle Thumbnails queue.");this.activeRequests<this.maxConcurrentRequests?(e(!1),this.activeRequests++,this.processedRequests++,this.traceInfo("Process now.")):(e(!0),this.throttleCallbacks.push(e),this.traceInfo("Pushes to queue."),this.watchDogTimer||(this.watchDogTimer=window.setInterval((function(){t.watchDogAction()}),this.watchDogTimerInterval),this.traceInfo("Start watch dog.")))},e.prototype.unregisterCallback=function(e){var t=this.throttleCallbacks.indexOf(e);this.throttleCallbacks.splice(t,1),this.activeRequests=0,this.traceInfo("unregisterComponent:"+t)},e}();t.a=i},1023:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var o=n(44),i=n(710);function a(e,t){Object.keys(i.a).some((function(n){return i.a[n]==t&&(Object(o.h)(e,{key:n,id:t},{isCore:!0}),!0)}))}},1046:function(e,t,n){"use strict";n.d(t,"a",(function(){return d}));var o=n(0),i=n(1),a=n(196),r=n(244),s=n(1047),c=n(746),l=n(66),u=Object(a.a)(),d=function(e){function t(t){var n=e.call(this,t)||this;return n.rootElement=i.createRef(),Object(r.a)(n),n.state={},n._defaultCalloutProps={beakWidth:16,gapSpace:0,setInitialFocus:!0,doNotLayer:!1,directionalHint:l.DirectionalHint.rightCenter},n}return Object(o.__extends)(t,e),t.prototype.focus=function(){this.rootElement.current&&this.rootElement.current.focus()},t.prototype.render=function(){var e=this.props,t=e.calloutProps,n=e.targetElement,a=e.onDismiss,r=e.hasCloseButton,l=void 0===r?this.props.hasCloseIcon:r,d=e.isWide,h=e.styles,m=e.theme,b=e.target,g=Object(o.__assign)(Object(o.__assign)({},this._defaultCalloutProps),t),f={theme:m,isWide:d,calloutProps:Object(o.__assign)(Object(o.__assign)({},g),{theme:g.theme}),hasCloseButton:l},p=u(h,f),v=p.subComponentStyles?p.subComponentStyles.callout:void 0;return i.createElement(c.a,Object(o.__assign)({target:b||n,onDismiss:a},g,{className:p.root,styles:v,hideOverflow:!0}),i.createElement("div",{ref:this.rootElement},i.createElement(s.a,Object(o.__assign)({},this.props))))},t.defaultProps={calloutProps:{beakWidth:16,gapSpace:0,setInitialFocus:!0,doNotLayer:!1,directionalHint:l.DirectionalHint.rightCenter}},t}(i.Component)},1047:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var o=n(463),i=n(1048),a=n(826),r=Object(o.a)(i.a,a.a,void 0,{scope:"TeachingBubbleContent"})},1048:function(e,t,n){"use strict";n.d(t,"a",(function(){return g}));var o=n(0),i=n(1),a=n(196),r=n(54),s=n(244),c=n(516),l=n(879),u=n(699),d=n(400),h=n(900),m=n(882),b=Object(a.a)(),g=function(e){function t(t){var n=e.call(this,t)||this;return n.rootElement=i.createRef(),n._onKeyDown=function(e){n.props.onDismiss&&e.which===r.a.escape&&n.props.onDismiss()},Object(s.a)(n),n.state={},n}return Object(o.__extends)(t,e),t.prototype.componentDidMount=function(){this.props.onDismiss&&document.addEventListener("keydown",this._onKeyDown,!1)},t.prototype.componentWillUnmount=function(){this.props.onDismiss&&document.removeEventListener("keydown",this._onKeyDown)},t.prototype.focus=function(){this.rootElement.current&&this.rootElement.current.focus()},t.prototype.render=function(){var e,t,n,a,r,s=this.props,g=s.children,f=s.illustrationImage,p=s.primaryButtonProps,v=s.secondaryButtonProps,y=s.headline,C=s.hasCondensedHeadline,O=s.hasCloseButton,w=void 0===O?this.props.hasCloseIcon:O,I=s.onDismiss,E=s.closeButtonAriaLabel,j=s.hasSmallHeadline,R=s.isWide,S=s.styles,P=s.theme,T=s.ariaDescribedBy,B=s.ariaLabelledBy,k=s.footerContent,F=s.focusTrapZoneProps,x=b(S,{theme:P,hasCondensedHeadline:C,hasSmallHeadline:j,hasCloseButton:w,hasHeadline:!!y,isWide:R,primaryButtonClassName:p?p.className:void 0,secondaryButtonClassName:v?v.className:void 0});if(f&&f.src&&(e=i.createElement("div",{className:x.imageContent},i.createElement(d.a,Object(o.__assign)({},f)))),y){var _="string"==typeof y?"p":"div";t=i.createElement("div",{className:x.header},i.createElement(_,{role:"heading",className:x.headline,id:B},y))}if(g){var N="string"==typeof g?"p":"div";n=i.createElement("div",{className:x.body},i.createElement(N,{className:x.subText,id:T},g))}return(p||v||k)&&(a=i.createElement(h.a,{className:x.footer,horizontal:!0,horizontalAlign:k?"space-between":"end"},i.createElement(h.a.Item,{align:"center"},i.createElement("span",null,k)),i.createElement(h.a.Item,null,v&&i.createElement(c.a,Object(o.__assign)({},v,{className:x.secondaryButton})),p&&i.createElement(l.a,Object(o.__assign)({},p,{className:x.primaryButton}))))),w&&(r=i.createElement(u.a,{className:x.closeButton,iconProps:{iconName:"Cancel"},title:E,ariaLabel:E,onClick:I})),i.createElement("div",{className:x.content,ref:this.rootElement,role:"dialog",tabIndex:-1,"aria-labelledby":B,"aria-describedby":T,"data-is-focusable":!0},e,i.createElement(m.a,Object(o.__assign)({isClickableOutsideFocusTrap:!0},F),i.createElement("div",{className:x.bodyContent},t,n,a,r)))},t}(i.Component)},1577:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var o=n(463),i=n(1046),a=n(826),r=Object(o.a)(i.a,a.a,void 0,{scope:"TeachingBubble"})},355:function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return r}));var o=n(2),i=n(12),a=Object(o.createStore)("lightningState",{unseenItems:new i.ObservableMap,lightedCount:0,lastShownId:null}),r=a()},524:function(e,t,n){"use strict";var o=n(36),i=n(355),a=n(23),r=n(0),s=n(5),c=n(12),l=n(2),u=Object(l.mutatorAction)("initializeLightning",(function(e){var t,n;if(a.g.info("initialize lightning store"),Object(i.a)().lastShownId=null,Object(i.a)().lightedCount=0,Object(i.a)().unseenItems=new c.ObservableMap,e)try{for(var o=Object(r.__values)(e),s=o.next();!s.done;s=o.next()){var l=s.value;Object(i.a)().unseenItems.set(l.identity,l)}}catch(e){t={error:e}}finally{try{s&&!s.done&&(n=o.return)&&n.call(o)}finally{if(t)throw t.error}}}));var d=n(146),h="ows/v1.0/lightning/items/unseen";function m(){return a.g.info("initialize lightning from server"),Object(d.b)(h).then((function(e){var t=e.map(b);u(t)}))}function b(e){return e.category?{identity:e.id,visible:!1,category:e.category}:{identity:e,visible:!1}}var g,f=n(17),p=n(33),v="lightning",y="UnseenLightening";function C(){var e,t,n;if(!g){var o=Object(s.a)(v);if(o)g=function(e){a.g.info("initialize lightning from override query parameter");var t=e.split(",").map((function(e){return{identity:e,visible:!1}}));return u(t),Promise.resolve()}(o);else{var i=Object(f.a)().PrimeSettings;if(Object(p.i)("lightning-initFromSD")&&i&&i.Items)try{for(var c=Object(r.__values)(i.Items),l=c.next();!l.done;l=c.next()){var d=l.value;if(d.Id===y&&d.Value){n=d.Value,a.g.info("initialize lightning from session data"),u(n.map((function(e){return{identity:e.id,visible:!1,category:e.category}}))),g=Promise.resolve();break}}}catch(t){e={error:t}}finally{try{l&&!l.done&&(t=c.return)&&t.call(c)}finally{if(e)throw e.error}}g||(g=m())}}return g}var O=n(1023),w=Object(l.action)("lightup",(function(e){return{id:e}})),I=w;Object(l.mutator)(w,(function(e){a.g.info("lightup - id:"+e.id),Object(i.a)().lastShownId=e.id,Object(i.a)().lightedCount++;var t=Object(i.a)().unseenItems.get(e.id);t&&(t.visible=!0)})),Object(l.orchestrator)(w,(function(e){Object(O.a)("LIGHTUP",e.id)}));var E,j=n(490);function R(e,t){(a.g.info("lightupOrReject - id:"+e+", recurrenceCount:"+t+", lightedCount:"+Object(i.a)().lightedCount+", lastShown:"+Object(i.a)().lastShownId),Object(j.v)())?a.g.info("lightning is disabled for deeplink"):Object(i.a)().unseenItems.has(e)&&(!Object(i.a)().lastShownId||function(e,t){var n=!1,o=Object(i.a)().lastShownId;if(o&&t&&!function(){var e=Object(i.a)(),t=e.lastShownId,n=e.unseenItems;return t&&n.has(t)&&n.get(t).visible}()){var a=t.indexOf(o),r=t.indexOf(e);a>=0&&a+1==r&&(n=!0)}return n}(e,t)||function(e){var t=Object(i.a)().unseenItems.get(e);return!!t&&t.category==E.UIFeatureDiscovery}(e)||function(e){var t=Object(i.a)().unseenItems.get(e);return!!t&&t.category==E.Compliance}(e))&&I(e)}function S(e,t,n){a.g.info("beginLightning - id:"+e),t((function(){C().then((function(){return R(e,n)})).catch((function(t){a.g.warn("something is wrong, lightning id:"+e+", reason:"+t)}))}))}!function(e){e.None="0",e.UpSell="1",e.FeatureDiscovery="2",e.TeachingMoment="3",e.UITeachingMoment="4",e.UIFeatureDiscovery="5",e.UIUpSell="6",e.JITNewUser="7",e.Compliance="8",e.SatCoreMetric="9",e.UpSellExperiment="10"}(E||(E={}));var P=n(710);n.d(t,"c",(function(){return B})),n.d(t,"d",(function(){return i.b})),n.d(t,"b",(function(){return S})),n.d(t,"a",(function(){return P.a}));var T=new o.c((function(){return n.e(462).then(n.bind(null,17512))})),B=new o.a(T,(function(e){return e.endLightningImp}))},710:function(e,t,n){"use strict";var o;n.d(t,"a",(function(){return o})),function(e){e.UserVoiceSatisfactionFirstRun="0",e.UserVoiceSatisfactionSecondRun="1",e.ConsumerRefreshFRE="2",e.AnimatedConsumerRefreshFRE="3",e.AnimatedConsumerRefreshFRE2="4",e.SettingPanelFirstRunCallout="5",e.SettingIconFirstRunCallout="6",e.AddStorageAccountCallout="7",e.PremiumDomainConnectModal="8",e.WhatsNewFlexPane="10",e.FocusOtherOff="12",e.TargetedAdsGdprPrompt="13",e.WebPushPromotion="14",e.MailGraduatedNewFeatureCarousel="15",e.EdgePromotion="20",e.ActionableMessageTeachingUiTeachingBubblePolicy="21",e.GetStartedFlexPane="22",e.CalendarSurvey="23",e.MiniUserSurveyV1="25",e.TodoCalendarFRE="26",e.TodoMailFRE="27",e.GroupFilesHubFRE="28",e.AddCloudCacheAccountCallout="29",e.NewConsumerRecruitmentCampaign="30",e.InboxPlusFRE="31",e.BusinessCutoverCarousel="32",e.SuiteNps="33",e.InboxPlusEasyOn="34",e.InboxRulesFromDL="35",e.GdprAdsV2="36",e.TimePanelCombinedDndFRE="47",e.UaeEduPrivacyNotification="48",e.OutlookSpacesFRE="49",e.TodoFlaggedEmailList="50",e.DynamicLayoutFolderPaneCollapse="51",e.EdgeUpsell="56",e.OutlookSpacesCapturedPaneFRE="57",e.ProofingTeachingFreeUserFRE="58",e.ProofingTeachingPremiumUserFRE="59",e.OutlookSpacesNotePaneFRE="60",e.OutlookSpacesTasksPaneFRE="61",e.OutlookSpacesGoalsPaneFRE="62",e.DefaultOnlineMeetingSetting="63",e.QuickUseFRE="64",e.GdprAdsV3="65",e.SpeedyMeetingsEndEarlySetting="66",e.InboxPlusEasyOff="67",e.InsertLinkTeachingMomentOpenCompose="68",e.InsertLinkTeachingMomentAfterAttach="69",e.ShortenEventsDurationSetting="70",e.HoneybeeClipboard="71",e.AttachmentSaveToCloudOpenAndEdit="72",e.GdprAdsEPrivacy="73",e.AdminInstalledNewAddinsFRE="75",e.InsertLinkFREOpenCompose="76",e.InsertLinkFREAfterAttach="77",e.SpotlightFre="78",e.OverlayFolderPaneFre="79",e.SpotlightPropertyIcon="80",e.GdprAdsV3ClearNull="81",e.OptionsPaneLaunch="82",e.ThemeOfTheDay="83"}(o||(o={}))},826:function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var o=n(0),i=n(7),a=n(219),r={root:"ms-TeachingBubble",body:"ms-TeachingBubble-body",bodyContent:"ms-TeachingBubble-bodycontent",closeButton:"ms-TeachingBubble-closebutton",content:"ms-TeachingBubble-content",footer:"ms-TeachingBubble-footer",header:"ms-TeachingBubble-header",headerIsCondensed:"ms-TeachingBubble-header--condensed",headerIsSmall:"ms-TeachingBubble-header--small",headerIsLarge:"ms-TeachingBubble-header--large",headline:"ms-TeachingBubble-headline",image:"ms-TeachingBubble-image",primaryButton:"ms-TeachingBubble-primaryButton",secondaryButton:"ms-TeachingBubble-secondaryButton",subText:"ms-TeachingBubble-subText",button:"ms-Button",buttonLabel:"ms-Button-label"},s=Object(a.c)((function(){return Object(i.keyframes)({"0%":{opacity:0,animationTimingFunction:i.AnimationVariables.easeFunction1,transform:"scale3d(.90,.90,.90)"},"100%":{opacity:1,transform:"scale3d(1,1,1)"}})})),c=function(e,t){var n=t||{},o=n.calloutWidth,i=n.calloutMaxWidth;return[{display:"block",maxWidth:364,border:0,outline:"transparent",width:o||"calc(100% + 1px)",animationName:""+s(),animationDuration:"300ms",animationTimingFunction:"linear",animationFillMode:"both"},e&&{maxWidth:i||456}]},l=function(e,t,n){return t?[e.headerIsCondensed,{marginBottom:14}]:[n&&e.headerIsSmall,!n&&e.headerIsLarge,{selectors:{":not(:last-child)":{marginBottom:14}}}]},u=function(e){var t,n,a,s=e.hasCondensedHeadline,u=e.hasSmallHeadline,d=e.hasCloseButton,h=e.hasHeadline,m=e.isWide,b=e.primaryButtonClassName,g=e.secondaryButtonClassName,f=e.theme,p=e.calloutProps,v=void 0===p?{className:void 0,theme:f}:p,y=!s&&!u,C=f.palette,O=f.semanticColors,w=f.fonts,I=Object(i.getGlobalClassNames)(r,f);return{root:[I.root,w.medium,v.className],body:[I.body,d&&!h&&{marginRight:24},{selectors:{":not(:last-child)":{marginBottom:20}}}],bodyContent:[I.bodyContent,{padding:"20px 24px 20px 24px"}],closeButton:[I.closeButton,{position:"absolute",right:0,top:0,margin:"15px 15px 0 0",borderRadius:0,color:C.white,fontSize:w.small.fontSize,selectors:{":hover":{background:C.themeDarkAlt,color:C.white},":active":{background:C.themeDark,color:C.white},":focus":{border:"1px solid "+O.variantBorder}}}],content:Object(o.__spreadArrays)([I.content],c(m),[m&&{display:"flex"}]),footer:[I.footer,{display:"flex",flex:"auto",alignItems:"center",color:C.white,selectors:(t={},t["."+I.button+":not(:first-child)"]={marginLeft:10},t)}],header:Object(o.__spreadArrays)([I.header],l(I,s,u),[d&&{marginRight:24},(s||u)&&[w.medium,{fontWeight:i.FontWeights.semibold}]]),headline:[I.headline,{margin:0,color:C.white,fontWeight:i.FontWeights.semibold},y&&[{fontSize:w.xLarge.fontSize}]],imageContent:[I.header,I.image,m&&{display:"flex",alignItems:"center",maxWidth:154}],primaryButton:[I.primaryButton,b,{backgroundColor:C.white,borderColor:C.white,color:C.themePrimary,whiteSpace:"nowrap",selectors:(n={},n["."+I.buttonLabel]=w.medium,n[":hover"]={backgroundColor:C.themeLighter,borderColor:C.themeLighter,color:C.themePrimary},n[":focus"]={backgroundColor:C.themeLighter,borderColor:C.white},n[":active"]={backgroundColor:C.white,borderColor:C.white,color:C.themePrimary},n)}],secondaryButton:[I.secondaryButton,g,{backgroundColor:C.themePrimary,borderColor:C.white,whiteSpace:"nowrap",selectors:(a={},a["."+I.buttonLabel]=[w.medium,{color:C.white}],a["&:hover, &:focus"]={backgroundColor:C.themeDarkAlt,borderColor:C.white},a[":active"]={backgroundColor:C.themePrimary,borderColor:C.white},a)}],subText:[I.subText,{margin:0,fontSize:w.medium.fontSize,color:C.white,fontWeight:i.FontWeights.regular}],subComponentStyles:{callout:{root:Object(o.__spreadArrays)(c(m,v),[w.medium]),beak:[{background:C.themePrimary}],calloutMain:[{background:C.themePrimary}]}}}}},880:function(e,t,n){"use strict";var o=n(0),i=n(22),a=n(524),r=n(1),s=n.n(r);function c(e,t){var n=function(t,n){return s.a.createElement(l,Object(o.__assign)({},t),s.a.createElement(e,Object(o.__assign)({},t)))};return n.displayName=e.displayName,t?s.a.forwardRef(n):n}var l=Object(i.a)((function(e){var t=e.lid,n=e.when,o=e.series,i=e.children,r=e.disposeOnUnmount,c=void 0===r||r;return s.a.useEffect((function(){return Object(a.b)(t,n,o),function(){c&&a.c.importAndExecute(t)}}),[]),i&&d(t)?s.a.createElement(s.a.Fragment,null,i):null}));function u(e,t){a.c.importAndExecute(e,t)}function d(e){if(a.d.unseenItems){var t=a.d.unseenItems.get(e);if(null==t?void 0:t.visible)return!0}return!1}function h(e){var t;return null===(t=a.d.unseenItems)||void 0===t?void 0:t.has(e)}n.d(t,"d",(function(){return c})),n.d(t,"a",(function(){return l})),n.d(t,"e",(function(){return u})),n.d(t,"f",(function(){return d})),n.d(t,"c",(function(){return h})),n.d(t,"b",(function(){return a.a}))}}]);
//# sourceMappingURL=owa.MailBoot~ActionableMessageMail~Attachments.js.map
self.scriptsLoaded['owa.MailBoot~ActionableMessageMail~Attachments.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.MailBoot~ActionableMessageMail~Attachments.js'] = (new Date()).getTime();