self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.MailBoot~Attachments~ConversationAttachment~SxS.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[153],{10615:function(e,t,n){"use strict";var a=n(151);t.a=Object(a.action)("setShouldShowActionsContainer")((function(e,t){e.shouldShowActionsContainer=t}))},10616:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var a=n(1709),r=n(1662);function o(e){var t=Object(r.a)(e.attachmentId);return!!t&&(!!Object(a.d)(t.model)||t.download.url&&t.info&&t.info.allowDownload)}},10617:function(e,t,n){"use strict";t.a={SurfaceAction:"Surface action",ContextMenu:"Context menu"}},10618:function(e,t,n){"use strict";n.d(t,"a",(function(){return m})),n.d(t,"b",(function(){return b}));var a=n(8747),r=n(6),o=n(114),i=n(1926),c=n(7016),d=n(2464),u=n(10617),l=n(1662),s=n(3118),f=n(3117);function m(e,t){var n=Object(l.a)(e.attachmentId),a=Object(s.a)(n);Object(o.r)("AddToCalendar",[t],{cosmosOnlyData:JSON.stringify({size:n.model.Size,fileType:a})}),n.model.Size>10485760||!e.attachmentId||!e.attachmentId.Id?Object(d.a)(e,0,15):(Object(i.B)(Object(i.j)(n.model.Size),.1,(function(t){Object(i.x)(e,t)}),e.attachmentId),Object(c.a)(e,0))}function b(e){var t=Object(l.a)(e.attachmentId);return Object(f.a)(i.a.ImportCalendarEventAttachment,e)&&t&&13===t.attachmentClass?{name:Object(r.b)(a.a),key:"AddToCalendar",onClick:function(){m(e,u.a.ContextMenu)}}:null}},10850:function(e){e.exports=JSON.parse('{"a":"Sob"}')},10851:function(e){e.exports=JSON.parse('{"a":"qpb"}')},15305:function(e){e.exports=JSON.parse('{"a":"upb","c":"vpb","d":"wpb","b":"xpb","e":"ypb"}')},15306:function(e,t,n){var a=n(15307),r=n(95);"string"==typeof a&&(a=[[e.i,a]]);for(var o=0;o<a.length;o++)r.loadStyles(a[o][1],!1);a.locals&&(e.exports=a.locals)},15307:function(e,t,n){(t=e.exports=n(94)(!1)).push([e.i,'._2KRgryadS8K-_TLdBoNKmd{font-size:14px;color:"[theme:neutralSecondary, default:#605e5c]";height:25px;width:26px}html[dir] ._2KRgryadS8K-_TLdBoNKmd{padding:4px;text-align:center}._2KRgryadS8K-_TLdBoNKmd:focus,._2KRgryadS8K-_TLdBoNKmd:hover,._1eq1P1PoHUzBriyfNWVd1T{color:"[theme:neutralSecondary, default:#605e5c]"}._1eq1P1PoHUzBriyfNWVd1T{display:block}.HDG8P1QaVRBOeSU0W5zmW{bottom:0;position:absolute;color:"[theme:white, default:#ffffff]"}html[dir=ltr] .HDG8P1QaVRBOeSU0W5zmW{right:26px}html[dir=rtl] .HDG8P1QaVRBOeSU0W5zmW{left:26px}.HDG8P1QaVRBOeSU0W5zmW:focus,.HDG8P1QaVRBOeSU0W5zmW:hover{color:"[theme:white, default:#ffffff]"}html[dir] .HDG8P1QaVRBOeSU0W5zmW:focus,html[dir] .HDG8P1QaVRBOeSU0W5zmW:hover{background:"[theme:blackTranslucent40, default:rgba(0, 0, 0, .4)]"}html[dir=ltr] .HDG8P1QaVRBOeSU0W5zmW:focus,html[dir=ltr] .HDG8P1QaVRBOeSU0W5zmW:hover{border-bottom-right-radius:2px}html[dir=rtl] .HDG8P1QaVRBOeSU0W5zmW:focus,html[dir=rtl] .HDG8P1QaVRBOeSU0W5zmW:hover{border-bottom-left-radius:2px}html[dir=ltr] .HDG8P1QaVRBOeSU0W5zmW._2RdXhaKvBvt2MX9AyW7pcR{right:52px}html[dir=rtl] .HDG8P1QaVRBOeSU0W5zmW._2RdXhaKvBvt2MX9AyW7pcR{left:52px}._2ebptdF8eCnt_2-FT7dzaH{font-size:14px}html[dir] ._2ebptdF8eCnt_2-FT7dzaH{margin:0}html[dir] .IPPU7NtLHAzlPwHTIXmXp:focus,html[dir] .IPPU7NtLHAzlPwHTIXmXp:hover{background:"[theme:neutralTertiaryAlt, default:#c8c6c4]"}html[dir] .rPIl3tr-13EegQ4JcXUy_,html[dir] ._3vsJWDG9Ae71RWCd-gnOXq,html[dir] ._17q1sDoo-1SD8o99_vx_Wl,html[dir] ._1H8nRWpPKM9iogJAm6ze6p,html[dir] ._3bO0ii_CywH_7ysZAUsxkB,html[dir] ._1E-xlZkNQ0oWd42XQohXqv{margin:0;background-color:"[theme:themeLight, default:#C7E0F4]"}html[dir] .rPIl3tr-13EegQ4JcXUy_:focus,html[dir] .rPIl3tr-13EegQ4JcXUy_:hover,html[dir] ._3vsJWDG9Ae71RWCd-gnOXq:focus,html[dir] ._3vsJWDG9Ae71RWCd-gnOXq:hover,html[dir] ._17q1sDoo-1SD8o99_vx_Wl:focus,html[dir] ._17q1sDoo-1SD8o99_vx_Wl:hover,html[dir] ._1H8nRWpPKM9iogJAm6ze6p:focus,html[dir] ._1H8nRWpPKM9iogJAm6ze6p:hover,html[dir] ._3bO0ii_CywH_7ysZAUsxkB:focus,html[dir] ._3bO0ii_CywH_7ysZAUsxkB:hover,html[dir] ._1E-xlZkNQ0oWd42XQohXqv:focus,html[dir] ._1E-xlZkNQ0oWd42XQohXqv:hover{background:"[theme:themeTertiary, default:#71AFE5]"}html[dir] .rPIl3tr-13EegQ4JcXUy_{background-color:"[theme:themeLighterAlt, default:#EFF6FC]"}',""]),t.locals={actionButton:"_2KRgryadS8K-_TLdBoNKmd",actionButtonForDocViewInCompose:"_1eq1P1PoHUzBriyfNWVd1T",actionButtonForImageView:"HDG8P1QaVRBOeSU0W5zmW",extraRightPadding:"_2RdXhaKvBvt2MX9AyW7pcR",icon:"_2ebptdF8eCnt_2-FT7dzaH",default:"IPPU7NtLHAzlPwHTIXmXp",edit:"rPIl3tr-13EegQ4JcXUy_",notSelectedAndSaving:"_3vsJWDG9Ae71RWCd-gnOXq",selected:"_17q1sDoo-1SD8o99_vx_Wl",selectedAndPending:"_1H8nRWpPKM9iogJAm6ze6p",selectedAndSaving:"_3bO0ii_CywH_7ysZAUsxkB",thematic:"_1E-xlZkNQ0oWd42XQohXqv"}},1662:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var a=n(1809);function r(e){return Object(a.a)().attachments.get(e.Id)}},1747:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var a=n(0);function r(e){return Object(a.__assign)({__type:"IndexedPageView:#Exchange"},e)}},1781:function(e,t,n){"use strict";var a;function r(){return[a.noPermissionToShare,a.getSharingInfoFailed,a.linkHasExpired,a.linkWillExpire,a.noPermissionToShareExternally,a.externalRecipientCSL,a.noPermissionSet,a.sharingWithLargeDL]}n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return r})),function(e){e.noPermissionToShare="WarningNoPermissionToShare",e.getSharingInfoFailed="WarningGetSharingInfoFailed",e.linkHasExpired="WarningLinksHasExpired",e.linkWillExpire="WarningLinksWillExpire",e.noPermissionToShareExternally="WarningExternalRecipientButNoPermissionToShareExternally",e.externalRecipientCSL="WarningExternalRecipientsCannotOpenCSLs",e.noPermissionSet="WarningOnlyPeopleWithExistingAccessCanAccess",e.sharingWithLargeDL="WarningNotAllMembersOfDLCanAccess"}(a||(a={}))},1822:function(e,t){e.exports=function(e){return e instanceof Date}},1874:function(e,t,n){var a=n(1822),r=36e5,o=6e4,i=2,c=/[T ]/,d=/:/,u=/^(\d{2})$/,l=[/^([+-]\d{2})$/,/^([+-]\d{3})$/,/^([+-]\d{4})$/],s=/^(\d{4})/,f=[/^([+-]\d{4})/,/^([+-]\d{5})/,/^([+-]\d{6})/],m=/^-(\d{2})$/,b=/^-?(\d{3})$/,p=/^-?(\d{2})-?(\d{2})$/,h=/^-?W(\d{2})$/,v=/^-?W(\d{2})-?(\d{1})$/,O=/^(\d{2}([.,]\d*)?)$/,w=/^(\d{2}):?(\d{2}([.,]\d*)?)$/,g=/^(\d{2}):?(\d{2}):?(\d{2}([.,]\d*)?)$/,S=/([Z+-].*)$/,j=/^(Z)$/,I=/^([+-])(\d{2})$/,C=/^([+-])(\d{2}):?(\d{2})$/;function A(e,t,n){t=t||0,n=n||0;var a=new Date(0);a.setUTCFullYear(e,0,4);var r=7*t+n+1-(a.getUTCDay()||7);return a.setUTCDate(a.getUTCDate()+r),a}e.exports=function(e,t){if(a(e))return new Date(e.getTime());if("string"!=typeof e)return new Date(e);var n=(t||{}).additionalDigits;n=null==n?i:Number(n);var x=function(e){var t,n={},a=e.split(c);d.test(a[0])?(n.date=null,t=a[0]):(n.date=a[0],t=a[1]);if(t){var r=S.exec(t);r?(n.time=t.replace(r[1],""),n.timezone=r[1]):n.time=t}return n}(e),T=function(e,t){var n,a=l[t],r=f[t];if(n=s.exec(e)||r.exec(e)){var o=n[1];return{year:parseInt(o,10),restDateString:e.slice(o.length)}}if(n=u.exec(e)||a.exec(e)){var i=n[1];return{year:100*parseInt(i,10),restDateString:e.slice(i.length)}}return{year:null}}(x.date,n),y=T.year,_=function(e,t){if(null===t)return null;var n,a,r,o;if(0===e.length)return(a=new Date(0)).setUTCFullYear(t),a;if(n=m.exec(e))return a=new Date(0),r=parseInt(n[1],10)-1,a.setUTCFullYear(t,r),a;if(n=b.exec(e)){a=new Date(0);var i=parseInt(n[1],10);return a.setUTCFullYear(t,0,i),a}if(n=p.exec(e)){a=new Date(0),r=parseInt(n[1],10)-1;var c=parseInt(n[2],10);return a.setUTCFullYear(t,r,c),a}if(n=h.exec(e))return o=parseInt(n[1],10)-1,A(t,o);if(n=v.exec(e)){o=parseInt(n[1],10)-1;var d=parseInt(n[2],10)-1;return A(t,o,d)}return null}(T.restDateString,y);if(_){var W,P=_.getTime(),D=0;return x.time&&(D=function(e){var t,n,a;if(t=O.exec(e))return(n=parseFloat(t[1].replace(",",".")))%24*r;if(t=w.exec(e))return n=parseInt(t[1],10),a=parseFloat(t[2].replace(",",".")),n%24*r+a*o;if(t=g.exec(e)){n=parseInt(t[1],10),a=parseInt(t[2],10);var i=parseFloat(t[3].replace(",","."));return n%24*r+a*o+1e3*i}return null}(x.time)),x.timezone?W=function(e){var t,n;if(t=j.exec(e))return 0;if(t=I.exec(e))return n=60*parseInt(t[2],10),"+"===t[1]?-n:n;if(t=C.exec(e))return n=60*parseInt(t[2],10)+parseInt(t[3],10),"+"===t[1]?-n:n;return 0}(x.timezone):(W=new Date(P+D).getTimezoneOffset(),W=new Date(P+D+W*o).getTimezoneOffset()),new Date(P+D+W*o)}return new Date(e)}},1916:function(e,t,n){"use strict";var a;n.d(t,"a",(function(){return a})),function(e){e[e.InProgress=0]="InProgress",e[e.Failed=1]="Failed",e[e.Succeeded=2]="Succeeded"}(a||(a={}))},1937:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var a=n(2),r=Object(a.action)("REFRESH_EXPIRATION_DATE",(function(e){return{id:e}}))},1938:function(e,t,n){"use strict";var a;n.d(t,"a",(function(){return a})),function(e){e[e.ignore=0]="ignore",e[e.refreshExpiration=1]="refreshExpiration",e[e.changePermission=2]="changePermission",e[e.attachAsACopy=3]="attachAsACopy"}(a||(a={}))},1967:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return o}));var a=n(1848);function r(e){return i(e.type)}function o(e){return i(Object(a.a)(e))}function i(e){return 1===e||3===e}},2004:function(e,t,n){"use strict";n.d(t,"h",(function(){return u})),n.d(t,"i",(function(){return l})),n.d(t,"f",(function(){return s})),n.d(t,"k",(function(){return f})),n.d(t,"m",(function(){return m})),n.d(t,"e",(function(){return b})),n.d(t,"g",(function(){return p})),n.d(t,"j",(function(){return h})),n.d(t,"l",(function(){return v}));var a=n(36),r=n(1937);n.d(t,"n",(function(){return r.a}));var o=n(1916);n.d(t,"a",(function(){return o.a}));var i=n(1781);n.d(t,"d",(function(){return i.b})),n.d(t,"c",(function(){return i.a}));var c=n(1938);n.d(t,"b",(function(){return c.a}));var d=new a.c((function(){return Promise.all([n.e(3),n.e(31),n.e(69),n.e(745)]).then(n.bind(null,3081))})),u=new a.b(d,(function(e){return e.getSharingInformation})),l=new a.b(d,(function(e){return e.getSharingIssuesForSharingData})),s=new a.b(d,(function(e){return e.getInfoBarCreator})),f=new a.b(d,(function(e){return e.hasLargeDLRecipient})),m=new a.b(d,(function(e){return e.hasRecipientExpansionFailure})),b=new a.b(d,(function(e){return e.getGroupsAndSmallDLs})),p=new a.b(d,(function(e){return e.getInvididualRecipients})),h=new a.b(d,(function(e){return e.hasGetRecipientPermissionFailed})),v=new a.b(d,(function(e){return e.logSharingTipChangesForLinkRemoval}))},2448:function(e,t,n){"use strict";function a(e,t){(t||window).open(e,"_blank")}n.d(t,"a",(function(){return a}))},2559:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var a=n(2448),r=n(114),o=n(89);function i(e,t,n,i){var c;if(Object(r.r)("downloadFileFromUrl",{isBrowserIE:Object(o.g)(),urlLength:e.length}),t||Object(o.g)())Object(a.a)(e);else{var d=document.createElement("a");d.style.display="none",d.href=e,d.download=i||"",n||(n=(null===(c=document.activeElement)||void 0===c?void 0:c.parentElement)||document.body),n.appendChild(d),d.click(),n.removeChild(d)}}},3117:function(e,t,n){"use strict";function a(e,t){return-1!==t.strategy.supportedMenuActions.indexOf(e)}n.d(t,"a",(function(){return a}))},3179:function(e,t,n){"use strict";var a=n(36),r=n(1767),o=n(0),i=n(1709),c=n(1662),d=n(2559),u=n(2148);function l(e,t,n){return Object(o.__awaiter)(this,void 0,void 0,(function(){var a,r;return Object(o.__generator)(this,(function(o){switch(o.label){case 0:return(a=Object(c.a)(e))?Object(i.d)(a.model)?[4,u.e.import()]:[3,2]:[2];case 1:return o.sent()(a.model),[3,3];case 2:(r=a.download.url)&&Object(d.a)(r,t,n),o.label=3;case 3:return[2]}}))}))}n.d(t,"c",(function(){return f})),n.d(t,"d",(function(){return m})),n.d(t,"a",(function(){return r.c})),n.d(t,"b",(function(){return l}));var s=new a.c((function(){return Promise.all([n.e(0),n.e(1),n.e(2),n.e(3),n.e(21),n.e(23),n.e(30),n.e(28),n.e(31),n.e(41),n.e(44),n.e(43),n.e(55),n.e(64),n.e(65),n.e(70),n.e(95),n.e(106),n.e(153),n.e(154),n.e(214),n.e(213),n.e(212),n.e(199),n.e(319)]).then(n.bind(null,17518))})),f=new a.a(s,(function(e){return e.clickAttachment})).importAndExecute,m=new a.a(s,(function(e){return e.previewAttachment}))},4494:function(e,t,n){"use strict";function a(e){switch(e){case"csv":case"ods":case"xls":case"xlsb":case"xlsm":case"xlsx":return"Excel";case"odp":case"pot":case"potm":case"potx":case"pps":case"ppsm":case"ppsx":case"ppt":case"pptm":case"pptx":return"PowerPoint";case"vsd":case"vsdm":case"vsdx":return"Visio";case"doc":case"docm":case"docx":case"dot":case"dotm":case"dotx":case"odt":case"rtf":return"Word";default:return""}}n.d(t,"a",(function(){return a}))},4507:function(e,t,n){"use strict";var a;n.d(t,"a",(function(){return a})),function(e){e[e.saveToCloud=0]="saveToCloud",e[e.download=1]="download",e[e.addToCalendar=2]="addToCalendar",e[e.editAndReply=3]="editAndReply",e[e.openNewTabAndSaveToCloud=4]="openNewTabAndSaveToCloud",e[e.openAndEdit=5]="openAndEdit"}(a||(a={}))},4712:function(e){e.exports=JSON.parse('{"a":"rpb"}')},4817:function(e){e.exports=JSON.parse('{"f":"lob","a":"mob","e":"nob","d":"oob","c":"pob","b":"qob"}')},702:function(e,t,n){"use strict";var a=n(36),r={ChannelData:"ChannelData",SubscriptionAdded:"SubscriptionAdded",SubscriptionRemoved:"SubscriptionRemoved",SubscriptionUpdated:"SubscriptionUpdated",NotificationData:"NotificationData",TraceWarn:"TraceWarn",TraceError:"TraceError"};n.d(t,"f",(function(){return i})),n.d(t,"g",(function(){return c})),n.d(t,"b",(function(){return d})),n.d(t,"e",(function(){return u})),n.d(t,"d",(function(){return l})),n.d(t,"c",(function(){return s})),n.d(t,"a",(function(){return r}));var o=new a.c((function(){return Promise.all([n.e(3),n.e(23),n.e(668)]).then(n.bind(null,17229))})),i=new a.a(o,(function(e){return e.subscribe})),c=new a.a(o,(function(e){return e.unsubscribe})),d=new a.b(o,(function(e){return e.getChannelId})),u=(new a.b(o,(function(e){return e.getChannelReady})),new a.a(o,(function(e){return e.setup}))),l=new a.a(o,(function(e){return e.initializeNotificationManager})),s=new a.b(o,(function(e){return e.getNotificationEmitter}))},7227:function(e,t,n){"use strict";n.d(t,"b",(function(){return d})),n.d(t,"a",(function(){return u})),n.d(t,"c",(function(){return l})),n.d(t,"d",(function(){return s}));var a=n(10615),r=n(4783),o=n(4784),i={},c=null;function d(e,t){i[e.attachmentId.Id]&&(clearTimeout(i[e.attachmentId.Id]),i[e.attachmentId.Id]=null),c=e.attachmentId.Id,Object(a.a)(e,!0),t&&!Object(o.a)(e)&&Object(r.a)(e,!0)}function u(e,t){i[e.attachmentId.Id]&&clearTimeout(i[e.attachmentId.Id]),i[e.attachmentId.Id]=setTimeout((function(){Object(a.a)(e,!1),t&&!Object(o.a)(e)&&Object(r.a)(e,!1),e.attachmentId.Id===c&&(c=null),i[e.attachmentId.Id]=null}),40)}function l(e,t){Object(a.a)(e,!0),t&&!Object(o.a)(e)&&Object(r.a)(e,!0)}function s(e,t){e.attachmentId.Id!==c&&(Object(a.a)(e,!1),t&&!Object(o.a)(e)&&Object(r.a)(e,!1))}},7228:function(e){e.exports=JSON.parse('{"a":"Gob"}')},7229:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var a=n(1662),r=n(1654),o=n(4494);function i(e){var t=Object(a.a)(e),n=Object(r.c)(t.model.Name||"");return""!==Object(o.a)(n)&&"Visio"!==Object(o.a)(n)}},7230:function(e,t,n){"use strict";n.d(t,"a",(function(){return f}));var a=n(96),r=n(1926),o=n(10616),i=n(33),c=n(233),d=n(4507),u=n(3117),l=n(7229),s=n(7231);function f(e,t){if(0!==t.ongoingAction||!t.strategy.showActionsMenu)return!0;switch(e){case d.a.addToCalendar:return!1;case d.a.download:return!Object(u.a)(r.a.Download,t)||!Object(o.a)(t);case d.a.saveToCloud:case d.a.openNewTabAndSaveToCloud:return!t.isReadOnly||!function(e,t){var n,a=Object(c.a)()&&"GroupMailbox"===(null===(n=e.attachmentId.mailboxInfo)||void 0===n?void 0:n.type),o=!1;o=t===d.a.openNewTabAndSaveToCloud?Object(s.a)()&&Object(l.a)(e.attachmentId):Object(i.i)("woven-saveToCloud2-viewInOneDrive")||Object(i.i)("woven-saveToCloud2-editInOneDrive")||Object(i.i)("woven-saveToCloud2-editInApp")||Object(i.i)("woven-saveToCloud2-editOnline")||Object(i.i)("woven-saveToCloud2-openFolder")||Object(i.i)("wvn-productizeSTCHoverActionOnly")||m()||Object(i.i)("wvn-productizeSTCHoverAndCloudWithTeaching")||Object(i.i)("wvn-productizeSTCChicletAndPreview")||Object(s.a)();return o&&Object(u.a)(r.a.SaveToCloud,e)&&Object(r.t)(e)&&!a}(t,e);case d.a.editAndReply:return!t.isReadOnly||!Object(l.a)(t.attachmentId);case d.a.openAndEdit:return!t.isReadOnly||!(m()||Object(i.i)("wvn-productizeSTCHoverAndCloudWithTeaching")||Object(i.i)("wvn-productizeSTCChicletAndPreview"))||2!==t.actionMessage&&3!==t.actionMessage;default:return Object(a.a)(e)}}function m(){var e=Object(i.i)("wvn-chicletEditOptions")||Object(i.i)("wvn-chicletEditOptionsNoDownload");return Object(i.i)("wvn-productizeSTCHoverAndCloud")&&!e}},7231:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var a=n(715),r=n(33);function o(){return Object(r.i)("woven-newTabExperiment")&&Object(a.d)()}},8745:function(e,t,n){"use strict";n.d(t,"b",(function(){return u})),n.d(t,"g",(function(){return l}));var a=n(36),r=n(8746);n.d(t,"f",(function(){return r.a}));var o=n(4507);n.d(t,"e",(function(){return o.a}));var i=n(9195);n.d(t,"a",(function(){return i.a}));var c=n(4817);n.d(t,"c",(function(){return c.a})),n.d(t,"d",(function(){return c.e}));var d=new a.c((function(){return Promise.all([n.e(0),n.e(1),n.e(2),n.e(3),n.e(21),n.e(23),n.e(30),n.e(28),n.e(31),n.e(41),n.e(44),n.e(43),n.e(55),n.e(64),n.e(65),n.e(70),n.e(95),n.e(106),n.e(153),n.e(154),n.e(214),n.e(213),n.e(212),n.e(199),n.e(319)]).then(n.bind(null,16734))})),u=Object(a.d)(d,(function(e){return e.AttachmentView})),l=new a.b(d,(function(e){return e.getContextMenus}))},8746:function(e,t,n){"use strict";t.a={OnClick:{name:"AttachmentOnClick",customData:function(e){return[e]}}}},8747:function(e){e.exports=JSON.parse('{"a":"Qob"}')},8748:function(e,t,n){"use strict";var a=n(1632);t.a=function(e){var t,n,r=e&&Object(a.v)(e);return null===(n=null===(t=(null==r?void 0:r.From)||(null==r?void 0:r.Sender))||void 0===t?void 0:t.Mailbox)||void 0===n?void 0:n.EmailAddress}},9195:function(e,t,n){"use strict";var a=n(22),r=n(699),o=n(54),i=n(1713),c=n(23),d=n(1),u=n(4507),l=n(7227),s=n(96),f=n(6),m=n(8747),b=n(7228),p=n(15305),h=n(7229);var v=n(7230),O=n(0),w=n(114),g=n(1926),S=n(10617),j=n(10618),I=n(1709),C=n(1662),A=n(3118),x=n(3179),T=n(2559),y=n(203),_=n(4148),W=n(2148),P=n(569),D=n(31),R="/"+Object(O.__spread)(["mail"],Object(P.a)().split("/").slice(1)).join("/")+"deeplink/saveAndEdit/";var E=n(8748);function B(e,t,n,a){var r,o,d,l=Object(i.k)(a);switch(e){case u.a.addToCalendar:Object(j.a)(t,S.a.SurfaceAction);break;case u.a.download:!function(e,t){var n,a;Object(O.__awaiter)(this,void 0,void 0,(function(){var r,o,i,d,u,l,s,f;return Object(O.__generator)(this,(function(m){switch(m.label){case 0:return(r=Object(C.a)(e.attachmentId))?Object(I.d)(r.model)?[4,W.e.import()]:[3,2]:(c.d("AttachmentSurfaceActionButton.downloadAttachment attachmentModel is null"),[2]);case 1:return m.sent()(r.model),[3,3];case 2:Object(T.a)(r.download.url,e.isCloudy,document.body),m.label=3;case 3:return o=Object(A.a)(r),Object(w.r)("AttachmentDownload",{entryPoint:"SurfaceAction",isCloudy:e.isCloudy,isCompose:!e.isReadOnly},{cosmosOnlyData:JSON.stringify({size:r.model.Size,fileType:o,attachmentId:null===(n=r.model.AttachmentId)||void 0===n?void 0:n.Id})}),i=null==t?void 0:t.Id,u=(d=w.o).importAndExecute,l=["SavedAttachment"],f={},(s=i)?[4,Object(_.a)(i)]:[3,5];case 4:s=m.sent(),m.label=5;case 5:return u.apply(d,l.concat([(f.itemId=s,f.customProperties={FileId:null===(a=r.model.AttachmentId)||void 0===a?void 0:a.Id,FileType:o,Destination:"Local",Sender:Object(E.a)(i)},f)])),[2]}}))}))}(t,n);break;case u.a.saveToCloud:!function(e,t,n){var a,r=Object(C.a)(e.attachmentId);if(!r)return void c.d("AttachmentSurfaceActionButton.saveToCloud attachmentModel is null");Object(w.r)("AttachmentSaveToCloud",{entryPoint:"SurfaceAction"},{cosmosOnlyData:JSON.stringify({size:r.model.Size,fileType:Object(A.a)(r),attachmentId:null===(a=r.model.AttachmentId)||void 0===a?void 0:a.Id}),isCore:!0}),Object(g.B)(Object(g.p)(e.attachmentId),.1,(function(t){Object(g.x)(e,t)}),e.attachmentId),Object(g.u)(e,(function(t){Object(g.C)(e.attachmentId,t)}),"SurfaceAction",t,Object(E.a)(null==t?void 0:t.Id),n)}(t,n,l);break;case u.a.editAndReply:!function(e,t,n){Object(O.__awaiter)(this,void 0,void 0,(function(){var n,a;return Object(O.__generator)(this,(function(r){switch(r.label){case 0:return[4,x.d.import()];case 1:return n=r.sent(),Object(w.r)("WovenEditAndReplyFromSurface",{},{isCore:!0}),a={viewState:e,attachmentSelectionSource:i.b.ReadingPane,parentItemId:t,isDraft:!1,isEdit:!0,onBeforePreview:function(){return null},createImageGallery:function(){return null},instrumentationContext:null,targetWindow:window},n(a),[2]}}))}))}(t,n);break;case u.a.openNewTabAndSaveToCloud:!function(e,t,n){var a=Object(y.a)();!function(e,t,n){var a=""+R;a+=encodeURIComponent(null==n?void 0:n.Id)+"/"+encodeURIComponent(e)+"/"+encodeURIComponent(t)+"/"+Object(D.a)().search,window.open(a,"_blank")}(e.attachmentId.Id,a,t);var r=new w.b("WovenNewTabSaveToCloud",{isCore:!0});Object(g.B)(4*Object(g.p)(e.attachmentId),.1,(function(t){Object(g.x)(e,t)}),e.attachmentId),Object(g.D)(e,(function(t){Object(g.C)(e.attachmentId,t),t?r.end():r.endWithError("ServerError")}),"PencilExperiment",t,a,Object(E.a)(null==t?void 0:t.Id),n)}(t,n,l);break;case u.a.openAndEdit:r=t,o=Object(C.a)(r.attachmentId).model.AttachmentOriginalUrl,d=-1===o.indexOf("?")?"?":"&",window.open(o+d+"web=1","_blank"),Object(w.r)("WovenOpenAndEditFromSurface",{},{isCore:!0});break;default:Object(s.a)(e)}}var N=n(2083),z=n(15306),k=n(395).bind(z);t.a=Object(a.a)((function(e){var t=d.useContext(N.a),n=e.action,a=e.attachmentViewState,O=e.customClassName,w=e.isForImageView,g=e.previewState;if(Object(v.a)(n,a))return null;var S=void 0,j=function(e){switch(e){case i.a.Edit:return z.edit;case i.a.NotSelectedAndSaving:return z.notSelectedAndSaving;case i.a.OtherSaving:return z.attachmentView;case i.a.Selected:return z.selected;case i.a.SelectedAndPending:return z.selectedAndPending;case i.a.SelectedAndSaving:return z.selectedAndSaving;default:return z.default}}(g);if(w){var I={extraRightPadding:F(n,a)};S=k([z.actionButton,z.actionButtonForImageView,O,I])}else S=a.isReadOnly?k([z.actionButton,j,O]):k([z.actionButton,j,z.actionButtonForDocViewInCompose,O]);var C=function(e,t){switch(e){case u.a.addToCalendar:return"AddEvent";case u.a.download:return"Download";case u.a.saveToCloud:return"CloudUpload";case u.a.openNewTabAndSaveToCloud:return"Edit";case u.a.editAndReply:return"PencilReply";case u.a.openAndEdit:return Object(h.a)(t)?"CloudEdit":"Cloud";default:return Object(s.a)(e)}}(n,a.attachmentId),A=function(e,t){switch(e){case u.a.addToCalendar:return Object(f.b)(m.a);case u.a.download:return Object(f.b)(b.a);case u.a.saveToCloud:return Object(f.b)(p.d);case u.a.openNewTabAndSaveToCloud:return Object(f.b)(p.c);case u.a.editAndReply:return Object(f.b)(p.a);case u.a.openAndEdit:return Object(h.a)(t)?Object(f.b)(p.b):Object(f.b)(p.e);default:return Object(s.a)(e)}}(n,a.attachmentId);return d.createElement(r.a,{onFocus:function(){return Object(l.b)(e.attachmentViewState,e.isForImageView)},onBlur:function(){e.shouldNotHandleOnBlur||Object(l.a)(e.attachmentViewState,e.isForImageView)},onKeyDown:function(n){n.keyCode!==o.a.enter&&n.keyCode!==o.a.space||(c.g.info("AttachmentSurfaceActionButton.keyDown enter|space"),n.stopPropagation(),B(e.action,e.attachmentViewState,e.parentItemId,t))},ariaLabel:A,title:A,onClick:function(n){c.g.info("AttachmentSurfaceActionButton.onclick"),n.stopPropagation(),B(e.action,e.attachmentViewState,e.parentItemId,t)},className:S,iconProps:{iconName:C,styles:{root:z.icon}}})}));function F(e,t){return(e===u.a.saveToCloud||e===u.a.editAndReply||e===u.a.openNewTabAndSaveToCloud||e===u.a.openAndEdit)&&!Object(v.a)(u.a.download,t)}}}]);
//# sourceMappingURL=owa.MailBoot~Attachments~ConversationAttachment~SxS.js.map
self.scriptsLoaded['owa.MailBoot~Attachments~ConversationAttachment~SxS.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.MailBoot~Attachments~ConversationAttachment~SxS.js'] = (new Date()).getTime();