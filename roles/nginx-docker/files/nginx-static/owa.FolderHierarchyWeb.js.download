self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.FolderHierarchyWeb.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[420],{1637:function(e,r,n){"use strict";n.d(r,"f",(function(){return t})),n.d(r,"d",(function(){return o})),n.d(r,"j",(function(){return i})),n.d(r,"a",(function(){return d})),n.d(r,"g",(function(){return u})),n.d(r,"b",(function(){return l})),n.d(r,"h",(function(){return a})),n.d(r,"l",(function(){return s})),n.d(r,"k",(function(){return c})),n.d(r,"i",(function(){return f})),n.d(r,"c",(function(){return v})),n.d(r,"e",(function(){return I}));var t=["journal","outbox","syncissues"],o="archivemsgfolderroot",i="msgfolderroot",d="archivedeleteditems",u="deleteditems",l="archiverecoverableitemsdeletions",a="recoverableitemsdeletions",s="msgfolderroot",c="sharedFolderTree",f="primaryFolderTree",v="archiveFolderTree",I="favorites"},1686:function(e,r,n){"use strict";n.d(r,"a",(function(){return d}));var t=n(0),o=n(1689),i=n(1690);function d(e){var r,n;if(!e)return Promise.reject(Object(o.a)("500","Server returned a null response!",null));var d=Array.isArray(e)?e:[e];try{for(var u=Object(t.__values)(d),l=u.next();!l.done;l=u.next()){var a=l.value;if(a&&!Object(i.a)(a))return Promise.reject(Object(o.a)(a.ResponseCode,a.StackTrace,a.MessageText))}}catch(e){r={error:e}}finally{try{l&&!l.done&&(n=u.return)&&n.call(u)}finally{if(r)throw r.error}}return Promise.resolve()}},1689:function(e,r,n){"use strict";function t(e,r,n){var t="ResponseCode="+e;r&&(t+=", Stacktrace="+r);var o=new Error(t);return o.responseCode=e,o.fetchErrorType="ServerFailure",n&&(o.diagnosticInfo="MessageText= "+n),o}n.d(r,"a",(function(){return t}))},1690:function(e,r,n){"use strict";n.d(r,"a",(function(){return o}));var t="Success";function o(e){return e&&e.ResponseClass==t}},1747:function(e,r,n){"use strict";n.d(r,"a",(function(){return o}));var t=n(0);function o(e){return Object(t.__assign)({__type:"IndexedPageView:#Exchange"},e)}},17570:function(e,r,n){"use strict";n.r(r);var t=n(0),o=n(2472),i=n(706),d=n(3644),u=n(3564),l=n(2674),a=n(782),s=n(161),c=n(1747),f=1e3;function v(e,r,n,t,o){void 0===r&&(r=0),void 0===o&&(o="UserMailbox");var v,I=function(e,r){return Object(u.a)({FolderShape:Object(l.a)({BaseShape:"IdOnly",AdditionalProperties:[Object(a.a)({FieldURI:"DistinguishedFolderId"}),Object(a.a)({FieldURI:"FolderClass"}),Object(a.a)({FieldURI:"FolderDisplayName"}),Object(a.a)({FieldURI:"ParentFolderId"}),Object(a.a)({FieldURI:"TotalCount"}),Object(a.a)({FieldURI:"UnreadCount"})]}),Paging:Object(c.a)({BasePoint:"Beginning",Offset:r,MaxEntriesReturned:f}),ParentFolderIds:e,ReturnParentFolder:!0,ShapeName:"Folder",Traversal:"Deep"})}(e.map((function(e){return Object(i.a)({Id:e})})),r);return n&&t&&(v={mailboxInfo:{userIdentity:n,mailboxSmtpAddress:t,type:o}}),Object(d.a)({Header:Object(s.b)(),Body:I},v||void 0).then((function(e){var r,n,t,i,d,u;return"SharedMailbox"==o&&(null===(t=null===(n=null===(r=null==e?void 0:e.Body)||void 0===r?void 0:r.ResponseMessages)||void 0===n?void 0:n.Items)||void 0===t?void 0:t[0])&&"Success"!==e.Body.ResponseMessages.Items[0].ResponseClass&&e.Body.ResponseMessages.Items.length>1?e.Body.ResponseMessages.Items[1]:null===(u=null===(d=null===(i=null==e?void 0:e.Body)||void 0===i?void 0:i.ResponseMessages)||void 0===d?void 0:d.Items)||void 0===u?void 0:u[0]}))}var I=n(1686);n.d(r,"folderHierarchyWeb",(function(){return F}));var F=function(e,r,n,i){return Object(t.__awaiter)(void 0,void 0,void 0,(function(){var e,n,i,d;return Object(t.__generator)(this,(function(t){switch(t.label){case 0:return e=r.indexedPageOffset||0,n=r.foldersToShowFirst||[],i=r.mailboxInfo.type,[4,v(r.baseFolderDistinguishedIds,e,r.mailboxInfo.userIdentity,r.mailboxInfo.mailboxSmtpAddress,i)];case 1:return d=t.sent(),[2,Object(I.a)(d).then((function(){return d?Object(o.b)(d,r.mailboxInfo,n,!!r.shouldShowJunkEmailFolder,!!r.shouldShowNotesFolder,!!r.shouldPopulateChildFolderIds):null}))]}}))}))}},2472:function(e,r,n){"use strict";var t=function(e,r){var n,t;if(e.ExtendedProperty)for(var o=0;o<e.ExtendedProperty.length;o++){var i=e.ExtendedProperty[o];if((null===(n=null==i?void 0:i.ExtendedFieldURI)||void 0===n?void 0:n.PropertyTag)===r||(null===(t=null==i?void 0:i.ExtendedFieldURI)||void 0===t?void 0:t.PropertyName)===r)return i.Value}},o=function(e){var r=t(e,"SourceWellKnownFolderType");return r&&parseInt(r,10)||-1},i=function(e){return t(e,"0x7018")||null},d=function(e){return"false"!==t(e,"0x10f4")},u=n(1637),l=n(23);function a(e,r,n,t,o,i,l){var a,c=e.RootFolder;if(!c||!c.Folders||!c.ParentFolder)throw new Error("folderHierarchyWeb: failed to get folders");var f=[];null==c||c.Folders.forEach((function(e){if(e&&function(e,r,n){if(t=null==e?void 0:e.__type,"Folder:#Exchange"!=t)return!1;var t;if((null==e?void 0:e.DistinguishedFolderId)&&u.f.indexOf(e.DistinguishedFolderId)>=0)return!1;if(d(e))return!1;if("clutter"===e.DistinguishedFolderId&&0===e.TotalCount)return!1;if("junkemail"===e.DistinguishedFolderId)return!!r;if("notes"===e.DistinguishedFolderId)return!!n;return!0}(e,t,o)){var n=s(e,r);if(n&&(f.push(n),null==l?void 0:l[n.FolderId.Id])){var i=l[n.FolderId.Id];n.ReplicaList=i,n.mailboxInfo.auxiliaryMailboxGuid=i[0]}}}));var v=function(e,r){return"SharedMailbox"===r?void 0:e}((null===(a=null==c?void 0:c.ParentFolder)||void 0===a?void 0:a.DistinguishedFolderId)||"none",r.type);c.ParentFolder.DistinguishedFolderId=v;var I=s(c.ParentFolder,r);return i&&function(e,r,n){if(e){var t={},o={},i=[];t[e.FolderId.Id]=e,i.push(e.FolderId.Id),r.forEach((function(e){e&&(t[e.FolderId.Id]=e,i.push(e.FolderId.Id))})),i.forEach((function(e){var r,n=t[e],i=null===(r=n.ParentFolderId)||void 0===r?void 0:r.Id;n.DistinguishedFolderId&&(o[n.DistinguishedFolderId]=e);var d=i&&t[i];d&&d.childFolderIds.push(e)}));var d=[];n.forEach((function(e){var r=o[e];r&&d.push(r)}));for(var u=e.childFolderIds||[],l=0;l<u.length;l++){var a=u[l]||null;a&&-1==d.indexOf(a)&&d.push(a)}e.childFolderIds=d}}(I,f,n),{__typename:"FolderHierarchyResult",Folders:f,RootFolder:I,IndexedPagingOffset:c.IndexedPagingOffset,TotalItemsInView:c.TotalItemsInView,IncludesLastItemInRange:c.IncludesLastItemInRange}}function s(e,r){var n=e,t=n.FolderId,d=n.ParentFolderId,u=n.DisplayName,a=n.ArchiveTag,s=n.PolicyTag,I=n.ChildFolderCount,F=n.UnreadCount,h=n.TotalCount,p=n.FolderClass,g=n.DistinguishedFolderId;if(!t||!d)return l.g.warn("mapOWSFolderToGql: ignoring folder with missing folderId or missing parentFolderId"),null;var y=I||0,b=f(t);return{id:b.Id,__typename:"MailFolder",type:n.__type,FolderId:b,ParentFolderId:f(d),DisplayName:u||"",DistinguishedFolderId:g||null,FolderClass:p||"IPF.Note",UnreadCount:F||0,TotalCount:h||0,ArchiveTag:a?v(a):null,PolicyTag:s?v(s):null,hasChildren:y>0,remoteFolderDisplayName:i(n),sourceWellKnownFolderType:o(n),ReplicaList:n.ReplicaList,PermissionSet:n.PermissionSet,size:c(n),childFolderIds:[],pausedTotalCount:null,principalSMTPAddress:null,mailboxInfo:{type:r.type,userIdentity:r.userIdentity,mailboxSmtpAddress:r.mailboxSmtpAddress,auxiliaryMailboxGuid:r.auxiliaryMailboxGuid}}}function c(e){var r,n;return null===(n=null===(r=e.ExtendedProperty)||void 0===r?void 0:r[0])||void 0===n?void 0:n.Value}function f(e){return{__typename:"FolderId",Id:e.Id,ChangeKey:e.ChangeKey}}function v(e){return{__typename:"RetentionTagType",IsExplicit:e.IsExplicit,Value:e.Value}}n.d(r,"a",(function(){return o})),n.d(r,"b",(function(){return a})),n.d(r,"c",(function(){return s}))},2674:function(e,r,n){"use strict";n.d(r,"a",(function(){return o}));var t=n(0);function o(e){return Object(t.__assign)({__type:"FolderResponseShape:#Exchange"},e)}},3564:function(e,r,n){"use strict";n.d(r,"a",(function(){return o}));var t=n(0);function o(e){return Object(t.__assign)({__type:"FindFolderRequest:#Exchange"},e)}},3644:function(e,r,n){"use strict";var t=n(30),o=n(0);function i(e,r){var n;return void 0===e||e.__type||(n=e,e=Object(o.__assign)({__type:"FindFolderJsonRequest:#Exchange"},n)),Object(t.a)("FindFolder",e,r)}n.d(r,"a",(function(){return i}))},706:function(e,r,n){"use strict";n.d(r,"a",(function(){return o}));var t=n(0);function o(e){return Object(t.__assign)({__type:"DistinguishedFolderId:#Exchange"},e)}},782:function(e,r,n){"use strict";n.d(r,"a",(function(){return o}));var t=n(0);function o(e){return Object(t.__assign)({__type:"PropertyUri:#Exchange"},e)}}}]);
//# sourceMappingURL=owa.FolderHierarchyWeb.js.map
self.scriptsLoaded['owa.FolderHierarchyWeb.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.FolderHierarchyWeb.js'] = (new Date()).getTime();