self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.MailBoot~RetentionPolicies.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[724],{13023:function(e){e.exports=JSON.parse('{"a":"t7b"}')},13024:function(e,t,n){(t=e.exports=n(94)(!1)).push([e.i,"._2Ij1xLT_HLp88M37zkVcqx{font-weight:600}html[dir] ._23f4dMU1_LGLt4GgPo3Lk9 .ms-ContextualMenu-header{padding:0 4px}._2XmjPcdNPHzJnErHgc7pg8{font-weight:700}",""]),t.locals={checkedItem:"_2Ij1xLT_HLp88M37zkVcqx",sectionHeader:"_23f4dMU1_LGLt4GgPo3Lk9",checkmark:"_2XmjPcdNPHzJnErHgc7pg8"}},13025:function(e){e.exports=JSON.parse('{"a":"q7b","b":"r7b","c":"s7b"}')},13026:function(e){e.exports=JSON.parse('{"a":"p7b"}')},1705:function(e,t,n){"use strict";var r=n(0),i=n(12),c=n(2),a=n(2782);function o(e){return Math.floor(Math.random()*e+1)}var s=n(2783);n.d(t,"a",(function(){return u})),n.d(t,"b",(function(){return l})),n.d(t,"d",(function(){return d})),n.d(t,"e",(function(){return b}));var u=4,l=8,d={toDate:null,fromDate:null,includeAttachments:!1,initialSearchScope:null,isSearchHistoryDirty:!1,isAnswerInitialized:!1,isAnswerLocalizationCompleted:!1,isUnread:!1,previousNode:null,searchNumber:0,staticSearchScope:null,staticSearchScopeList:null,shouldShowAdvancedSearch:!1,shouldShowTimeFilterCallout:!1,advancedSearchViewState:Object(a.a)(),initialAdvancedSearchViewState:Object(a.a)(),legacySuggestions:new i.ObservableMap({}),recipientForPersonalizedGhostTextIndex:o(s.a-1),generalizedGhostTextBankIndex:o(u-1),personalizedGhostTextBankIndex:o(l-1),usePersonalGhostText:!1,isAnswerAvailable:!1},f=Object(r.__assign)({},d),b=Object(c.createStore)("mailSearchStore",f),g=b();t.c=g},1864:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(0);function i(e){return Object(r.__assign)({__type:"Message:#Exchange"},e)}},1927:function(e,t,n){"use strict";var r=n(36),i=n(2364),c=n(1705),a=n(1812);function o(e){var t=e.tableQuery;return 0===t.type?t.folderId:function(e){if(1!=e.type)return!1;var t=e.searchScope;return["PrimaryMailbox","ArchiveMailbox","SharedFolders"].indexOf(t.kind)>-1}(t)?t.searchScope.folderId:null}var s=n(2294),u=n(2295),l=n(1712);n.d(t,"a",(function(){return f})),n.d(t,"m",(function(){return b})),n.d(t,"c",(function(){return i.b})),n.d(t,"q",(function(){return c.c})),n.d(t,"i",(function(){return c.e})),n.d(t,"f",(function(){return a.a})),n.d(t,"s",(function(){return a.f})),n.d(t,"r",(function(){return a.e})),n.d(t,"g",(function(){return o})),n.d(t,"j",(function(){return s.a})),n.d(t,"h",(function(){return u.a})),n.d(t,"n",(function(){return l.k})),n.d(t,"e",(function(){return l.d})),n.d(t,"d",(function(){return l.c})),n.d(t,"b",(function(){return l.b})),n.d(t,"o",(function(){return l.l})),n.d(t,"p",(function(){return l.n})),n.d(t,"k",(function(){return l.h})),n.d(t,"l",(function(){return l.j}));var d=new r.c((function(){return Promise.all([n.e(3),n.e(5),n.e(6),n.e(7),n.e(8),n.e(11),n.e(12),n.e(14),n.e(16),n.e(21),n.e(20),n.e(22),n.e(26),n.e(25),n.e(27),n.e(29),n.e(31),n.e(33),n.e(32),n.e(42),n.e(41),n.e(44),n.e(45),n.e(48),n.e(850)]).then(n.bind(null,4018))})),f=Object(r.d)(d,(function(e){return e.AnswersContainer})),b=new r.a(d,(function(e){return e.initializeAndWarmupAnswers}))},1996:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(0);function i(e){return Object(r.__assign)({__type:"ItemChange:#Exchange"},e)}},2031:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(0);function i(e){return Object(r.__assign)({__type:"SetItemField:#Exchange"},e)}},2033:function(e,t,n){"use strict";var r,i;n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return i})),function(e){e[e.Keywords=0]="Keywords",e[e.People=1]="People",e[e.PrivateDistributionList=2]="PrivateDistributionList",e[e.File=3]="File",e[e.Category=4]="Category",e[e.Message=5]="Message",e[e.Event=6]="Event",e[e.TrySuggestion=7]="TrySuggestion",e[e.Setting=8]="Setting"}(r||(r={})),function(e){e[e.Unknown=0]="Unknown",e[e.Checking=1]="Checking",e[e.NotSupported=2]="NotSupported",e[e.Supported=3]="Supported"}(i||(i={}))},2139:function(e,t,n){"use strict";var r=n(30),i=n(0);function c(e,t){var n;return void 0===e||e.__type||(n=e,e=Object(i.__assign)({__type:"UpdateItemJsonRequest:#Exchange"},n)),Object(r.a)("UpdateItem",e,t)}n.d(t,"a",(function(){return c}))},2140:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(17);function i(){var e=Object(r.a)().PolicySettings;return e?{OutboundCharset:e.OutboundCharset,UseGB18030:e.UseGB18030,UseISO885915:e.UseISO885915}:{OutboundCharset:"AutoDetect"}}},2151:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(0);function i(e){return Object(r.__assign)({__type:"UpdateItemRequest:#Exchange"},e)}},2294:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(33),i=n(2435),c=n(423);function a(){return Object(i.a)()&&(Object(r.i)("sea-fetchPeople2")||Object(r.i)("sea-fetchEvents2")||Object(r.i)("sea-calendarTriggerControl2")||Object(r.i)("sea-fetchFlights2")||Object(r.i)("sea-flightTriggerControl2")||Object(r.i)("sea-fetchFiles4")||Object(r.i)("sea-fileTriggerControl4")||Object(r.i)("sea-peopleTriggerControl2"))||Object(i.a)()&&Object(c.a)()&&(Object(r.i)("sea-fetchBookmarks2")||Object(r.i)("sea-bookmarkTriggerControl2")||Object(r.i)("sea-fetchAcronyms2")||Object(r.i)("sea-fetchLinks2")||Object(r.i)("sea-linkTriggerControl2")||Object(r.i)("sea-acronymTriggerControl2"))}},2295:function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n(1705),i=n(33),c=n(2435),a=n(65),o=n(1637),s=n(1664);function u(){var e=Object(r.e)().staticSearchScope,t=null==e?void 0:e.kind;if(Object(a.h)().SessionSettings.IsExplicitLogon)return"ArchiveMailbox"===t?2:Object(i.i)("sea-3s-explicitLogon")&&Object(c.a)()?0:1;if("PrimaryMailbox"===t)return Object(c.a)()?0:1;if("ArchiveMailbox"===t){var n=Object(s.a)(e.folderId);return Object(i.i)("sea-archive-mailbox-3S")&&Object(c.a)()&&n==o.d?0:1}return"Group"===t?1:"SharedFolders"===t?2:null}},2364:function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"a",(function(){return c}));var r=n(2033),i=[r.b.File,r.b.People,r.b.Keywords],c=[r.b.File,r.b.People,r.b.Keywords,r.b.Message,r.b.Event,r.b.Category,r.b.TrySuggestion,r.b.Setting]},2435:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(17);function i(){return Object(r.a)().SessionSettings.IsSubstrateSearchServiceAvailable}},2646:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(0);function i(e){return Object(r.__assign)({__type:"ApplyConversationActionRequest:#Exchange"},e)}},2647:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(0);function i(e){return Object(r.__assign)({__type:"ConversationAction:#Exchange"},e)}},2707:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(0);function i(e){return Object(r.__assign)({__type:"DeleteItemField:#Exchange"},e)}},2764:function(e,t,n){"use strict";var r=n(30),i=n(0);function c(e,t){var n;return void 0===e||e.__type||(n=e,e=Object(i.__assign)({__type:"ApplyConversationActionJsonRequest:#Exchange"},n)),Object(r.a)("ApplyConversationAction",e,t)}n.d(t,"a",(function(){return c}))},2782:function(e,t,n){"use strict";function r(){return{selectedSearchScope:null,subjectFieldText:"",keywordsFieldText:"",fromDate:null,toDate:null,hasAttachments:null,fromPeopleSuggestions:[],toPeopleSuggestions:[],ccPeopleSuggestions:[]}}n.d(t,"a",(function(){return r}))},2783:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var r=10},3141:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(0);function i(e){return Object(r.__assign)({__type:"SetFolderField:#Exchange"},e)}},347:function(e,t,n){"use strict";var r=n(0);function i(e,t){return e?Object(r.__assign)({mailboxInfo:e},t):null!=t?t:void 0}n.d(t,"a",(function(){return i}))},3605:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(0);function i(e){return Object(r.__assign)({__type:"Folder:#Exchange"},e)}},4070:function(e){e.exports=JSON.parse('{"a":"bmb"}')},5720:function(e,t,n){"use strict";n.r(t);var r=n(0),i=n(2),c=Object(i.action)("ON_ARCHIVE_TAG_FOR_FOLDER_CHANGED",(function(e,t,n){return{folder:e,tagValue:t,actionSource:n}})),a=Object(i.action)("ON_DELETE_TAG_FOR_FOLDER_CHANGED",(function(e,t,n){return{folder:e,tagValue:t,actionSource:n}})),o=Object(i.action)("ON_ARCHIVE_TAG_FOR_FOLDER_UPDATE_SUCCESS",(function(e,t){return{folder:e,archiveTag:t}})),s=Object(i.action)("ON_DELETE_TAG_FOR_FOLDER_UPDATE_SUCCESS",(function(e,t){return{folder:e,deleteTag:t}})),u=Object(i.action)("ON_RETENTION_TAG_FOR_ITEMS_UPDATE_SUCCESS",(function(e,t,n){return{tag:e,isArchiveTag:t,itemIds:n}})),l=Object(i.action)("ON_RETENTION_TAG_FOR_ITEMS_CHANGED",(function(e,t,n,r,i){return{isArchiveTag:e,tagValue:t,itemIds:n,actionSource:r,mailboxInfo:i}})),d=Object(i.action)("ON_RETENTION_TAG_FOR_CONVERSATIONS_CHANGED",(function(e,t,n,r,i,c,a){return{isArchiveTag:e,tagValue:t,folderId:n,conversationActionContexts:r,itemIds:i,actionSource:c,mailboxInfo:a}})),f=n(1626),b=n(3141);var g=n(782),v=n(3605),h="ArchivePolicyParentRow",p="DeletePolicyParentRow",O="FolderArchiveTag",y=n(1717);function j(e,t,n){var i,c=Object(f.s)(e),a={Path:Object(g.a)({FieldURI:t}),Folder:n?t===O?Object(v.a)({ArchiveTag:n}):Object(v.a)({PolicyTag:n}):null},o=[n?Object(b.a)(a):(i=a,Object(r.__assign)({__type:"DeleteFolderField:#Exchange"},i))];return f.N.importAndExecute(c.Id,o,Object(y.c)(e))}var I=n(23),_=n(114);function T(e){var t=e.isArchiveTag,n=e.actionSource,r=e.responseClass;Object(_.r)("TnS_RetentionPolicySelected",[t,n,r])}function S(e){var t=e.folder,n=e.retentionId,r=e.inheritSubMenuIdentifier,i=r===h?t.ArchiveTag:t.PolicyTag;return!!i&&n!=i.Value||!i&&n!=r}Object(i.orchestrator)(c,(function(e){return Object(r.__awaiter)(void 0,void 0,void 0,(function(){var t,n,i,c,a,s;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:if(t=e.folder,n=e.tagValue,i=e.actionSource,!S({folder:t,retentionId:n,inheritSubMenuIdentifier:h}))return[2];r.label=1;case 1:return r.trys.push([1,3,,4]),c=n===h?null:{Value:n,IsExplicit:!0},[4,j(t.DistinguishedFolderId||t.FolderId.Id,O,c)];case 2:return"Success"===(a=r.sent()).ResponseClass&&o(t,c),T({isArchiveTag:!0,actionSource:i,responseClass:a.ResponseClass}),[3,4];case 3:return s=r.sent(),I.d("Error while updating folder archive tag"+s),[3,4];case 4:return[2]}}))}))})),Object(i.orchestrator)(a,(function(e){return Object(r.__awaiter)(void 0,void 0,void 0,(function(){var t,n,i,c,a,o;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:if(t=e.folder,n=e.tagValue,i=e.actionSource,!S({folder:t,retentionId:n,inheritSubMenuIdentifier:p}))return[2];r.label=1;case 1:return r.trys.push([1,3,,4]),c=n===p?null:{Value:n,IsExplicit:!0},[4,j(t.DistinguishedFolderId||t.FolderId.Id,"FolderPolicyTag",c)];case 2:return"Success"===(a=r.sent()).ResponseClass&&s(t,c),T({isArchiveTag:!1,actionSource:i,responseClass:a.ResponseClass}),[3,4];case 3:return o=r.sent(),I.d("Error while updating folder delete tag"+o),[3,4];case 4:return[2]}}))}))}));var m=n(1996),C=n(370),A=n(2139),P=n(2151),k=n(161),x=n(1864),E=n(2031),R=n(2707),w=n(2140);function F(e,t,n,i){var c=function(e,t,n){var i,c=t?"ItemArchiveTag":"ItemPolicyTag",a=t?"ArchiveTag":"PolicyTag",o=[n?Object(E.a)({Path:Object(g.a)({FieldURI:c}),Item:Object(x.a)((i={},i[a]=n,i))}):Object(R.a)({Path:Object(g.a)({FieldURI:c})})],s=[];return e.forEach((function(e){return s.push(Object(m.a)({Updates:o,ItemId:Object(C.a)({Id:e})}))})),Object(P.a)(Object(r.__assign)({ItemChanges:s,ConflictResolution:"AlwaysOverwrite",MessageDisposition:"SaveOnly",SuppressReadReceipts:!1,ClientSupportsIrm:!0,SendCalendarInvitationsOrCancellations:"SendToNone"},Object(w.a)()))}(e,t,n);return Object(A.a)({Header:Object(k.b)(),Body:c},i).then((function(e){return e.Body.ResponseMessages.Items[0]}))}var N=n(347),M=(Object(i.orchestrator)(l,(function(e){return Object(r.__awaiter)(void 0,void 0,void 0,(function(){var t,n,i,c,a,o,s,l;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),t=e.isArchiveTag,n=e.tagValue,i=e.itemIds,c=e.actionSource,a=e.mailboxInfo,[4,F(i,t,o=n===h||n===p?null:{Value:n,IsExplicit:!0},Object(N.a)(a))];case 1:return"Success"==(s=r.sent()).ResponseClass&&u(o,t,i),T({isArchiveTag:t,actionSource:c,responseClass:s.ResponseClass}),[3,3];case 2:return l=r.sent(),I.d("Error while updating item retention tag "+l),[3,3];case 3:return[2]}}))}))})),n(2646)),D=n(2647),L=n(790),V=n(706),G=n(554),H=n(6427),U=n(954);function B(e,t,n,r,i){var c=function(e,t,n,r){var i=e.map((function(e){return function(e,t,n,r){var i=Object(D.a)({Action:"SetRetentionPolicy",ConversationId:Object(C.a)({Id:e.conversationId}),RetentionPolicyType:n});t&&(i.RetentionPolicyTagId=t);if(r){var c=Object(L.a)({BaseFolderId:(a=r,Object(U.a)(a)?Object(V.a)({Id:a}):Object(G.a)({Id:a}))});i.ContextFolderId=c}var a;return i}(e,t,n,r)}));return Object(M.a)({ConversationActions:i,ReturnMovedItemIds:!1})}(e,t,n,r);return Object(H.a)(c)}Object(i.orchestrator)(d,(function(e){return Object(r.__awaiter)(void 0,void 0,void 0,(function(){var t,n,i,c,a,o,s,l,d,f;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),t=e.isArchiveTag,n=e.tagValue,i=e.folderId,c=e.conversationActionContexts,a=e.itemIds,o=e.actionSource,s=e.mailboxInfo,[4,B(c,(l=n===h||n===p)?null:n,t?1:0,i,Object(N.a)(s))];case 1:return"Success"==(d=r.sent()).ResponseClass&&u(l?null:{Value:n,IsExplicit:!0},t,a),T({isArchiveTag:t,actionSource:o,responseClass:d.ResponseClass}),[3,3];case 2:return f=r.sent(),I.d("Error while updating conversation retention tag"+f),[3,3];case 3:return[2]}}))}))}));Object(i.mutator)(o,(function(e){var t=e.folder,n=e.archiveTag;t.ArchiveTag=n})),Object(i.mutator)(s,(function(e){var t=e.folder,n=e.deleteTag;t.PolicyTag=n}));var z=n(1632);Object(i.mutator)(u,(function(e){var t=e.itemIds,n=e.tag,r=e.isArchiveTag;t.forEach((function(e){var t=z.u.items.get(e);t&&(r?t.ArchiveTag=n:t.PolicyTag=n)}))}));var q=n(1695),J=n(1625);var K=n(13023),Q=n(6),X=n(167),W=n(8341);function $(e){var t=e.retentionId,n=e.displayName,r=e.isChecked,i=e.subMenuProps;return{key:t,text:n,data:t,onClick:e.onClickCallback,checked:r,itemProps:r?{styles:{label:W.checkedItem}}:null,iconProps:r?{iconName:"CheckMark",className:W.checkmark}:null,subMenuProps:i}}var Y=n(13025);function Z(e){var t=e.retentionId,n=e.retentionPolicyTags,r=e.folderType,i=e.isArchive,c=e.isChecked,a=e.onClickCallback,o=function(e,t){return 12==e?t?Object(Q.b)(Y.a):Object(Q.b)(Y.b):Object(Q.b)(Y.c)}(r,i);return $({retentionId:t,displayName:17!=r?function(e){var t=e.retentionPolicyTags,n=e.folderType,r=e.isArchive,i=e.defaultName;return t.reduce((function(e,t){return t.Type===n&&t.IsArchive==r?t.DisplayName:e}),i)}({retentionPolicyTags:n,folderType:r,isArchive:i,defaultName:o}):o,isChecked:c,subMenuProps:null,onClickCallback:a})}var ee=n(8341);function te(e,t,n,r,i){var c=!1;return(12==r?[]:e.map((function(e){var r=e.RetentionId===n;return r&&(c=!0),$({retentionId:e.RetentionId,displayName:e.DisplayName,isChecked:t&&r,subMenuProps:null,onClickCallback:i})}))).concat(Z({retentionId:h,retentionPolicyTags:e,folderType:r,isArchive:!0,isChecked:t&&!c,onClickCallback:i}))}var ne=n(13026);var re=n(8341);function ie(e,t,n,r,i,c){var a=!1;return(17!=r||"archive"===i?[]:function(e){var t={},n=e.filter((function(e){return null==e.ParentLabelIdentity||e.ParentLabelIdentity.length<=0})).reduce((function(e,n){var r={parentPolicyTag:n,childrenPolicyTags:[]};return e.push(r),t[n.RetentionId]=r,e}),[]);return e.filter((function(e){return null!=e.ParentLabelIdentity&&e.ParentLabelIdentity.length>0&&e.ParentLabelIdentity in t})).forEach((function(e){t[e.ParentLabelIdentity].childrenPolicyTags.push(e)})),n}(e).map((function(e){var r=function(e,t,n,r){var i=e.parentPolicyTag,c=e.childrenPolicyTags,a=i.RetentionId===n;if(null==c||0==c.length)return{item:$({retentionId:i.RetentionId,displayName:i.DisplayName,isChecked:t&&a,subMenuProps:null,onClickCallback:r}),policyFound:a};var o=!1,s=c.map((function(e){var i=e.RetentionId===n;return i&&(o=!0),$({retentionId:e.RetentionId,displayName:e.DisplayName,isChecked:t&&i,subMenuProps:null,onClickCallback:r})}));return{item:$({retentionId:i.RetentionId,displayName:i.DisplayName,isChecked:t&&a,subMenuProps:{items:s},onClickCallback:null}),policyFound:o}}(e,t,n,c);return r.policyFound&&(a=!0),r.item}))).concat(Z({retentionId:p,retentionPolicyTags:e,folderType:r,isArchive:!1,isChecked:t&&!a,onClickCallback:c}))}function ce(e){var t=e.retentionPolicyTagList,n=e.showTagSelection,i=e.selectedArchiveTag,c=e.selectedDeleteTag,a=e.mailboxType,o=e.distinguishedFolderId,s=e.hasArchive,u=e.onArchivePolicyClickedCallback,l=e.onDeletePolicyClickedCallback,d=[],f=s&&"ArchiveMailbox"!=a,b=function(e){switch(e){case"msgfolderroot":case"archivemsgfolderroot":return 12;case"deleteditems":case"archivedeleteditems":return 3;case"recoverableitemsdeletions":case"archiverecoverableitemsdeletions":return 18;case"calendar":return 1;case"contacts":return 2;case"conversationhistory":return 16;case"drafts":return 4;case"inbox":return 5;case"junkemail":return 6;case"journal":return 7;case"notes":return 8;case"outbox":return 9;case"sentitems":return 10;case"syncissues":return 15;case"tasks":return 11;case"none":default:return 17}}(o),g=t.filter((function(e){return e.IsVisible&&e.IsArchive})).sort(ae),v=t.filter((function(e){return e.IsVisible&&!e.IsArchive})).sort(ae);return f&&d.push.apply(d,Object(r.__spread)(function(e,t,n,r,i){var c=(null==n?void 0:n.IsExplicit)?n.Value:null;return[{key:"archiveSection",className:ee.sectionHeader,itemType:X.a.Section,sectionProps:{bottomDivider:!0,title:Object(Q.b)(K.a),items:te(e,t,c,r,i)}}]}(g,n,i,b,u))),d.push.apply(d,Object(r.__spread)(function(e,t,n,r,i,c){var a=(null==n?void 0:n.IsExplicit)?n.Value:null;return[{key:"deleteSection",className:re.sectionHeader,itemType:X.a.Section,sectionProps:{title:Object(Q.b)(ne.a),items:ie(e,t,a,r,i,c)}}]}(v,n,c,b,o,l))),{items:d}}function ae(e,t){return e.RetentionPeriod&&t.RetentionPeriod?e.RetentionPeriod-t.RetentionPeriod:t.RetentionPeriod?1:-1}var oe=n(17),se=n(1927),ue=n(6429);function le(e,t,n){if(e&&Object(q.e)(e.tableQuery)){var r=q.i.tryImportForRender();return r?r(e.tableQuery):[]}return"SharedMailbox"===t?(i=n,c=Object(ue.b)().retentionPolicyTags,i&&c.has(i)?c.get(i):[]):Object(oe.a)().RetentionPolicyTags;var i,c}function de(e,t,n){var i=J.X.tableViews.get(e);if(!i)return null;var c=function(e){var t,n,r;if(e&&Object(q.e)(e.tableQuery))t=null,n="GroupMailbox";else{var i=Object(se.g)(e),c=i&&Object(f.o)().get(i);if(!c)return null;t=c.DistinguishedFolderId||c.FolderId.Id,n=c.mailboxInfo.type,r=c.principalSMTPAddress}return{folderId:t,mailboxType:n,principalSMTPAddress:r}}(i);if(!c)return null;var a=le(i,c.mailboxType,c.principalSMTPAddress);if(!a)return null;var o,s,u,l=Object(r.__spread)(i.selectedRowKeys.keys());return n?(o=n.ArchiveTag,s=n.PolicyTag,u=!0):(o=1==l.length?J.b.getArchiveTag(l[0],i):null,s=1==l.length?J.b.getPolicyTag(l[0],i):null,u=1==l.length),ce({retentionPolicyTagList:a,showTagSelection:u,selectedArchiveTag:o,selectedDeleteTag:s,mailboxType:c.mailboxType,distinguishedFolderId:"none",hasArchive:fe(i),onArchivePolicyClickedCallback:be({isArchivePolicyClicked:!0,tableView:i,selectedTag:o,folderId:c.folderId,clientItem:n,actionSource:t}),onDeletePolicyClickedCallback:be({isArchivePolicyClicked:!1,tableView:i,selectedTag:s,folderId:c.folderId,clientItem:n,actionSource:t})})}function fe(e){return(!e||!Object(q.e)(e.tableQuery))&&!!Object(oe.a)().SessionSettings.HasArchive}function be(e){var t=e.isArchivePolicyClicked,n=e.tableView,i=e.selectedTag,c=e.folderId,a=e.clientItem,o=e.actionSource;return function(e,s){if(function(e){var t=e.retentionTag,n=e.retentionId,r=e.inheritSubMenuIdentifier;return!!t&&n!=t.Value||!t&&n!=r}({retentionTag:i,retentionId:s.data,inheritSubMenuIdentifier:t?h:p})){var u="RPCSAOverflow"==o||1===n.tableQuery.listViewType,f=Object(r.__spread)(n.selectedRowKeys.keys()),b=Object(y.b)(n);if(u){var g="RPCSAOverflow"==o?[a.ItemId.Id]:f.map((function(e){return Object(J.L)(e,n.id).clientId.Id}));l(t,s.data,g,o,b)}else{var v=f.map((function(e){return Object(J.h)(e,n.id)}));g=f.reduce((function(e,t){var i=Object(J.K)(t,n.id);return i&&e.push.apply(e,Object(r.__spread)(i.itemIds)),e}),[]);d(t,s.data,c,v,g,o,b)}}}}var ge=n(4070),ve=n(233);function he(e){if(Object(ve.a)())return null;var t=Object(oe.a)(),n=t.RetentionPolicyTags;return n&&0!==n.length?{key:"AssignPolicy",name:Object(Q.b)(ge.a),disabled:!1,subMenuProps:ce(Object(r.__assign)(Object(r.__assign)({},e),{showTagSelection:!0,retentionPolicyTagList:n,hasArchive:!!t.SessionSettings.HasArchive}))}:null}n.d(t,"getAssignPolicyPropertiesForMailContextMenu",(function(){return de})),n.d(t,"onArchiveTagForFolderChanged",(function(){return c})),n.d(t,"onDeleteTagForFolderChanged",(function(){return a})),n.d(t,"getRetentionPolicyMenuItem",(function(){return he}))},6427:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(0),i=n(161),c=n(2764);function a(e,t,n){if(void 0===t&&(t=Object(i.b)()),!e||!e.ConversationActions||0===e.ConversationActions.length)throw new Error("ApplyConversationAction requestBody is invalid!");n=n||{};var a=Object(r.__assign)({},n),o=a.headers?new Headers(a.headers):new Headers;return o.set("X-OWA-ActionSource","ApplyConversationAction_"+e.ConversationActions[0].Action),a.headers=o,Object(c.a)({Header:t,Body:e},a).then((function(e){return e.Body.ResponseMessages.Items[0]})).catch((function(e){return Promise.reject(e)}))}},6429:function(e,t,n){"use strict";n.d(t,"b",(function(){return c}));var r=n(2),i={showPeoplePickerDialog:!1,retentionPolicyTags:new(n(12).ObservableMap)({})},c=Object(r.createStore)("sharedFolderState",i),a=c();t.a=a},8341:function(e,t,n){var r=n(13024),i=n(95);"string"==typeof r&&(r=[[e.i,r]]);for(var c=0;c<r.length;c++)i.loadStyles(r[c][1],!1);r.locals&&(e.exports=r.locals)}}]);
//# sourceMappingURL=owa.MailBoot~RetentionPolicies.js.map
self.scriptsLoaded['owa.MailBoot~RetentionPolicies.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.MailBoot~RetentionPolicies.js'] = (new Date()).getTime();