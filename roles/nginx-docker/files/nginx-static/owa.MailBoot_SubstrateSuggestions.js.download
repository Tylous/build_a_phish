self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.MailBoot~SubstrateSuggestions.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[757],{1645:function(t,n,e){"use strict";function r(t,n){Object.keys(n).forEach((function(e){return t.set(e,n[e])}))}function c(t){var n=null!=t?t:{headers:new Headers};return n.datapoint=n.datapoint||{},n.datapoint.mailbox="Default",n}e.d(n,"b",(function(){return r})),e.d(n,"a",(function(){return c}))},1646:function(t,n,e){"use strict";var r=e(0),c=e(1676),o=e(343),u=e(606),i=e(114),a=e(4),s="X-AnchorMailbox",d="Authorization",b="X-OwaWebSessionType",f="X-OWA-ExplicitLogonUser";function l(t,n){return Object(r.__awaiter)(this,void 0,void 0,(function(){var e,l,O,j,p;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:if(e={},l=Object(o.k)(t)){if(l.accountState==o.b.AccessRevoked)return[2,null];if(l.accountState==o.b.AccountDeprovisioned||l.accountState==o.b.AccountNotFound)return Object(o.c)(l.accountState,l.accountProviderType),[2,null]}return n?(e[s]=n,e[f]=n):l&&(e[s]=l.anchorMailbox),l?(O=l.token,!(j=Object(u.g)(l.tokenExpiry))&&O?[3,2]:(Object(i.r)("getAndUpdateAccessToken",{tokenExpiry:Object(a.y)(l.tokenExpiry,Object(a.Qb)()),isTokenExpired_1:j,isTokenInvalid_2:!O},{isCore:!0}),[4,c.a.importAndExecute(l.accountId,t,O)])):[3,3];case 1:(O=r.sent())||(O=""),r.label=2;case 2:p=void 0,"Outlook"==l.accountProviderType?(p='MSAuth1.0 usertoken="'+O+'", type="MSACT"',e[b]=1..toString()):"Google"!=l.accountProviderType&&"ICloud"!=l.accountProviderType||(p="Bearer "+O,e[b]=2..toString()),e[d]=p,r.label=3;case 3:return[2,e]}}))}))}var O=e(1645),j=e(23);function p(t,n){return Object(r.__awaiter)(this,void 0,void 0,(function(){var e,c;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return e=Object(O.a)(),c=e,[4,v(t,n)];case 1:return c.headers=r.sent(),e.authNeededOnUnAuthorized=!1,e.datapoint=e.datapoint||{},e.datapoint.mailbox="Connected",[2,e]}}))}))}function v(t,n){var e;return Object(r.__awaiter)(this,void 0,void 0,(function(){var c,o;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return c=n&&(null===(e=t.headers)||void 0===e?void 0:e.set)?new Headers(t.headers):new Headers,[4,l(t.mailboxInfo.userIdentity,h(t.mailboxInfo.type,t.mailboxInfo.mailboxSmtpAddress)?t.mailboxInfo.mailboxSmtpAddress:null)];case 1:return o=r.sent(),Object(O.b)(c,o),[2,c]}}))}))}function h(t,n){var e="GroupMailbox"==t||"TeamsMailbox"==t||"SharedMailbox"==t||"PublicMailbox"==t;return e&&null==n&&j.d("getHeadersForConnectedAccount: mailboxSmtpAddress should be passed for Group or Teams or Shared or Public Mbx request"),e}e.d(n,"a",(function(){return l})),e.d(n,"b",(function(){return p})),e.d(n,"c",(function(){return h}))},1647:function(t,n,e){"use strict";e.d(n,"a",(function(){return c}));var r=e(2),c=Object(r.action)("triggerReInitializeAccount",(function(t){return{userIdentity:t}}))},1676:function(t,n,e){"use strict";e.d(n,"a",(function(){return u}));var r=e(36),c=e(1647);e.d(n,"b",(function(){return c.a}));var o=new r.c((function(){return e.e(1266).then(e.bind(null,1869))})),u=new r.a(o,(function(t){return t.getAndUpdateAccessToken}))},17585:function(t,n,e){"use strict";e.r(n);var r=e(2737),c=e(151),o=e(217),u=Object(c.action)("execute3SPrimeCall")((function(){Object(r.b)(Object(o.d)().userIdentity,null,!1)}));e.d(n,"execute3SPrimeCall",(function(){return u}))},2027:function(t,n,e){"use strict";e.d(n,"a",(function(){return c}));var r=e(33);function c(){return Object(r.i)("rp-cacheFirstPeopleTrieSize300")||Object(r.i)("rp-cacheFirstPeopleTrieSize500")||Object(r.i)("rp-cacheFirstPeopleTrieSize700")||Object(r.i)("rp-peopleTrieOnTimeoutLow")||Object(r.i)("rp-peopleTrieOnTimeoutMed")||Object(r.i)("rp-peopleTrieOnTimeoutHigh")}},218:function(t,n,e){"use strict";var r=e(688);e.d(n,"a",(function(){return r.a}))},2315:function(t,n,e){"use strict";var r=e(0),c=e(376);var o=e(33),u=e(5);e.d(n,"a",(function(){return s}));var i=null,a="searchtesthook";function s(t){void 0===t&&(t={});var n,e=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},t),function(){if(!i){i={};var t=Object(u.a)(a),n=decodeURIComponent(t||"").trim();if(Object(o.i)("sea-debugHook")&&n.length>0){var e=n.split("&");i=e.reduce((function(t,n){var e=Object(r.__read)(n.split("="),2),c=e[0],o=e[1];return t[c]=o,t}),{})}}return i}()),Object(c.a)("includePartnerIn3SRequest")?((n={}).partner="exchangeshared",n):null);return Object.keys(e).filter((function(t){return null!==e[t]})).reduce((function(t,n){var c;return Object(r.__assign)(Object(r.__assign)({},t),((c={})[n]=e[n],c))}),{})}},2737:function(t,n,e){"use strict";e.d(n,"a",(function(){return g})),e.d(n,"b",(function(){return I})),e.d(n,"c",(function(){return C}));var r=e(0),c=e(343),o=e(1646),u=e(33),i=e(203),a=e(218),s=e(146),d=e(2315),b=e(233),f=e(2027),l=e(23),O=e(2805),j="/search/api/v1/init?",p="/search/api/v1/suggestions?",v="owa.react.compose",h=["PandaServingCompose","PandaServingComposeZeroQuery"],S="AppendFreshContactsToTopN",m="ContextAwareServing",y="20",A="5",T="CSRClientEnabled",_="CSRCounterFactual",g="owa.projectMoca.peopleCard";function I(t,n,e,c,o,u,a,d){return void 0===d&&(d=!0),Object(r.__awaiter)(this,void 0,void 0,(function(){var b,f,O,j,h;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return b=a||v,null!=n?[3,1]:[2,k(b)];case 1:return[4,w(n,e,d,u,b)];case 2:return f=r.sent(),O=function(t,n,e){return{AppName:"OWA",Scenario:{Name:e},Cvid:n||Object(i.a)(),EntityRequests:[t]}}(f,null==o?void 0:o.conversationId,b),j=s.d,h=[p+C(b,n),O,c,!1],[4,P(t,null==o?void 0:o.clientSessionId)];case 3:return[2,j.apply(void 0,h.concat([r.sent(),!0,!0,!1])).then((function(t){return t})).catch((function(t){return l.g.info(t),null}))]}}))}))}function k(t){return Object(r.__awaiter)(this,void 0,void 0,(function(){var n,e;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return n=s.b,e=[j+C(t),void 0,!0],[4,P(null)];case 1:return[2,n.apply(void 0,e.concat([r.sent(),!0,!1])).then((function(t){return Object(a.a)(t.status)?t.json():null})).catch((function(t){return t.networkError=!0,l.d(t),null}))]}}))}))}function w(t,n,e,c,o){return Object(r.__awaiter)(this,void 0,void 0,(function(){var u;return Object(r.__generator)(this,(function(r){return u={Query:{QueryString:t},EntityType:"People",Provenances:x(n),Size:n?y:A},c&&c.length>0&&(u.Context=function(t){var n={};t&&(n.RecipientsTo=t.toString());return n}(c)),u.Fields=o===g?Object(O.a)(2,e):Object(O.a)(1,e),[2,u]}))}))}function x(t){var n=["Mailbox"];return t&&!Object(b.a)()&&n.push("Directory"),n}function C(t,n){var e=Object(r.__assign)({scenario:t},Object(d.a)()),c=[],o=Object(f.a)();return(o||Object(u.i)("rp-cacheFirstPeopleTrieSize500cf"))&&(c.push.apply(c,Object(r.__spread)(h)),o&&Object(u.i)("rp-EnableFreshContactsForZeroQuery")&&c.push(S),c.push(T),c.push(_)),Object(u.i)("rp-contextualZeroQuery")&&""==n&&c.push(m),c.length>0&&(e.setflight=c.join(",")),Object.keys(e).map((function(t){return t+"="+e[t]})).join("&")}function P(t,n){return Object(r.__awaiter)(this,void 0,void 0,(function(){var e;return Object(r.__generator)(this,(function(r){return e={},n&&(e["client-session-id"]=n),t&&Object(c.r)(t)?[2,Object(o.a)(t).then((function(t){return Object.keys(t).forEach((function(n){return e[n]=t[n]})),e}))]:[2,e]}))}))}},2805:function(t,n,e){"use strict";e.d(n,"a",(function(){return a}));var r=e(2027),c=["Id","ADObjectId","DisplayName","EmailAddresses","PeopleSubtype","PeopleType","PDLItemId","PersonaId","ImAddress","JobTitle"],o=c.concat(["FeatureData","GivenName","Surname","Alias"]),u=c.concat(["FeatureData"]),i=c.concat(["Phones","OfficeLocation","Department"]);function a(t,n){return void 0===n&&(n=!0),2===t?i:Object(r.a)()&&n?0==t?o:u:c}},343:function(t,n,e){"use strict";var r,c=e(2);!function(t){t[t.Valid=0]="Valid",t[t.AccountDeprovisioned=1]="AccountDeprovisioned",t[t.AccessRevoked=2]="AccessRevoked",t[t.TransientTokenError=3]="TransientTokenError",t[t.FailedToInitializeOWAConfig=4]="FailedToInitializeOWAConfig",t[t.AccountNotFound=5]="AccountNotFound",t[t.UnknownTokenError=6]="UnknownTokenError"}(r||(r={}));var o,u=e(44),i=Object(c.action)("addAccount",(function(t){return{userIdentity:t.userIdentity,account:t}})),a=Object(c.action)("removeAccount",(function(t){return{userIdentity:t}})),s=Object(c.action)("updateAccount",(function(t,n,e){return{userIdentity:t,accountToken:n,accountTokenExpiresIn:e}})),d=Object(c.action)("updateOWAConnectedAccountStatus",(function(t,n){return{userIdentity:t,accountState:n}})),b=Object(c.action)("accountIsInErrorState",(function(t,n){return Object(u.c)({name:"accountIsInErrorState",options:{isCore:!0},customData:{accountState_1:r[t],accountProvider_2:n}},{accountState:t})})),f=Object(c.action)("retryAccountUpdateToken",(function(t,n,e,c,o,i){return Object(u.c)({name:"retryAccountUpdateToken",customData:{currentAccountState_1:r[c],localAccountState_2:r[o],previousAccountState_3:r[i]}},{accountId:t,userIdentity:n,currentToken:e})})),l=Object(c.action)("connectedAccountsListRequested",(function(t){return Object(u.c)({name:"connectedAccountsGetResponse",options:{isCore:!0},customData:{isSuccess_1:t}},{isSuccess:t})})),O=Object(c.action)("setAccountsStoreState",(function(t){return{state:t}})),j=e(0),p=e(12);!function(t){t[t.None=0]="None",t[t.Loading=1]="Loading",t[t.AccountsLoadSuccessful=2]="AccountsLoadSuccessful",t[t.AccountsLoadError=3]="AccountsLoadError"}(o||(o={}));var v=Object(c.createStore)("OWAAccountsStore",{accountsMap:new p.ObservableMap({}),accountsLoadedState:o.None}),h=e(96),S=e(65);function m(t){return t!=Object(S.b)()&&void 0!==A(t)}function y(){return Object(j.__spread)(v().accountsMap.values())}function A(t){return v().accountsMap.get(t)}function T(){var t;return(null===(t=y())||void 0===t?void 0:t.length)>0?y()[0]:null}function _(){return y().filter((function(t){return t.accountState!=r.Valid}))}function g(t){return y().filter((function(n){return t.includes(n.accountState)}))}function I(t){return y().filter((function(n){return n.accountProviderType==t}))}function k(t){return m(t)?A(t).accountProviderType:null}function w(t){return"Outlook"==t.accountProviderType?'MSAuth1.0 usertoken="'+t.token+'", type="MSACT"':"Google"==t.accountProviderType||"ICloud"==t.accountProviderType?"Bearer "+t.token:Object(h.a)(t.accountProviderType)}function x(t,n){return function(e){var r=A(e);return r?r[t]:n}}x("accountUniqueId","0");var C=x("accountState",r.Valid),P=function(){return y().some((function(t){return!F(t.userIdentity)}))},E=x("accountProviderType",null),M=function(t){return"Outlook"==E(t)},F=function(t){return C(t)==r.Valid},L=function(){return y().length>0};function D(){return v().accountsLoadedState}var N=e(4),R=e(114);Object(c.mutator)(i,(function(t){var n=t.account;Object(R.r)("owaAccountAdded",{accountStatus_1:r[n.accountState]}),v().accountsMap.set(n.userIdentity,n)})),Object(c.mutator)(a,(function(t){var n=t.userIdentity;v().accountsMap.delete(n)})),Object(c.mutator)(s,(function(t){var n=t.userIdentity,e=t.accountToken,r=t.accountTokenExpiresIn,c=v().accountsMap.get(n);c.token=e,c.tokenExpiry=Object(N.j)(Object(N.Qb)(),parseInt(r))})),Object(c.mutator)(d,(function(t){var n=t.userIdentity,e=t.accountState,c=v().accountsMap.get(n);c.accountState==r.Valid&&e!=r.Valid&&Object(R.r)("owaConnectedAccountStatusUpdated",{accountStatus_1:r[e]}),c.accountState=e})),Object(c.mutator)(l,(function(t){var n=t.isSuccess?o.AccountsLoadSuccessful:o.AccountsLoadError;v().accountsLoadedState=n})),Object(c.mutator)(O,(function(t){v().accountsLoadedState=t.state})),e.d(n,"d",(function(){return i})),e.d(n,"u",(function(){return a})),e.d(n,"y",(function(){return s})),e.d(n,"x",(function(){return d})),e.d(n,"c",(function(){return b})),e.d(n,"v",(function(){return f})),e.d(n,"e",(function(){return l})),e.d(n,"w",(function(){return O})),e.d(n,"n",(function(){return y})),e.d(n,"k",(function(){return A})),e.d(n,"i",(function(){return T})),e.d(n,"f",(function(){return _})),e.d(n,"g",(function(){return g})),e.d(n,"o",(function(){return I})),e.d(n,"j",(function(){return k})),e.d(n,"m",(function(){return w})),e.d(n,"l",(function(){return C})),e.d(n,"q",(function(){return P})),e.d(n,"t",(function(){return M})),e.d(n,"s",(function(){return F})),e.d(n,"p",(function(){return L})),e.d(n,"h",(function(){return D})),e.d(n,"r",(function(){return m})),e.d(n,"b",(function(){return r})),e.d(n,"a",(function(){return o}))},606:function(t,n,e){"use strict";var r=e(2),c=Object(r.action)("initializeOwaObservableDateTime"),o=Object(r.action)("observableNowChanged"),u=Object(r.action)("observableTodayChanged"),i=e(4),a=e(12),s=Object(r.createStore)("ObservableDateTime",{now:0,today:0}),d=Object(a.computed)((function(){return Object(i.mc)(s().now)})),b=function(){return d.get()},f=Object(a.computed)((function(){return Object(i.mc)(s().today)})),l=function(){return f.get()},O=function(t){return Object(i.Hb)(t,b())},j=function(t){return Object(i.Fb)(t,b())},p=function(t){return h(t,i.Hb)},v=function(t){return h(t,i.Ib)},h=function(t,n){return n(Object(i.Xb)(Object(i.mc)(t)),l())};function S(t){if(!t)return"";var n=Object(i.mc)(t);return function(t,n){var e=Object(i.Xb)(t);if(Object(i.Jb)(e,n))return i.ab;var r=function(t){return Object(i.Nb)(e,Object(i.e)(n,-t),n)};if(r(3))return i.ib;if(r(30))return i.hb;return i.Y}(n,l())(n)}function m(t){if(!t)return"";var n=Object(i.mc)(t);return function(t,n){var e=Object(i.Xb)(t);if(Object(i.Jb)(e,n))return i.T;return i.U}(n,l())(n)}function y(t){return t?function(t,n){var e=Object(i.Xb)(t);return Object(i.Jb)(e,n)?Object(i.ab)(t):A(e,n,2)?Object(i.lb)(t):A(e,n,7)?Object(i.H)(Object(i.bb)(t),Object(i.ab)(t)):Object(i.H)(Object(i.J)(t),Object(i.ab)(t))}(Object(i.mc)(t),l()):""}function A(t,n,e){return Object(i.Nb)(t,Object(i.e)(n,-e),n)}var T=Object(r.action)("updateTimes"),_=Object(r.action)("setNow"),g=Object(r.action)("setToday",(function(t){return{today:t}}));Object(r.mutator)(_,(function(){s().now=Object(i.kc)()})),Object(r.mutator)(g,(function(t){var n=t.today;s().today=n}));var I=e(27),k=e(110);Object(r.orchestrator)(c,(function(){T();var t=Object(i.Qb)(),n=Object(i.Zb)(Object(i.h)(t,1)),e=Object(i.w)(n,t);setTimeout((function(){return setInterval(T,I.g)}),e)})),Object(r.orchestrator)(k.l,(function(){T()})),Object(r.orchestrator)(T,(function(){_();var t=Object(i.Ab)(Object(i.lc)()),n=s().today!=t;n&&g(t),o(),n&&u()})),e.d(n,"d",(function(){return c})),e.d(n,"j",(function(){return o})),e.d(n,"l",(function(){return u})),e.d(n,"i",(function(){return b})),e.d(n,"k",(function(){return l})),e.d(n,"g",(function(){return O})),e.d(n,"e",(function(){return j})),e.d(n,"f",(function(){return p})),e.d(n,"h",(function(){return v})),e.d(n,"a",(function(){return S})),e.d(n,"b",(function(){return m})),e.d(n,"c",(function(){return y}))},688:function(t,n,e){"use strict";function r(t){return t>=200&&t<300}e.d(n,"a",(function(){return r}))}}]);
//# sourceMappingURL=owa.MailBoot~SubstrateSuggestions.js.map
self.scriptsLoaded['owa.MailBoot~SubstrateSuggestions.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.MailBoot~SubstrateSuggestions.js'] = (new Date()).getTime();